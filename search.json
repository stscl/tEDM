[{"path":"https://stscl.github.io/tEDM/articles/tEDM.html","id":"introduction-to-the-tedm-package","dir":"Articles","previous_headings":"","what":"1. Introduction to the tEDM package","title":"Temporal Empirical Dynamic Modeling","text":"tEDM package provides suite tools exploring quantifying causality time series using Empirical Dynamic Modeling (EDM). implements four fundamental EDM-based causal discovery methods: Convergent Cross Mapping (CCM) Partial Cross Mapping (PCM) Cross Mapping Cardinality (CMC) Multispatial Convergent Cross Mapping (MultispatialCCM) methods enable researchers : Identify potential causal interactions without assuming predefined model structure. Distinguish direct causation indirect (mediated confounded) influences. Reconstruct underlying causal dynamics replicated univariate time series observed across multiple spatial units.","code":""},{"path":[]},{"path":"https://stscl.github.io/tEDM/articles/tEDM.html","id":"hong-kong-air-pollution-and-cardiovascular-admissions","dir":"Articles","previous_headings":"2. Example data in the tEDM package","what":"Hong Kong Air Pollution and Cardiovascular Admissions","title":"Temporal Empirical Dynamic Modeling","text":"daily time series dataset(1995-3 1997-11) Hong Kong includes cardiovascular hospital admissions major air pollutant concentrations. File: cvd.csv Columns: Source: Data adapted PCM article.","code":""},{"path":"https://stscl.github.io/tEDM/articles/tEDM.html","id":"us-county-level-carbon-emissions-dataset","dir":"Articles","previous_headings":"2. Example data in the tEDM package","what":"US County-Level Carbon Emissions Dataset","title":"Temporal Empirical Dynamic Modeling","text":"panel dataset covering U.S. county-level temperature carbon emissions across time. File: carbon.csv.gz Columns: Source: Data adapted FsATE article.","code":""},{"path":"https://stscl.github.io/tEDM/articles/tEDM.html","id":"covid-19-infection-counts-in-japan","dir":"Articles","previous_headings":"2. Example data in the tEDM package","what":"COVID-19 Infection Counts in Japan","title":"Temporal Empirical Dynamic Modeling","text":"spatio-temporal dataset capturing number confirmed COVID-19 infections across Japan’s 47 prefectures time. File: covid.csv Structure: column represents one 47 Japanese prefectures (e.g., Tokyo, Osaka, Hokkaido). row corresponds time step (daily). Source: Data adapted CMC article.","code":""},{"path":"https://stscl.github.io/tEDM/articles/tEDM.html","id":"case-studies-of-the-tedm-package","dir":"Articles","previous_headings":"","what":"3. Case studies of the tEDM package","title":"Temporal Empirical Dynamic Modeling","text":"Install stable version: developed version:","code":"install.packages(\"tEDM\", dep = TRUE) install.packages(\"tEDM\",                  repos = c(\"https://stscl.r-universe.dev\",                            \"https://cloud.r-project.org\"),                  dep = TRUE)"},{"path":"https://stscl.github.io/tEDM/articles/tEDM.html","id":"air-pollution-and-cardiovascular-health-in-hong-kong","dir":"Articles","previous_headings":"3. Case studies of the tEDM package","what":"Air Pollution and Cardiovascular Health in Hong Kong","title":"Temporal Empirical Dynamic Modeling","text":"Employing PCM investigate causal relationships various air pollutants cardiovascular diseases:  Determining optimal embedding dimension: Starting \\(E = 7\\), FNN ratio stabilizes near 0.19; thus, embedding dimension E neighbor number k chosen 7 onward subsequent self-prediction parameter selection.  investigate causal influences air pollutants incidence cardiovascular diseases, performed PCM analysis using embedding dimension 7 8 nearest neighbors per variable pair. PCM results shown figure :  Figure 3, can infer following causal links: Figure 4. Causal interactions air pollutants cardiovascular diseases Hong Kong.","code":"library(tEDM)  cvd = readr::read_csv(system.file(\"case/cvd.csv\",package = \"tEDM\")) ## Rows: 1032 Columns: 5 ## ── Column specification ───────────────────────────────────────────────────────── ## Delimiter: \",\" ## dbl (5): cvd, rsp, no2, so2, o3 ##  ## ℹ Use `spec()` to retrieve the full column specification for this data. ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message. head(cvd) ## # A tibble: 6 × 5 ##     cvd   rsp   no2   so2    o3 ##   <dbl> <dbl> <dbl> <dbl> <dbl> ## 1   214  73.7  74.5  19.1 17.4  ## 2   203  77.6  80.9  18.8 39.4  ## 3   202  64.8  67.1  13.8 56.4  ## 4   182  68.8  74.7  30.8  5.6  ## 5   181  49.4  62.3  23.1  3.6  ## 6   129  67.4  63.6  17.4  6.73 cvd_long = cvd |>   tibble::rowid_to_column(\"id\") |>   tidyr::pivot_longer(cols = -id,                       names_to = \"variable\", values_to = \"value\")  fig_cvds_ts = ggplot2::ggplot(cvd_long, ggplot2::aes(x = id, y = value, color = variable)) +   ggplot2::geom_line(linewidth = 0.5) +   ggplot2::labs(x = \"Days (from 1995-3 to 1997-11)\", y = \"Concentrations or \\nNO. of CVD admissions\", color = \"\") +   ggplot2::theme_bw() +   ggplot2::theme(legend.direction = \"horizontal\",                  legend.position = \"inside\",                  legend.justification = c(\"center\",\"top\"),                  legend.background = ggplot2::element_rect(fill = \"transparent\", color = NA)) fig_cvds_ts tEDM::fnn(cvd,\"cvd\",E = 2:50,eps = stats::sd(cvd$cvd)) ##       E:1       E:2       E:3       E:4       E:5       E:6       E:7       E:8  ## 0.8275862 0.4927374 0.3051882 0.2899288 0.2146490 0.2075280 0.1943032 0.1851475  ##       E:9      E:10      E:11      E:12      E:13      E:14      E:15      E:16  ## 0.1861648 0.1902340 0.1831129 0.1851475 0.1790437 0.1719227 0.1678535 0.1678535  ##      E:17      E:18      E:19      E:20      E:21      E:22      E:23      E:24  ## 0.1546287 0.1536114 0.1678535 0.1566633 0.1586979 0.1709054 0.1637843 0.1658189  ##      E:25      E:26      E:27      E:28      E:29      E:30      E:31      E:32  ## 0.1668362 0.1881994 0.1658189 0.1749746 0.1729400 0.1810783 0.1709054 0.1800610  ##      E:33      E:34      E:35      E:36      E:37      E:38      E:39      E:40  ## 0.1698881 0.1719227 0.1719227 0.1627670 0.1515768 0.1637843 0.1668362 0.1709054  ##      E:41      E:42      E:43      E:44      E:45      E:46      E:47      E:48  ## 0.1658189 0.1648016 0.1668362 0.1688708 0.1617497 0.1668362 0.1790437 0.1820956  ##      E:49  ## 0.1759919 tEDM::simplex(cvd,\"cvd\",\"cvd\",E = 7:10,k = 8:12) ## The suggested E,k,tau for variable cvd is 7, 8 and 1 tEDM::simplex(cvd,\"rsp\",\"rsp\",E = 7:10,k = 8:12) ## The suggested E,k,tau for variable rsp is 7, 8 and 1 tEDM::simplex(cvd,\"no2\",\"no2\",E = 7:10,k = 8:12) ## The suggested E,k,tau for variable no2 is 7, 8 and 1 tEDM::simplex(cvd,\"so2\",\"so2\",E = 7:10,k = 8:12) ## The suggested E,k,tau for variable so2 is 7, 11 and 1 tEDM::simplex(cvd,\"o3\",\"o3\",E = 7:10,k = 8:12) ## The suggested E,k,tau for variable o3 is 7, 8 and 1  s1 = tEDM::simplex(cvd,\"cvd\",\"cvd\",E = 7,k = 8:12) s2 = tEDM::simplex(cvd,\"rsp\",\"rsp\",E = 7,k = 8:12) s3 = tEDM::simplex(cvd,\"no2\",\"no2\",E = 7,k = 8:12) s4 = tEDM::simplex(cvd,\"so2\",\"so2\",E = 7,k = 8:12) s5 = tEDM::simplex(cvd,\"o3\",\"o3\",E = 7,k = 8:12)  list(s1,s2,s3,s4,s5) ## [[1]] ## The suggested E,k,tau for variable cvd is 7, 8 and 1  ##  ## [[2]] ## The suggested E,k,tau for variable rsp is 7, 9 and 1  ##  ## [[3]] ## The suggested E,k,tau for variable no2 is 7, 8 and 1  ##  ## [[4]] ## The suggested E,k,tau for variable so2 is 7, 11 and 1  ##  ## [[5]] ## The suggested E,k,tau for variable o3 is 7, 8 and 1  simplex_df = purrr::map2_dfr(list(s1,s2,s3,s4,s5),                              c(\"cvd\",\"rsp\",\"no2\",\"so2\",\"o3\"),                              \\(.list,.name) dplyr::mutate(.list$xmap,variable = .name)) ggplot2::ggplot(data = simplex_df) +   ggplot2::geom_line(ggplot2::aes(x = k, y = rho, color = variable)) vars = c(\"cvd\", \"rsp\", \"no2\", \"so2\", \"o3\") res = list() var_pairs = combn(vars, 2, simplify = FALSE)  for (pair in var_pairs) {   var1 = pair[1]   var2 = pair[2]   conds = setdiff(vars, pair)   key = paste0(var1, \"_\", var2)   res[[key]] = tEDM::pcm(data = cvd,                          cause = var2,                          effect = var1,                          conds = conds,                          E = 7, k = 8,                          progress = FALSE) } .process_xmap_result = \\(g,type = c(\"xmap\",\"pxmap\")){   type = match.arg(type)   tempdf = g[[type]]   tempdf$x = g$varname[1]   tempdf$y = g$varname[2]   tempdf = tempdf |>     dplyr::select(1, x, y,                   x_xmap_y_mean,x_xmap_y_sig,                   y_xmap_x_mean,y_xmap_x_sig,                   dplyr::everything()) |>     dplyr::slice_tail(n = 1)    g1 = tempdf |>     dplyr::select(x,y,y_xmap_x_mean,y_xmap_x_sig)|>     purrr::set_names(c(\"cause\",\"effect\",\"cs\",\"sig\"))   g2 = tempdf |>     dplyr::select(y,x,x_xmap_y_mean,x_xmap_y_sig) |>     purrr::set_names(c(\"cause\",\"effect\",\"cs\",\"sig\"))    return(rbind(g1,g2)) }  plot_cs_matrix = \\(.tbf,legend_title = expression(rho)){   .tbf = .tbf |>     dplyr::mutate(sig_marker = dplyr::case_when(       sig > 0.05 ~ sprintf(\"paste(%.4f^'#')\", cs),       TRUE ~ sprintf('%.4f', cs)     ))    fig = ggplot2::ggplot(data = .tbf,                         ggplot2::aes(x = effect, y = cause)) +     ggplot2::geom_tile(color = \"black\", ggplot2::aes(fill = cs)) +     ggplot2::geom_abline(slope = 1, intercept = 0,                          color = \"black\", linewidth = 0.25) +     ggplot2::geom_text(ggplot2::aes(label = sig_marker), parse = TRUE,                        color = \"black\", family = \"serif\") +     ggplot2::labs(x = \"Effect\", y = \"Cause\", fill = legend_title) +     ggplot2::scale_x_discrete(expand = c(0, 0)) +     ggplot2::scale_y_discrete(expand = c(0, 0)) +     ggplot2::scale_fill_gradient(low = \"#9bbbb8\", high = \"#256c68\") +     ggplot2::coord_equal() +     ggplot2::theme_void() +     ggplot2::theme(       axis.text.x = ggplot2::element_text(angle = 0, family = \"serif\"),       axis.text.y = ggplot2::element_text(color = \"black\", family = \"serif\"),       axis.title.y = ggplot2::element_text(angle = 90, family = \"serif\"),       axis.title.x = ggplot2::element_text(color = \"black\", family = \"serif\",                                            margin = ggplot2::margin(t = 5.5, unit = \"pt\")),       legend.text = ggplot2::element_text(family = \"serif\"),       legend.title = ggplot2::element_text(family = \"serif\"),       legend.background = ggplot2::element_rect(fill = NA, color = NA),       #legend.direction = \"horizontal\",       #legend.position = \"bottom\",       legend.margin = ggplot2::margin(t = 1, r = 0, b = 0, l = 0, unit = \"pt\"),       legend.key.width = ggplot2::unit(20, \"pt\"),       panel.grid = ggplot2::element_blank(),       panel.border = ggplot2::element_rect(color = \"black\", fill = NA)     )   return(fig) }  pcm_df = purrr::map_dfr(res,\\(.list) .process_xmap_result(.list,type = \"pxmap\")) fig_pcs = plot_cs_matrix(pcm_df) fig_pcs"},{"path":"https://stscl.github.io/tEDM/articles/tEDM.html","id":"us-county-carbon-emissions-and-temperature-dynamics","dir":"Articles","previous_headings":"3. Case studies of the tEDM package","what":"US County Carbon Emissions and Temperature Dynamics","title":"Temporal Empirical Dynamic Modeling","text":"examine whether causal relationship exists annual mean temperature total annual CO₂ emissions, implement CMC method across counties. Using 100th county example, determine appropriate embedding dimension applying FNN method. E equals 3, FNN ratio begins drop zero; therefore, select \\(E = 3\\) embedding dimension CMC analysis.","code":"library(tEDM)  carbon = readr::read_csv(system.file(\"case/carbon.csv.gz\",package = \"tEDM\")) ## Rows: 113627 Columns: 4 ## ── Column specification ───────────────────────────────────────────────────────── ## Delimiter: \",\" ## dbl (4): year, fips, tem, carbon ##  ## ℹ Use `spec()` to retrieve the full column specification for this data. ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message. head(carbon) ## # A tibble: 6 × 4 ##    year  fips   tem     carbon ##   <dbl> <dbl> <dbl>      <dbl> ## 1  1981  1001  17.4 192607687. ## 2  1982  1001  18.4 187149414. ## 3  1983  1001  16.9 191584445. ## 4  1984  1001  17.8 199157579. ## 5  1985  1001  17.9 205207564. ## 6  1986  1001  18.5 218446030.  carbon_list = dplyr::group_split(carbon, by = fips) length(carbon_list) ## [1] 3071 tEDM::fnn(carbon_list[[100]],\"carbon\",E = 2:10,eps = stats::sd(carbon_list[[100]]$carbon)) ##        E:1        E:2        E:3        E:4        E:5        E:6        E:7  ## 0.35714286 0.03571429 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000  ##        E:8        E:9  ## 0.00000000 0.00000000 res = carbon_list |>   purrr::map_dfr(\\(.x) {     g = tEDM::cmc(.x,\"tem\",\"carbon\",E = 3,k = 18,dist.metric = \"L2\",progressbar = FALSE)     return(g$xmap)   }) head(res) ##   neighbors x_xmap_y_mean x_xmap_y_sig x_xmap_y_lower x_xmap_y_upper ## 1        18     0.2669753 0.0083829567     0.09372879      0.4402218 ## 2        18     0.2314815 0.0012106678     0.06886439      0.3940986 ## 3        18     0.2021605 0.0001563996     0.04775587      0.3565651 ## 4        18     0.2947531 0.0276001573     0.11214275      0.4773634 ## 5        18     0.2824074 0.0180642479     0.10202679      0.4627880 ## 6        18     0.2098765 0.0002847089     0.05317822      0.3665749 ##   y_xmap_x_mean y_xmap_x_sig y_xmap_x_lower y_xmap_x_upper ## 1    0.09104938 1.175387e-14              0      0.1948920 ## 2    0.08796296 1.186317e-16              0      0.1854438 ## 3    0.08024691 1.217722e-17              0      0.1764553 ## 4    0.08487654 5.431816e-17              0      0.1820035 ## 5    0.09413580 1.725075e-14              0      0.1978540 ## 6    0.08024691 1.217722e-17              0      0.1764553  res_carbon = res |>   dplyr::select(neighbors,                 carbon_tem = x_xmap_y_mean,                 tem_carbon = y_xmap_x_mean) |>   tidyr::pivot_longer(c(carbon_tem, tem_carbon),                       names_to = \"variable\", values_to = \"value\") head(res_carbon) ## # A tibble: 6 × 3 ##   neighbors variable    value ##       <dbl> <chr>       <dbl> ## 1        18 carbon_tem 0.267  ## 2        18 tem_carbon 0.0910 ## 3        18 carbon_tem 0.231  ## 4        18 tem_carbon 0.0880 ## 5        18 carbon_tem 0.202  ## 6        18 tem_carbon 0.0802 res_carbon$variable = factor(res_carbon$variable,                              levels = c(\"carbon_tem\", \"tem_carbon\"),                              labels = c(\"carbon → tem\", \"tem → carbon\")) fig_case2 = ggplot2::ggplot(res_carbon,                             ggplot2::aes(x = variable, y = value, fill = variable)) +   ggplot2::geom_boxplot() +   ggplot2::geom_hline(yintercept = 0.2, linetype = \"dashed\", color = \"red\", linewidth = 0.8) +   ggplot2::theme_bw() +   ggplot2::scale_x_discrete(name = \"\") +   ggplot2::scale_y_continuous(name = \"Causal Strength\",                               expand = c(0,0),                               limits = c(0,0.45),                               breaks = seq(0,0.45,by = 0.05)) +   ggplot2::theme(legend.position = \"none\",                  axis.text.x = ggplot2::element_text(size = 12),                  axis.text.y = ggplot2::element_text(size = 12),                  axis.title.y = ggplot2::element_text(size = 12.5)) fig_case2"},{"path":"https://stscl.github.io/tEDM/articles/tEDM.html","id":"covid-19-spread-across-japanese-prefectures","dir":"Articles","previous_headings":"3. Case studies of the tEDM package","what":"COVID-19 Spread Across Japanese Prefectures","title":"Temporal Empirical Dynamic Modeling","text":"examine COVID-19 transmission Tokyo prefectures applying CCM identify underlying causal dynamics epidemic spread data first differenced: Using Tokyo’s COVID-19 infection data test optimal embedding dimension. Since FNN ratio begins approach 0.0296 E equals 10, embedding dimensions 10 onward evaluated, pair E k yielding highest self-prediction accuracy selected CCM procedure. Using 0.90 threshold (rounded two decimal places), map causal responses spread COVID-19 Tokyo causal strength greater 0.90.","code":"library(tEDM)  covid = readr::read_csv(system.file(\"case/covid.csv\",package = \"tEDM\")) ## Rows: 334 Columns: 47 ## ── Column specification ───────────────────────────────────────────────────────── ## Delimiter: \",\" ## dbl (47): Hokkaido, Aomori, Iwate, Miyagi, Akita, Yamagata, Fukushima, Ibarak... ##  ## ℹ Use `spec()` to retrieve the full column specification for this data. ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message. head(covid) ## # A tibble: 6 × 47 ##   Hokkaido Aomori Iwate Miyagi Akita Yamagata Fukushima Ibaraki Tochigi Gunma ##      <dbl>  <dbl> <dbl>  <dbl> <dbl>    <dbl>     <dbl>   <dbl>   <dbl> <dbl> ## 1        0      0     0      0     0        0         0       0       0     0 ## 2        0      0     0      0     0        0         0       0       0     0 ## 3        0      0     0      0     0        0         0       0       0     0 ## 4        0      0     0      0     0        0         0       0       0     0 ## 5        0      0     0      0     0        0         0       0       0     0 ## 6        0      0     0      0     0        0         0       0       0     0 ## # ℹ 37 more variables: Saitama <dbl>, Chiba <dbl>, Tokyo <dbl>, Kanagawa <dbl>, ## #   Niigata <dbl>, Toyama <dbl>, Ishikawa <dbl>, Fukui <dbl>, Yamanashi <dbl>, ## #   Nagano <dbl>, Gifu <dbl>, Shizuoka <dbl>, Aichi <dbl>, Mie <dbl>, ## #   Shiga <dbl>, Kyoto <dbl>, Osaka <dbl>, Hyogo <dbl>, Nara <dbl>, ## #   Wakayama <dbl>, Tottori <dbl>, Shimane <dbl>, Okayama <dbl>, ## #   Hiroshima <dbl>, Yamaguchi <dbl>, Tokushima <dbl>, Kagawa <dbl>, ## #   Ehime <dbl>, Kochi <dbl>, Fukuoka <dbl>, Saga <dbl>, Nagasaki <dbl>, … covid = covid |>   dplyr::mutate(dplyr::across(dplyr::everything(),                               \\(.x) c(NA,diff(.x)))) |>   dplyr::filter(dplyr::if_all(dplyr::everything(),                 \\(.x) !is.na(.x))) tEDM::fnn(covid,\"Tokyo\",E = 2:30,eps = stats::sd(covid$Tokyo)) ##        E:1        E:2        E:3        E:4        E:5        E:6        E:7  ## 0.79452055 0.20070423 0.09459459 0.06666667 0.05629139 0.03947368 0.04605263  ##        E:8        E:9       E:10       E:11       E:12       E:13       E:14  ## 0.05263158 0.05263158 0.02960526 0.02960526 0.03947368 0.02302632 0.02631579  ##       E:15       E:16       E:17       E:18       E:19       E:20       E:21  ## 0.02302632 0.02960526 0.03618421 0.04605263 0.05263158 0.05263158 0.05592105  ##       E:22       E:23       E:24       E:25       E:26       E:27       E:28  ## 0.03947368 0.03289474 0.02960526 0.02960526 0.02631579 0.03289474 0.04276316  ##       E:29  ## 0.04605263 tEDM::simplex(covid,\"Tokyo\",\"Tokyo\",E = 10:20,k = 11:25) ## The suggested E,k,tau for variable Tokyo is 10, 12 and 1 res = names(covid)[-match(\"Tokyo\",names(covid))] |>   purrr::map_dfr(\\(.l) {     g = tEDM::ccm(covid,\"Tokyo\",.l,E = 10,k = 12,progressbar = FALSE)     res = dplyr::mutate(g$xmap,x = \"Tokyo\",y = .l)     return(res)   }) head(res) ##   libsizes x_xmap_y_mean x_xmap_y_sig x_xmap_y_lower x_xmap_y_upper ## 1      324     0.7084551 0.0000000000     0.64964305      0.7588380 ## 2      324     0.2046948 0.0002075707     0.09791848      0.3068120 ## 3      324     0.5757997 0.0000000000     0.49808921      0.6443348 ## 4      324     0.5691621 0.0000000000     0.49062873      0.6385236 ## 5      324     0.1639373 0.0030812353     0.05597701      0.2681084 ## 6      324     0.7136233 0.0000000000     0.65564363      0.7632368 ##   y_xmap_x_mean y_xmap_x_sig y_xmap_x_lower y_xmap_x_upper     x        y ## 1     0.7689897            0      0.7203905      0.8100744 Tokyo Hokkaido ## 2     0.4997165            0      0.4132578      0.5772461 Tokyo   Aomori ## 3     0.7884318            0      0.7433293      0.8263980 Tokyo    Iwate ## 4     0.7971954            0      0.7537038      0.8337352 Tokyo   Miyagi ## 5     0.4385033            0      0.3460785      0.5224988 Tokyo    Akita ## 6     0.5300848            0      0.4469389      0.6041504 Tokyo Yamagata  df1 = res |>     dplyr::select(x,y,y_xmap_x_mean,y_xmap_x_sig)|>     purrr::set_names(c(\"cause\",\"effect\",\"cs\",\"sig\")) df2 = res |>     dplyr::select(y,x,x_xmap_y_mean,x_xmap_y_sig) |>     purrr::set_names(c(\"cause\",\"effect\",\"cs\",\"sig\")) res_covid = dplyr::bind_rows(df1,df2)|>   dplyr::filter(cause == \"Tokyo\") |>   dplyr::arrange(dplyr::desc(cs)) head(res_covid,10) ##    cause   effect        cs sig ## 1  Tokyo Kanagawa 0.9358728   0 ## 2  Tokyo    Osaka 0.9350703   0 ## 3  Tokyo    Chiba 0.9289090   0 ## 4  Tokyo  Saitama 0.9265648   0 ## 5  Tokyo     Nara 0.9200096   0 ## 6  Tokyo    Aichi 0.9156088   0 ## 7  Tokyo    Hyogo 0.9043978   0 ## 8  Tokyo Shizuoka 0.8949104   0 ## 9  Tokyo  Ibaraki 0.8940835   0 ## 10 Tokyo     Gifu 0.8773113   0 res_covid = res_covid |>   dplyr::mutate(cs = round(res_covid$cs,2)) |>   dplyr::filter(cs >= 0.90) res_covid ##   cause   effect   cs sig ## 1 Tokyo Kanagawa 0.94   0 ## 2 Tokyo    Osaka 0.94   0 ## 3 Tokyo    Chiba 0.93   0 ## 4 Tokyo  Saitama 0.93   0 ## 5 Tokyo     Nara 0.92   0 ## 6 Tokyo    Aichi 0.92   0 ## 7 Tokyo    Hyogo 0.90   0  if (!requireNamespace(\"rnaturalearth\")) {   install.packages(\"rnaturalearth\") } ## Loading required namespace: rnaturalearth jp = rnaturalearth::ne_states(country = \"Japan\")  if (!requireNamespace(\"tidygeocoder\")) {   install.packages(\"tidygeocoder\") } ## Loading required namespace: tidygeocoder jpp = tibble::tibble(name = c(\"Tokyo\",res_covid$effect)) |>   dplyr::mutate(type = factor(c(\"source\",rep(\"target\",7)),                               levels = c(\"source\",\"target\"))) |>   tidygeocoder::geocode(state = name, method = \"arcgis\",                         long = \"lon\", lat = \"lat\") ## Passing 8 addresses to the ArcGIS single address geocoder ## Query completed in: 5.3 seconds  fig_case3 = ggplot2::ggplot() +   ggplot2::geom_sf(data = jp, fill = \"#ffe7b7\", color = \"grey\", linewidth = 0.45) +   ggplot2::geom_curve(data = jpp[-1,],                       ggplot2::aes(x = jpp[1,\"lon\",drop = TRUE],                                    y = jpp[1,\"lat\",drop = TRUE],                                    xend = lon, yend = lat),                       curvature = 0.2,                       arrow = ggplot2::arrow(length = ggplot2::unit(0.2, \"cm\")),                       color = \"#6eab47\", linewidth = 1) +   ggplot2::geom_point(data = jpp,                       ggplot2::aes(x = lon, y = lat, color = type),                       size = 1.25, show.legend = FALSE) +   ggrepel::geom_text_repel(data = jpp,                            ggplot2::aes(label = name, x = lon, y = lat, color = type),                            show.legend = FALSE) +   ggplot2::scale_color_manual(values = c(source = \"#2c74b7\",                                          target = \"#cf574b\")) +   ggplot2::coord_sf(xlim = range(jpp$lon) + c(-0.45,0.45),                     ylim = range(jpp$lat) + c(-0.75,0.75)) +   ggplot2::labs(x = \"\", y = \"\") +   ggplot2::theme_bw() +   ggplot2::theme(panel.background = ggplot2::element_rect(fill = \"#9cd1fd\", color = NA),                  plot.margin = ggplot2::margin(0, 0, 0, 0, unit = \"cm\"))  fig_case3"},{"path":"https://stscl.github.io/tEDM/articles/tEDM.html","id":"reference","dir":"Articles","previous_headings":"","what":"Reference","title":"Temporal Empirical Dynamic Modeling","text":"Sugihara, G., May, R., Ye, H., Hsieh, C., Deyle, E., Fogarty, M., Munch, S., 2012. Detecting Causality Complex Ecosystems. Science 338, 496–500. https://doi.org/10.1126/science.1227079. Leng, S., Ma, H., Kurths, J., Lai, Y.-C., Lin, W., Aihara, K., Chen, L., 2020. Partial cross mapping eliminates indirect causal influences. Nature Communications 11. https://doi.org/10.1038/s41467-020-16238-0. Tao, P., Wang, Q., Shi, J., Hao, X., Liu, X., Min, B., Zhang, Y., Li, C., Cui, H., Chen, L., 2023. Detecting dynamical causality intersection cardinal concavity. Fundamental Research. https://doi.org/10.1016/j.fmre.2023.01.007. Clark, .T., Ye, H., Isbell, F., Deyle, E.R., Cowles, J., Tilman, G.D., Sugihara, G., 2015. Spatial convergent cross mapping detect causal relationships short time series. Ecology 96, 1174–1181. https://doi.org/10.1890/14-1479.1. Gan, T., Succar, R., Macrì, S., Marín, M.R., Porfiri, M., 2025. Causal discovery city data, urban scaling meets information theory. Cities 162, 105980. https://doi.org/10.1016/j.cities.2025.105980.  ","code":""},{"path":"https://stscl.github.io/tEDM/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Wenbo Lv. Author, maintainer, copyright holder.","code":""},{"path":"https://stscl.github.io/tEDM/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Lv W (2026). tEDM: Temporal Empirical Dynamic Modeling. doi:10.32614/CRAN.package.tEDM, R package version 1.2.","code":"@Manual{,   title = {{tEDM: Temporal Empirical Dynamic Modeling}},   author = {Wenbo Lv},   year = {2026},   note = {R package version 1.2},   doi = {10.32614/CRAN.package.tEDM}, }"},{"path":"https://stscl.github.io/tEDM/index.html","id":"tedm-","dir":"","previous_headings":"","what":"tEDM | Temporal Empirical Dynamic Modeling\n","title":"tEDM | Temporal Empirical Dynamic Modeling\n","text":"Temporal Empirical Dynamic Modeling","code":""},{"path":"https://stscl.github.io/tEDM/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"tEDM | Temporal Empirical Dynamic Modeling\n","text":"tEDM package provides suite tools exploring quantifying causality time series using Empirical Dynamic Modeling (EDM). particularly designed detect, differentiate, reconstruct causal dynamics systems traditional assumptions linearity stationarity may hold. package implements four fundamental EDM-based methods: Convergent Cross Mapping (CCM) – detecting nonlinear causal relationships time series. Partial Cross Mapping (PCM) – disentangling direct indirect causal influences. Cross Mapping Cardinality (CMC) – identifying time-varying state-dependent causal linkages. Multispatial Convergent Cross Mapping (MultispatialCCM) – reconstructing causal dynamics replicated time series across multiple spatial locations. Refer package documentation https://stscl.github.io/tEDM/ detailed information.","code":""},{"path":"https://stscl.github.io/tEDM/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"tEDM | Temporal Empirical Dynamic Modeling\n","text":"Install CRAN : Install binary version R-universe : Install source code GitHub :","code":"install.packages(\"tEDM\", dep = TRUE) install.packages(\"tEDM\",                  repos = c(\"https://stscl.r-universe.dev\",                            \"https://cloud.r-project.org\"),                  dep = TRUE) if (!requireNamespace(\"devtools\")) {     install.packages(\"devtools\") } devtools::install_github(\"stscl/tEDM\",                          #build_vignettes = TRUE,                          dep = TRUE)"},{"path":"https://stscl.github.io/tEDM/index.html","id":"reference","dir":"","previous_headings":"","what":"Reference","title":"tEDM | Temporal Empirical Dynamic Modeling\n","text":"Sugihara, G., May, R., Ye, H., Hsieh, C., Deyle, E., Fogarty, M., Munch, S., 2012. Detecting Causality Complex Ecosystems. Science 338, 496–500. https://doi.org/10.1126/science.1227079. Leng, S., Ma, H., Kurths, J., Lai, Y.-C., Lin, W., Aihara, K., Chen, L., 2020. Partial cross mapping eliminates indirect causal influences. Nature Communications 11. https://doi.org/10.1038/s41467-020-16238-0. Tao, P., Wang, Q., Shi, J., Hao, X., Liu, X., Min, B., Zhang, Y., Li, C., Cui, H., Chen, L., 2023. Detecting dynamical causality intersection cardinal concavity. Fundamental Research. https://doi.org/10.1016/j.fmre.2023.01.007. Clark, .T., Ye, H., Isbell, F., Deyle, E.R., Cowles, J., Tilman, G.D., Sugihara, G., 2015. Spatial convergent cross mapping detect causal relationships short time series. Ecology 96, 1174–1181. https://doi.org/10.1890/14-1479.1.  ","code":""},{"path":"https://stscl.github.io/tEDM/reference/ccm.html","id":null,"dir":"Reference","previous_headings":"","what":"convergent cross mapping — ccm","title":"convergent cross mapping — ccm","text":"convergent cross mapping","code":""},{"path":"https://stscl.github.io/tEDM/reference/ccm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"convergent cross mapping — ccm","text":"","code":"# S4 method for class 'data.frame' ccm(   data,   cause,   effect,   libsizes = NULL,   E = 3,   tau = 1,   k = E + 1,   theta = 1,   algorithm = \"simplex\",   lib = NULL,   pred = NULL,   dist.metric = \"L1\",   dist.average = TRUE,   threads = length(pred),   parallel.level = \"low\",   bidirectional = TRUE,   progressbar = TRUE )"},{"path":"https://stscl.github.io/tEDM/reference/ccm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"convergent cross mapping — ccm","text":"data observation data. cause name causal variable. effect name effect variable. libsizes (optional) number time points used. E (optional) embedding dimensions. tau (optional) step time lags. k (optional) number nearest neighbors. theta (optional) weighting parameter distances, useful algorithm smap. algorithm (optional) prediction algorithm. lib (optional) libraries indices. pred (optional) predictions indices. dist.metric (optional) distance metric (L1: Manhattan, L2: Euclidean). dist.average (optional) whether average distance. threads (optional) number threads use. parallel.level (optional) level parallelism, low high. bidirectional (optional) whether examine bidirectional causality. progressbar (optional) whether show progress bar.","code":""},{"path":"https://stscl.github.io/tEDM/reference/ccm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"convergent cross mapping — ccm","text":"list xmap cross mapping results varname names causal effect variables bidirectional whether examine bidirectional causality","code":""},{"path":"https://stscl.github.io/tEDM/reference/ccm.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"convergent cross mapping — ccm","text":"Sugihara, G., May, R., Ye, H., Hsieh, C., Deyle, E., Fogarty, M., Munch, S., 2012. Detecting Causality Complex Ecosystems. Science 338, 496–500.","code":""},{"path":"https://stscl.github.io/tEDM/reference/ccm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"convergent cross mapping — ccm","text":"","code":"sim = logistic_map(x = 0.4,y = 0.4,step = 45,beta_xy = 0.5,beta_yx = 0) ccm(sim,\"x\",\"y\",libsizes = seq(5,45,5),E = 10,k = 7,threads = 1) #>  Computing: [========================================] 100% (done)                          #>  Computing: [========================================] 100% (done)                          #>   libsizes      x->y      y->x #> 1        5 0.7317932 0.4983917 #> 2       10 0.8339459 0.5616168 #> 3       15 0.8507719 0.5562459 #> 4       20 0.8477833 0.5504471 #> 5       25 0.8447305 0.5472295 #> 6       30 0.8418430 0.5434684 #> 7       35 0.8408701 0.5444756 #> 8       36 0.8961972 0.6705183"},{"path":"https://stscl.github.io/tEDM/reference/cmc.html","id":null,"dir":"Reference","previous_headings":"","what":"cross mapping cardinality — cmc","title":"cross mapping cardinality — cmc","text":"cross mapping cardinality","code":""},{"path":"https://stscl.github.io/tEDM/reference/cmc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"cross mapping cardinality — cmc","text":"","code":"# S4 method for class 'data.frame' cmc(   data,   cause,   effect,   libsizes = NULL,   E = 3,   tau = 1,   k = pmin(E^2),   lib = NULL,   pred = NULL,   dist.metric = \"L1\",   threads = length(pred),   parallel.level = \"low\",   bidirectional = TRUE,   progressbar = TRUE )"},{"path":"https://stscl.github.io/tEDM/reference/cmc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"cross mapping cardinality — cmc","text":"data observation data. cause name causal variable. effect name effect variable. libsizes (optional) number time points used. E (optional) embedding dimensions. tau (optional) step time lags. k (optional) number nearest neighbors. lib (optional) libraries indices. pred (optional) predictions indices. dist.metric (optional) distance metric (L1: Manhattan, L2: Euclidean). threads (optional) number threads use. parallel.level (optional) level parallelism, low high. bidirectional (optional) whether examine bidirectional causality. progressbar (optional) whether show progress bar.","code":""},{"path":"https://stscl.github.io/tEDM/reference/cmc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"cross mapping cardinality — cmc","text":"list xmap cross mapping results cs causal strength varname names causal effect variables bidirectional whether examine bidirectional causality","code":""},{"path":"https://stscl.github.io/tEDM/reference/cmc.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"cross mapping cardinality — cmc","text":"Tao, P., Wang, Q., Shi, J., Hao, X., Liu, X., Min, B., Zhang, Y., Li, C., Cui, H., Chen, L., 2023. Detecting dynamical causality intersection cardinal concavity. Fundamental Research.","code":""},{"path":"https://stscl.github.io/tEDM/reference/cmc.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"cross mapping cardinality — cmc","text":"","code":"sim = logistic_map(x = 0.4,y = 0.4,step = 45,beta_xy = 0.5,beta_yx = 0) cmc(sim,\"x\",\"y\",E = 4,k = 15,threads = 1) #>  Computing: [========================================] 100% (done)                          #>  Computing: [========================================] 100% (done)                          #>   neighbors      x->y      y->x #> 1        15 0.2666667 0.1333333"},{"path":"https://stscl.github.io/tEDM/reference/embedded.html","id":null,"dir":"Reference","previous_headings":"","what":"embedding time series data — embedded","title":"embedding time series data — embedded","text":"embedding time series data","code":""},{"path":"https://stscl.github.io/tEDM/reference/embedded.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"embedding time series data — embedded","text":"","code":"# S4 method for class 'data.frame' embedded(data, target, E = 3, tau = 1)"},{"path":"https://stscl.github.io/tEDM/reference/embedded.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"embedding time series data — embedded","text":"data observation data. target name target variable. E (optional) embedding dimensions. tau (optional) step time lags.","code":""},{"path":"https://stscl.github.io/tEDM/reference/embedded.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"embedding time series data — embedded","text":"matrix","code":""},{"path":"https://stscl.github.io/tEDM/reference/embedded.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"embedding time series data — embedded","text":"","code":"embedded(data.frame(t = 1:5),\"t\",3) #>      [,1] [,2] [,3] #> [1,]    1  NaN  NaN #> [2,]    2    1  NaN #> [3,]    3    2    1 #> [4,]    4    3    2 #> [5,]    5    4    3"},{"path":"https://stscl.github.io/tEDM/reference/fnn.html","id":null,"dir":"Reference","previous_headings":"","what":"false nearest neighbours — fnn","title":"false nearest neighbours — fnn","text":"false nearest neighbours","code":""},{"path":"https://stscl.github.io/tEDM/reference/fnn.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"false nearest neighbours — fnn","text":"","code":"# S4 method for class 'data.frame' fnn(   data,   target,   lib = NULL,   pred = NULL,   E = 2:10,   tau = 1,   dist.metric = \"L1\",   rt = 10,   eps = 2,   threads = length(E) )"},{"path":"https://stscl.github.io/tEDM/reference/fnn.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"false nearest neighbours — fnn","text":"data observation data. target name target variable. lib (optional) libraries indices. pred (optional) predictions indices. E (optional) embedding dimensions. tau (optional) step time lags. dist.metric (optional) distance metric (L1: Manhattan, L2: Euclidean). rt (optional) escape factor. eps (optional) neighborhood diameter. threads (optional) number threads use.","code":""},{"path":"https://stscl.github.io/tEDM/reference/fnn.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"false nearest neighbours — fnn","text":"vector","code":""},{"path":"https://stscl.github.io/tEDM/reference/fnn.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"false nearest neighbours — fnn","text":"Kennel M. B., Brown R. Abarbanel H. D. ., Determining embedding dimension phase-space reconstruction using geometrical construction, Phys. Rev. , Volume 45, 3403 (1992).","code":""},{"path":"https://stscl.github.io/tEDM/reference/fnn.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"false nearest neighbours — fnn","text":"","code":"sim = logistic_map(x = 0.4,y = 0.4,step = 45,beta_xy = 0.5,beta_yx = 0) fnn(sim,\"x\",threads = 1) #>       E:1       E:2       E:3       E:4       E:5       E:6       E:7       E:8  #> 0.1944444 0.1388889 0.1111111 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000  #>       E:9  #> 0.0000000"},{"path":"https://stscl.github.io/tEDM/reference/ic.html","id":null,"dir":"Reference","previous_headings":"","what":"intersection cardinality — ic","title":"intersection cardinality — ic","text":"intersection cardinality","code":""},{"path":"https://stscl.github.io/tEDM/reference/ic.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"intersection cardinality — ic","text":"","code":"# S4 method for class 'data.frame' ic(   data,   column,   target,   lib = NULL,   pred = NULL,   E = 2:10,   tau = 1,   k = E + 2,   dist.metric = \"L1\",   threads = length(pred),   parallel.level = \"low\" )"},{"path":"https://stscl.github.io/tEDM/reference/ic.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"intersection cardinality — ic","text":"data observation data. column name library variable. target name target variable. lib (optional) libraries indices. pred (optional) predictions indices. E (optional) embedding dimensions. tau (optional) step time lags. k (optional) number nearest neighbors used prediction. dist.metric (optional) distance metric (L1: Manhattan, L2: Euclidean). threads (optional) number threads use. parallel.level (optional) level parallelism, low high.","code":""},{"path":"https://stscl.github.io/tEDM/reference/ic.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"intersection cardinality — ic","text":"list xmap cross mapping performance varname name target variable method method cross mapping","code":""},{"path":"https://stscl.github.io/tEDM/reference/ic.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"intersection cardinality — ic","text":"Tao, P., Wang, Q., Shi, J., Hao, X., Liu, X., Min, B., Zhang, Y., Li, C., Cui, H., Chen, L., 2023. Detecting dynamical causality intersection cardinal concavity. Fundamental Research.","code":""},{"path":"https://stscl.github.io/tEDM/reference/ic.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"intersection cardinality — ic","text":"","code":"sim = logistic_map(x = 0.4,y = 0.4,step = 45,beta_xy = 0.5,beta_yx = 0) ic(sim,\"x\",\"y\",E = 4,k = 15:30,threads = 1) #> The suggested E,k,tau for variable y is 4, 15 and 1"},{"path":"https://stscl.github.io/tEDM/reference/logistic_map.html","id":null,"dir":"Reference","previous_headings":"","what":"logistic map — logistic_map","title":"logistic map — logistic_map","text":"logistic map","code":""},{"path":"https://stscl.github.io/tEDM/reference/logistic_map.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"logistic map — logistic_map","text":"","code":"logistic_map(   x,   y = NULL,   z = NULL,   step = 15,   alpha_x = 3.6,   alpha_y = 3.72,   alpha_z = 3.68,   beta_xy = 0.05,   beta_xz = 0.05,   beta_yx = 0.2,   beta_yz = 0.2,   beta_zx = 0.35,   beta_zy = 0.35,   threshold = Inf,   transient = 1 )"},{"path":"https://stscl.github.io/tEDM/reference/logistic_map.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"logistic map — logistic_map","text":"x value x. y (optional) value y. z (optional) value z. step (optional) number simulation time steps. alpha_x (optional) growth parameter x. alpha_y (optional) growth parameter y. alpha_z (optional) growth parameter y. beta_xy (optional) cross-inhibition x y. beta_xz (optional) cross-inhibition x z. beta_yx (optional) cross-inhibition y x. beta_yz (optional) cross-inhibition y z. beta_zx (optional) cross-inhibition z x. beta_zy (optional) cross-inhibition z y. threshold (optional) set NaN absolute value exceeds threshold. transient (optional) transients excluded results.","code":""},{"path":"https://stscl.github.io/tEDM/reference/logistic_map.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"logistic map — logistic_map","text":"data.frame","code":""},{"path":"https://stscl.github.io/tEDM/reference/logistic_map.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"logistic map — logistic_map","text":"","code":"logistic_map(x = 0.2) #>            x #> 1  0.5760000 #> 2  0.8792064 #> 3  0.3823290 #> 4  0.8501527 #> 5  0.4586150 #> 6  0.8938342 #> 7  0.3416206 #> 8  0.8096975 #> 9  0.5547149 #> 10 0.8892226 #> 11 0.3546207 #> 12 0.8239135 #> 13 0.5222881 #> 14 0.8982117 #> 15 0.3291389"},{"path":"https://stscl.github.io/tEDM/reference/multispatialccm.html","id":null,"dir":"Reference","previous_headings":"","what":"multispatial convergent cross mapping — multispatialccm","title":"multispatial convergent cross mapping — multispatialccm","text":"multispatial convergent cross mapping","code":""},{"path":"https://stscl.github.io/tEDM/reference/multispatialccm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"multispatial convergent cross mapping — multispatialccm","text":"","code":"# S4 method for class 'list' multispatialccm(   data,   cause,   effect,   libsizes,   E = 3,   tau = 1,   k = E + 1,   lib = NULL,   boot = 99,   seed = 42,   dist.metric = \"L1\",   dist.average = TRUE,   threads = length(libsizes),   parallel.level = \"low\",   bidirectional = TRUE,   progressbar = TRUE )"},{"path":"https://stscl.github.io/tEDM/reference/multispatialccm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"multispatial convergent cross mapping — multispatialccm","text":"data observation data. cause name causal variable. effect name effect variable. libsizes number time points used prediction. E (optional) embedding dimensions. tau (optional) step time lags. k (optional) number nearest neighbors used prediction. lib (optional) libraries indices. boot (optional) number bootstraps perform. seed (optional) random seed. dist.metric (optional) distance metric (L1: Manhattan, L2: Euclidean). dist.average (optional) whether average distance. threads (optional) number threads use. parallel.level (optional) level parallelism, low high. bidirectional (optional) whether examine bidirectional causality. progressbar (optional) whether show progress bar.","code":""},{"path":"https://stscl.github.io/tEDM/reference/multispatialccm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"multispatial convergent cross mapping — multispatialccm","text":"list xmap cross mapping results varname names causal effect variables bidirectional whether examine bidirectional causality","code":""},{"path":"https://stscl.github.io/tEDM/reference/multispatialccm.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"multispatial convergent cross mapping — multispatialccm","text":"Clark, .T., Ye, H., Isbell, F., Deyle, E.R., Cowles, J., Tilman, G.D., Sugihara, G., 2015. Spatial convergent cross mapping detect causal relationships short time series. Ecology 96, 1174–1181.","code":""},{"path":"https://stscl.github.io/tEDM/reference/multispatialccm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"multispatial convergent cross mapping — multispatialccm","text":"","code":"set.seed(42) obs = runif(10,0,0.1) sim = vector(\"list\",5) for (i in seq_along(obs)){   sim[[i]] = logistic_map(x = obs[i],y = obs[i],step = 15,beta_xy = 0.5,beta_yx = 0) } lst = list(x = do.call(cbind, lapply(sim, function(df) df$x)),            y = do.call(cbind, lapply(sim, function(df) df$y))) multispatialccm(lst,\"x\",\"y\",libsizes = 1:5,E = 2,k = 3,threads = 1) #>  Computing: [========================================] 100% (done)                          #>  Computing: [========================================] 100% (done)                          #>   libsizes      x->y      y->x #> 1        1 0.3131501 0.3161107 #> 2        2 0.6804184 0.3629746 #> 3        3 0.7935703 0.4772453 #> 4        4 0.8390027 0.5316734 #> 5        5 0.8691234 0.5819187"},{"path":"https://stscl.github.io/tEDM/reference/pcm.html","id":null,"dir":"Reference","previous_headings":"","what":"partial cross mapping — pcm","title":"partial cross mapping — pcm","text":"partial cross mapping","code":""},{"path":"https://stscl.github.io/tEDM/reference/pcm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"partial cross mapping — pcm","text":"","code":"# S4 method for class 'data.frame' pcm(   data,   cause,   effect,   conds,   libsizes = NULL,   E = 3,   tau = 1,   k = E + 1,   theta = 1,   algorithm = \"simplex\",   lib = NULL,   pred = NULL,   dist.metric = \"L1\",   dist.average = TRUE,   threads = length(pred),   parallel.level = \"low\",   bidirectional = TRUE,   cumulate = FALSE,   progressbar = TRUE )"},{"path":"https://stscl.github.io/tEDM/reference/pcm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"partial cross mapping — pcm","text":"data observation data. cause name causal variable. effect name effect variable. conds name conditioning variables. libsizes (optional) number time points used. E (optional) embedding dimensions. tau (optional) step time lags. k (optional) number nearest neighbors. theta (optional) weighting parameter distances, useful algorithm smap. algorithm (optional) prediction algorithm. lib (optional) libraries indices. pred (optional) predictions indices. dist.metric (optional) distance metric (L1: Manhattan, L2: Euclidean). dist.average (optional) whether average distance. threads (optional) number threads use. parallel.level (optional) level parallelism, low high. bidirectional (optional) whether examine bidirectional causality. cumulate (optional) serial cumulative computation partial cross mapping. progressbar (optional) whether show progress bar.","code":""},{"path":"https://stscl.github.io/tEDM/reference/pcm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"partial cross mapping — pcm","text":"list pxmap partial cross mapping results xmap cross mapping results varname names causal, effect conditioning variables bidirectional whether examine bidirectional causality","code":""},{"path":"https://stscl.github.io/tEDM/reference/pcm.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"partial cross mapping — pcm","text":"Leng, S., Ma, H., Kurths, J. et al. Partial cross mapping eliminates indirect causal influences. Nat Commun 11, 2632 (2020).","code":""},{"path":"https://stscl.github.io/tEDM/reference/pcm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"partial cross mapping — pcm","text":"","code":"sim = logistic_map(x = 0.4,y = 0.4,z = 0.4,step = 45,                    beta_xy = 0.5, beta_xz = 0,                    beta_yx = 0, beta_yz = 0.5,                    beta_zx = 0, beta_zy = 0) pcm(sim,\"x\",\"z\",\"y\",libsizes = seq(5,45,5),E = 10,k = 7,threads = 1) #>  Computing: [========================================] 100% (done)                          #>  Computing: [========================================] 100% (done)                          #> --------------------------------------  #> ***partial cross mapping prediction***  #> --------------------------------------  #>   libsizes        x->z          z->x #> 1        5  0.35911303  1.260417e-01 #> 2       10  0.19561345 -4.068307e-05 #> 3       15  0.08032524  4.125853e-03 #> 4       20  0.01890635  5.573376e-02 #> 5       25 -0.01338321  1.036854e-01 #> 6       27  0.05144222  2.845048e-01 #>  #> ------------------------------  #> ***cross mapping prediction***  #> ------------------------------  #>   libsizes      x->z      z->x #> 1        5 0.7714550 0.5182871 #> 2       10 0.8545976 0.5570433 #> 3       15 0.8718242 0.5648568 #> 4       20 0.8733124 0.5715475 #> 5       25 0.8732259 0.5722011 #> 6       27 0.9304557 0.5953293"},{"path":"https://stscl.github.io/tEDM/reference/simplex.html","id":null,"dir":"Reference","previous_headings":"","what":"simplex forecast — simplex","title":"simplex forecast — simplex","text":"simplex forecast","code":""},{"path":"https://stscl.github.io/tEDM/reference/simplex.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"simplex forecast — simplex","text":"","code":"# S4 method for class 'data.frame' simplex(   data,   column,   target,   lib = NULL,   pred = NULL,   E = 2:10,   tau = 1,   k = E + 1,   dist.metric = \"L1\",   dist.average = TRUE,   threads = length(E) )  # S4 method for class 'list' simplex(   data,   column,   target,   lib = NULL,   pred = NULL,   E = 2:10,   tau = 1,   k = E + 1,   dist.metric = \"L1\",   dist.average = TRUE,   threads = length(E) )"},{"path":"https://stscl.github.io/tEDM/reference/simplex.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"simplex forecast — simplex","text":"data observation data. column name library variable. target name target variable. lib (optional) libraries indices. pred (optional) predictions indices. E (optional) embedding dimensions. tau (optional) step time lags. k (optional) number nearest neighbors used prediction. dist.metric (optional) distance metric (L1: Manhattan, L2: Euclidean). dist.average (optional) whether average distance. threads (optional) number threads use.","code":""},{"path":"https://stscl.github.io/tEDM/reference/simplex.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"simplex forecast — simplex","text":"list xmap forecast performance varname name target variable method method cross mapping","code":""},{"path":"https://stscl.github.io/tEDM/reference/simplex.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"simplex forecast — simplex","text":"Sugihara G. May R. 1990. Nonlinear forecasting way distinguishing chaos measurement error time series. Nature, 344:734-741.","code":""},{"path":"https://stscl.github.io/tEDM/reference/simplex.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"simplex forecast — simplex","text":"","code":"sim = logistic_map(x = 0.4,y = 0.4,step = 45,beta_xy = 0.5,beta_yx = 0) simplex(sim,\"x\",\"y\",E = 4:10,k = 7,threads = 1) #> The suggested E,k,tau for variable y is 10, 7 and 1"},{"path":"https://stscl.github.io/tEDM/reference/smap.html","id":null,"dir":"Reference","previous_headings":"","what":"smap forecast — smap","title":"smap forecast — smap","text":"smap forecast","code":""},{"path":"https://stscl.github.io/tEDM/reference/smap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"smap forecast — smap","text":"","code":"# S4 method for class 'data.frame' smap(   data,   column,   target,   lib = NULL,   pred = NULL,   E = 3,   tau = 1,   k = E + 1,   dist.metric = \"L1\",   dist.average = TRUE,   theta = c(0, 1e-04, 3e-04, 0.001, 0.003, 0.01, 0.03, 0.1, 0.3, 0.5, 0.75, 1, 1.5, 2, 3,     4, 6, 8),   threads = length(theta) )"},{"path":"https://stscl.github.io/tEDM/reference/smap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"smap forecast — smap","text":"data observation data. column name library variable. target name target variable. lib (optional) libraries indices. pred (optional) predictions indices. E (optional) embedding dimensions. tau (optional) step time lags. k (optional) number nearest neighbors used prediction. dist.metric (optional) distance metric (L1: Manhattan, L2: Euclidean). dist.average (optional) whether average distance. theta (optional) weighting parameter distances. threads (optional) number threads use.","code":""},{"path":"https://stscl.github.io/tEDM/reference/smap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"smap forecast — smap","text":"list xmap forecast performance varname name target variable method method cross mapping","code":""},{"path":"https://stscl.github.io/tEDM/reference/smap.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"smap forecast — smap","text":"Sugihara G. 1994. Nonlinear forecasting classification natural time series. Philosophical Transactions: Physical Sciences Engineering, 348 (1688):477-495.","code":""},{"path":"https://stscl.github.io/tEDM/reference/smap.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"smap forecast — smap","text":"","code":"sim = logistic_map(x = 0.4,y = 0.4,step = 45,beta_xy = 0.5,beta_yx = 0) smap(sim,\"x\",\"y\",E = 10,k = 7,threads = 1) #> The suggested theta for variable y is 8"},{"path":[]},{"path":"https://stscl.github.io/tEDM/news/index.html","id":"enhancements-1-2","dir":"Changelog","previous_headings":"","what":"enhancements","title":"tEDM 1.2","text":"Support specifying library units via lib parameter multispatialccm generic (#161). Permit simplex ic generics accept varying E, k, tau inputs (#148). Enforce strict floating-point comparisons across cpp sources (#143). Unify font specification S3 plotting method cross-mapping results (#135).","code":""},{"path":"https://stscl.github.io/tEDM/news/index.html","id":"breaking-changes-1-2","dir":"Changelog","previous_headings":"","what":"breaking changes","title":"tEDM 1.2","text":"Use consistent masking library prediction indices cross mapping parameter selection (#157). Correct library prediction indices handling cross mapping (#145).","code":""},{"path":"https://stscl.github.io/tEDM/news/index.html","id":"tedm-11","dir":"Changelog","previous_headings":"","what":"tEDM 1.1","title":"tEDM 1.1","text":"CRAN release: 2025-08-25","code":""},{"path":"https://stscl.github.io/tEDM/news/index.html","id":"new-1-1","dir":"Changelog","previous_headings":"","what":"new","title":"tEDM 1.1","text":"Introduce configurable distance metrics cross mapping (#120).","code":""},{"path":"https://stscl.github.io/tEDM/news/index.html","id":"enhancements-1-1","dir":"Changelog","previous_headings":"","what":"enhancements","title":"tEDM 1.1","text":"Safeguard transient removal logic logistic map prevent index errors (#96).","code":""},{"path":"https://stscl.github.io/tEDM/news/index.html","id":"breaking-changes-1-1","dir":"Changelog","previous_headings":"","what":"breaking changes","title":"tEDM 1.1","text":"Adjust time-delay embedding logic support flexible tau configurations (#111). Refine lib pred index filtering logic cross mapping (#102).","code":""},{"path":"https://stscl.github.io/tEDM/news/index.html","id":"tedm-10","dir":"Changelog","previous_headings":"","what":"tEDM 1.0","title":"tEDM 1.0","text":"CRAN release: 2025-07-15","code":""},{"path":"https://stscl.github.io/tEDM/news/index.html","id":"new-1-0","dir":"Changelog","previous_headings":"","what":"new","title":"tEDM 1.0","text":"First stable release (#93).","code":""}]
