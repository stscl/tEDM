<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Temporal Empirical Dynamic Modeling • tEDM</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Temporal Empirical Dynamic Modeling">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tEDM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><a class="dropdown-item" href="../articles/tEDM.html">Temporal Empirical Dynamic Modeling</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/stscl/tEDM/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Temporal Empirical Dynamic Modeling</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/stscl/tEDM/blob/main/vignettes/tEDM.Rmd" class="external-link"><code>vignettes/tEDM.Rmd</code></a></small>
      <div class="d-none name"><code>tEDM.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction-to-the-tedm-package">1. Introduction to the <code>tEDM</code> package<a class="anchor" aria-label="anchor" href="#introduction-to-the-tedm-package"></a>
</h2>
<p>The <code>tEDM</code> package provides a suite of tools for exploring
and quantifying causality in time series using Empirical Dynamic
Modeling (EDM). It implements four fundamental EDM-based causal
discovery methods:</p>
<ul>
<li><p><a href="https://doi.org/10.1126/science.1227079" class="external-link"><strong>Convergent Cross
Mapping (CCM)</strong></a></p></li>
<li><p><a href="https://doi.org/10.1038/s41467-020-16238-0" class="external-link"><strong>Partial Cross
Mapping (PCM)</strong></a></p></li>
<li><p><a href="https://doi.org/10.1016/j.fmre.2023.01.007" class="external-link"><strong>Cross Mapping
Cardinality (CMC)</strong></a></p></li>
<li><p><a href="https://doi.org/10.1890/14-1479.1" class="external-link"><strong>Multispatial
Convergent Cross Mapping (MultispatialCCM)</strong></a></p></li>
</ul>
<p>These methods enable researchers to:</p>
<ul>
<li><p><strong>Identify</strong> potential causal interactions without
assuming a predefined model structure.</p></li>
<li><p><strong>Distinguish</strong> between direct causation and
indirect (mediated or confounded) influences.</p></li>
<li><p><strong>Reconstruct</strong> underlying causal dynamics from
replicated univariate time series observed across multiple spatial
units.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="example-data-in-the-tedm-package">2. Example data in the <code>tEDM</code> package<a class="anchor" aria-label="anchor" href="#example-data-in-the-tedm-package"></a>
</h2>
<div class="section level3">
<h3 id="hong-kong-air-pollution-and-cardiovascular-admissions">Hong Kong Air Pollution and Cardiovascular Admissions<a class="anchor" aria-label="anchor" href="#hong-kong-air-pollution-and-cardiovascular-admissions"></a>
</h3>
<p>A daily time series dataset(from 1995-3 to 1997-11) for Hong Kong
that includes cardiovascular hospital admissions and major air pollutant
concentrations.</p>
<p><strong>File</strong>: <code>cvd.csv</code></p>
<p><strong>Columns</strong>:</p>
<table class="table">
<thead><tr class="header">
<th>Column</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>cvd</code></td>
<td>Daily number of cardiovascular-related hospital admissions.</td>
</tr>
<tr class="even">
<td><code>rsp</code></td>
<td>Respirable suspended particulates (μg/m³).</td>
</tr>
<tr class="odd">
<td><code>no2</code></td>
<td>Nitrogen dioxide concentration (μg/m³).</td>
</tr>
<tr class="even">
<td><code>so2</code></td>
<td>Sulfur dioxide concentration (μg/m³).</td>
</tr>
<tr class="odd">
<td><code>o3</code></td>
<td>Ozone concentration (μg/m³).</td>
</tr>
</tbody>
</table>
<p><strong>Source</strong>: Data adapted from <a href="https://doi.org/10.1038/s41467-020-16238-0" class="external-link">PCM article</a>.</p>
<hr>
</div>
<div class="section level3">
<h3 id="us-county-level-carbon-emissions-dataset">US County-Level Carbon Emissions Dataset<a class="anchor" aria-label="anchor" href="#us-county-level-carbon-emissions-dataset"></a>
</h3>
<p>A panel dataset covering U.S. county-level temperature and carbon
emissions across time.</p>
<p><strong>File</strong>: <code>carbon.csv.gz</code></p>
<p><strong>Columns</strong>:</p>
<table class="table">
<colgroup>
<col width="10%">
<col width="90%">
</colgroup>
<thead><tr class="header">
<th>Column</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>year</code></td>
<td>Observation year (1981–2017).</td>
</tr>
<tr class="even">
<td><code>fips</code></td>
<td>County FIPS code (5-digit Federal Information Processing Standard
code).</td>
</tr>
<tr class="odd">
<td><code>tem</code></td>
<td>Mean annual temperature (in Kelvin).</td>
</tr>
<tr class="even">
<td><code>carbon</code></td>
<td>Total carbon emissions per year (in kilograms of CO₂).</td>
</tr>
</tbody>
</table>
<p><strong>Source</strong>: Data adapted from <a href="https://doi.org/10.1016/j.cities.2025.105980" class="external-link">FsATE
article</a>.</p>
<hr>
</div>
<div class="section level3">
<h3 id="covid-19-infection-counts-in-japan">COVID-19 Infection Counts in Japan<a class="anchor" aria-label="anchor" href="#covid-19-infection-counts-in-japan"></a>
</h3>
<p>A spatio-temporal dataset capturing the number of confirmed COVID-19
infections across Japan’s 47 prefectures over time.</p>
<p><strong>File</strong>: <code>covid.csv</code></p>
<p><strong>Structure</strong>:</p>
<ul>
<li>Each <strong>column</strong> represents one of the 47 Japanese
prefectures (e.g., <code>Tokyo</code>, <code>Osaka</code>,
<code>Hokkaido</code>).</li>
<li>Each <strong>row</strong> corresponds to a time step (daily).</li>
</ul>
<p><strong>Source</strong>: Data adapted from <a href="https://doi.org/10.1016/j.fmre.2023.01.007" class="external-link">CMC article</a>.</p>
</div>
</div>
<div class="section level2">
<h2 id="case-studies-of-the-tedm-package">3. Case studies of the <code>tEDM</code> package<a class="anchor" aria-label="anchor" href="#case-studies-of-the-tedm-package"></a>
</h2>
<p>Install the stable version:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"tEDM"</span>, dep <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>or dev version:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"tEDM"</span>,</span>
<span>                 repos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"https://stscl.r-universe.dev"</span>,</span>
<span>                           <span class="st">"https://cloud.r-project.org"</span><span class="op">)</span>,</span>
<span>                 dep <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="air-pollution-and-cardiovascular-health-in-hong-kong">Air Pollution and Cardiovascular Health in Hong Kong<a class="anchor" aria-label="anchor" href="#air-pollution-and-cardiovascular-health-in-hong-kong"></a>
</h3>
<p>Employing CCM, CMC and PCM to investigate the causal relationships
between various air pollutants and cardiovascular diseases:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stscl.github.io/tEDM/">tEDM</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">cvd</span> <span class="op">=</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"case/cvd.csv"</span>,package <span class="op">=</span> <span class="st">"tEDM"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## Rows: 1032 Columns: 5</span></span>
<span><span class="co">## ── Column specification ─────────────────────────────────────────────────────────</span></span>
<span><span class="co">## Delimiter: ","</span></span>
<span><span class="co">## dbl (5): cvd, rsp, no2, so2, o3</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ℹ Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">cvd</span><span class="op">)</span></span>
<span><span class="co">## # A tibble: 6 × 5</span></span>
<span><span class="co">##     cvd   rsp   no2   so2    o3</span></span>
<span><span class="co">##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">## 1   214  73.7  74.5  19.1 17.4 </span></span>
<span><span class="co">## 2   203  77.6  80.9  18.8 39.4 </span></span>
<span><span class="co">## 3   202  64.8  67.1  13.8 56.4 </span></span>
<span><span class="co">## 4   182  68.8  74.7  30.8  5.6 </span></span>
<span><span class="co">## 5   181  49.4  62.3  23.1  3.6 </span></span>
<span><span class="co">## 6   129  67.4  63.6  17.4  6.73</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cvd_long</span> <span class="op">=</span> <span class="va">cvd</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">rowid_to_column</a></span><span class="op">(</span><span class="st">"id"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span><span class="va">id</span>,</span>
<span>                      names_to <span class="op">=</span> <span class="st">"variable"</span>, values_to <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fig1</span> <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">cvd_long</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">id</span>, y <span class="op">=</span> <span class="va">value</span>, color <span class="op">=</span> <span class="va">variable</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Days (from 1995-3 to 1997-11)"</span>, y <span class="op">=</span> <span class="st">"Concentrations or \nNO. of CVD admissions"</span>, color <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.direction <span class="op">=</span> <span class="st">"horizontal"</span>,</span>
<span>                 legend.position <span class="op">=</span> <span class="st">"inside"</span>,</span>
<span>                 legend.justification <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"center"</span>,<span class="st">"top"</span><span class="op">)</span>,</span>
<span>                 legend.background <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"transparent"</span>, color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fig1</span></span></code></pre></div>
<div class="float">
<img src="../reference/figures/edm/fig1-1.png" alt="Figure 1. Time series of air pollutants and confirmed CVD cases in Hong Kong from March 1995 to November 1997."><div class="figcaption">
<strong>Figure 1</strong>. Time series of air
pollutants and confirmed CVD cases in Hong Kong from March 1995 to
November 1997.</div>
</div>
<p>Determining optimal embedding dimension:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tEDM</span><span class="fu">::</span><span class="fu"><a href="../reference/fnn.html">fnn</a></span><span class="op">(</span><span class="va">cvd</span>,<span class="st">"cvd"</span>,E <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">50</span>,eps <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">cvd</span><span class="op">$</span><span class="va">cvd</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">##       E:1       E:2       E:3       E:4       E:5       E:6       E:7       E:8 </span></span>
<span><span class="co">## 0.8275862 0.4944072 0.3044807 0.2902240 0.2148676 0.2067210 0.1945010 0.1853360 </span></span>
<span><span class="co">##       E:9      E:10      E:11      E:12      E:13      E:14      E:15      E:16 </span></span>
<span><span class="co">## 0.1863544 0.1894094 0.1832994 0.1843177 0.1782077 0.1710794 0.1680244 0.1680244 </span></span>
<span><span class="co">##      E:17      E:18      E:19      E:20      E:21      E:22      E:23      E:24 </span></span>
<span><span class="co">## 0.1547862 0.1537678 0.1670061 0.1568228 0.1588595 0.1710794 0.1639511 0.1659878 </span></span>
<span><span class="co">##      E:25      E:26      E:27      E:28      E:29      E:30      E:31      E:32 </span></span>
<span><span class="co">## 0.1670061 0.1873727 0.1659878 0.1751527 0.1731161 0.1812627 0.1710794 0.1802444 </span></span>
<span><span class="co">##      E:33      E:34      E:35      E:36      E:37      E:38      E:39      E:40 </span></span>
<span><span class="co">## 0.1700611 0.1720978 0.1710794 0.1629328 0.1517312 0.1639511 0.1670061 0.1700611 </span></span>
<span><span class="co">##      E:41      E:42      E:43      E:44      E:45      E:46      E:47      E:48 </span></span>
<span><span class="co">## 0.1659878 0.1649695 0.1670061 0.1690428 0.1619145 0.1670061 0.1792261 0.1822811 </span></span>
<span><span class="co">##      E:49 </span></span>
<span><span class="co">## 0.1761711</span></span></code></pre></div>
<p>Starting at <span class="math inline">\(E = 11\)</span>, the FNN
ratio stabilizes near 0.18; thus, embedding dimension E and neighbor
number k are chosen from 11 onward for subsequent self-prediction
parameter selection.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tEDM</span><span class="fu">::</span><span class="fu"><a href="../reference/simplex.html">simplex</a></span><span class="op">(</span><span class="va">cvd</span>,<span class="st">"cvd"</span>,<span class="st">"cvd"</span>,E <span class="op">=</span> <span class="fl">11</span><span class="op">:</span><span class="fl">35</span>,k <span class="op">=</span> <span class="fl">12</span><span class="op">:</span><span class="fl">36</span><span class="op">)</span></span>
<span><span class="co">## The suggested E and k for variable cvd is 11 and 12</span></span>
<span><span class="fu">tEDM</span><span class="fu">::</span><span class="fu"><a href="../reference/simplex.html">simplex</a></span><span class="op">(</span><span class="va">cvd</span>,<span class="st">"rsp"</span>,<span class="st">"rsp"</span>,E <span class="op">=</span> <span class="fl">11</span><span class="op">:</span><span class="fl">35</span>,k <span class="op">=</span> <span class="fl">12</span><span class="op">:</span><span class="fl">36</span><span class="op">)</span></span>
<span><span class="co">## The suggested E and k for variable rsp is 11 and 13</span></span>
<span><span class="fu">tEDM</span><span class="fu">::</span><span class="fu"><a href="../reference/simplex.html">simplex</a></span><span class="op">(</span><span class="va">cvd</span>,<span class="st">"no2"</span>,<span class="st">"no2"</span>,E <span class="op">=</span> <span class="fl">11</span><span class="op">:</span><span class="fl">35</span>,k <span class="op">=</span> <span class="fl">12</span><span class="op">:</span><span class="fl">36</span><span class="op">)</span></span>
<span><span class="co">## The suggested E and k for variable no2 is 11 and 12</span></span>
<span><span class="fu">tEDM</span><span class="fu">::</span><span class="fu"><a href="../reference/simplex.html">simplex</a></span><span class="op">(</span><span class="va">cvd</span>,<span class="st">"so2"</span>,<span class="st">"so2"</span>,E <span class="op">=</span> <span class="fl">11</span><span class="op">:</span><span class="fl">35</span>,k <span class="op">=</span> <span class="fl">12</span><span class="op">:</span><span class="fl">36</span><span class="op">)</span></span>
<span><span class="co">## The suggested E and k for variable so2 is 11 and 18</span></span>
<span><span class="fu">tEDM</span><span class="fu">::</span><span class="fu"><a href="../reference/simplex.html">simplex</a></span><span class="op">(</span><span class="va">cvd</span>,<span class="st">"o3"</span>,<span class="st">"o3"</span>,E <span class="op">=</span> <span class="fl">11</span><span class="op">:</span><span class="fl">35</span>,k <span class="op">=</span> <span class="fl">12</span><span class="op">:</span><span class="fl">36</span><span class="op">)</span></span>
<span><span class="co">## The suggested E and k for variable o3 is 11 and 12</span></span></code></pre></div>
<p>We first use CCM to explore the causal influences of air pollutants
on the incidence of cardiovascular diseases.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rsp_cvd</span> <span class="op">=</span> <span class="fu">tEDM</span><span class="fu">::</span><span class="fu"><a href="../reference/ccm.html">ccm</a></span><span class="op">(</span><span class="va">cvd</span>,<span class="st">"rsp"</span>,<span class="st">"cvd"</span>,libsizes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">32</span>,<span class="fl">1032</span>,<span class="fl">100</span><span class="op">)</span>,E <span class="op">=</span> <span class="fl">11</span>,k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">13</span>,<span class="fl">12</span><span class="op">)</span>,progressbar <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">rsp_cvd</span></span>
<span><span class="co">##    libsizes   rsp-&gt;cvd   cvd-&gt;rsp</span></span>
<span><span class="co">## 1        32 0.03212919 0.01228767</span></span>
<span><span class="co">## 2       132 0.05654363 0.02018887</span></span>
<span><span class="co">## 3       232 0.06463454 0.03607634</span></span>
<span><span class="co">## 4       332 0.06064099 0.04698896</span></span>
<span><span class="co">## 5       432 0.06180930 0.04813387</span></span>
<span><span class="co">## 6       532 0.06262916 0.04713303</span></span>
<span><span class="co">## 7       632 0.05983990 0.04859066</span></span>
<span><span class="co">## 8       732 0.05386418 0.05365310</span></span>
<span><span class="co">## 9       832 0.04783700 0.05779265</span></span>
<span><span class="co">## 10      932 0.04788904 0.06048993</span></span>
<span><span class="co">## 11     1021 0.11465191 0.10133554</span></span>
<span><span class="va">no2_cvd</span> <span class="op">=</span> <span class="fu">tEDM</span><span class="fu">::</span><span class="fu"><a href="../reference/ccm.html">ccm</a></span><span class="op">(</span><span class="va">cvd</span>,<span class="st">"no2"</span>,<span class="st">"cvd"</span>,libsizes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">32</span>,<span class="fl">1032</span>,<span class="fl">100</span><span class="op">)</span>,E <span class="op">=</span> <span class="fl">11</span>,k <span class="op">=</span> <span class="fl">12</span>,progressbar <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">no2_cvd</span></span>
<span><span class="co">##    libsizes  no2-&gt;cvd   cvd-&gt;no2</span></span>
<span><span class="co">## 1        32 0.0725866 0.04646570</span></span>
<span><span class="co">## 2       132 0.1223500 0.07452473</span></span>
<span><span class="co">## 3       232 0.1440400 0.10979245</span></span>
<span><span class="co">## 4       332 0.1463108 0.12676364</span></span>
<span><span class="co">## 5       432 0.1493368 0.13259880</span></span>
<span><span class="co">## 6       532 0.1505781 0.13601417</span></span>
<span><span class="co">## 7       632 0.1463268 0.13721917</span></span>
<span><span class="co">## 8       732 0.1392535 0.13837513</span></span>
<span><span class="co">## 9       832 0.1352347 0.13943520</span></span>
<span><span class="co">## 10      932 0.1359023 0.14033241</span></span>
<span><span class="co">## 11     1021 0.2701247 0.18804876</span></span>
<span><span class="va">so2_cvd</span> <span class="op">=</span> <span class="fu">tEDM</span><span class="fu">::</span><span class="fu"><a href="../reference/ccm.html">ccm</a></span><span class="op">(</span><span class="va">cvd</span>,<span class="st">"so2"</span>,<span class="st">"cvd"</span>,libsizes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">32</span>,<span class="fl">1032</span>,<span class="fl">100</span><span class="op">)</span>,E <span class="op">=</span> <span class="fl">11</span>,k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">18</span>,<span class="fl">12</span><span class="op">)</span>,progressbar <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">so2_cvd</span></span>
<span><span class="co">##    libsizes   so2-&gt;cvd   cvd-&gt;so2</span></span>
<span><span class="co">## 1        32 0.05100118 0.03461720</span></span>
<span><span class="co">## 2       132 0.07979493 0.07406730</span></span>
<span><span class="co">## 3       232 0.07390120 0.08535797</span></span>
<span><span class="co">## 4       332 0.06454759 0.09205499</span></span>
<span><span class="co">## 5       432 0.06421670 0.09589412</span></span>
<span><span class="co">## 6       532 0.06667487 0.09915476</span></span>
<span><span class="co">## 7       632 0.06752325 0.10104920</span></span>
<span><span class="co">## 8       732 0.06628738 0.10265838</span></span>
<span><span class="co">## 9       832 0.06534601 0.10523615</span></span>
<span><span class="co">## 10      932 0.06505378 0.10782963</span></span>
<span><span class="co">## 11     1021 0.12820854 0.11510196</span></span>
<span><span class="va">o3_cvd</span> <span class="op">=</span> <span class="fu">tEDM</span><span class="fu">::</span><span class="fu"><a href="../reference/ccm.html">ccm</a></span><span class="op">(</span><span class="va">cvd</span>,<span class="st">"o3"</span>,<span class="st">"cvd"</span>,libsizes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">32</span>,<span class="fl">1032</span>,<span class="fl">100</span><span class="op">)</span>,E <span class="op">=</span> <span class="fl">11</span>,k <span class="op">=</span> <span class="fl">12</span>,progressbar <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">o3_cvd</span></span>
<span><span class="co">##    libsizes      o3-&gt;cvd    cvd-&gt;o3</span></span>
<span><span class="co">## 1        32  0.002955184 0.02271010</span></span>
<span><span class="co">## 2       132 -0.002839356 0.05643341</span></span>
<span><span class="co">## 3       232 -0.009653301 0.07583492</span></span>
<span><span class="co">## 4       332 -0.018512914 0.08387571</span></span>
<span><span class="co">## 5       432 -0.019942039 0.08175905</span></span>
<span><span class="co">## 6       532 -0.015815466 0.07819425</span></span>
<span><span class="co">## 7       632 -0.014698935 0.07679967</span></span>
<span><span class="co">## 8       732 -0.019196844 0.07226140</span></span>
<span><span class="co">## 9       832 -0.023726153 0.06974574</span></span>
<span><span class="co">## 10      932 -0.024137957 0.06943232</span></span>
<span><span class="co">## 11     1021  0.013982373 0.09503517</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">figa</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">rsp_cvd</span>,ylimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.12</span><span class="op">)</span>,ybreaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.05</span>,<span class="fl">0.10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">figb</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">no2_cvd</span>,ylimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.03</span>,<span class="fl">0.30</span><span class="op">)</span>,ybreaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.05</span>,<span class="fl">0.25</span>,<span class="fl">0.05</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">figc</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">so2_cvd</span>,ylimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.03</span>,<span class="fl">0.15</span><span class="op">)</span>,ybreaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.15</span>,<span class="fl">0.05</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">figd</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">o3_cvd</span>,ylimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.05</span>,<span class="fl">0.1</span><span class="op">)</span>,ybreaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.05</span>,<span class="fl">0.05</span>,<span class="fl">0.05</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fig2</span> <span class="op">=</span> <span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">figa</span>, <span class="va">figb</span>, <span class="va">figc</span>, <span class="va">figd</span>, ncol <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                         label_fontfamily <span class="op">=</span> <span class="st">'serif'</span>,</span>
<span>                         labels <span class="op">=</span> <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">fig2</span></span></code></pre></div>
<div class="float">
<img src="../reference/figures/edm/fig2-1.png" alt="Figure 2. Cross-mapping results between different air pollutants and cardiovascular diseases."><div class="figcaption">
<strong>Figure 2</strong>. Cross-mapping results
between different air pollutants and cardiovascular diseases.</div>
</div>
<p>The results shown in Figure2 indicate the presence of the following
causal influences:</p>
<ul>
<li>rsp → cvd</li>
<li>no₂ → cvd</li>
<li>so₂ → cvd</li>
<li>cvd → rsp</li>
<li>cvd → so₂</li>
<li>cvd → no₂</li>
<li>cvd → o₃</li>
</ul>
<p>However, based on practical experience, the relationship between CVDs
and air pollution is likely reflective rather than causal. Therefore, we
further employ CCM to examine the causal paths of cvd → no₂ and cvd →
o₃.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g1</span> <span class="op">=</span> <span class="fu">tEDM</span><span class="fu">::</span><span class="fu"><a href="../reference/cmc.html">cmc</a></span><span class="op">(</span><span class="va">cvd</span>,<span class="st">"rsp"</span>,<span class="st">"cvd"</span>,E <span class="op">=</span> <span class="fl">11</span>,k <span class="op">=</span> <span class="fl">50</span>,progressbar <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">g1</span></span>
<span><span class="co">##   neighbors rsp-&gt;cvd cvd-&gt;rsp</span></span>
<span><span class="co">## 1        50    0.364   0.4696</span></span>
<span><span class="va">g1</span><span class="op">$</span><span class="va">xmap</span></span>
<span><span class="co">##   neighbors x_xmap_y_mean x_xmap_y_sig x_xmap_y_upper x_xmap_y_lower</span></span>
<span><span class="co">## 1        50        0.4696     0.645344      0.5990605      0.3401395</span></span>
<span><span class="co">##   y_xmap_x_mean y_xmap_x_sig y_xmap_x_upper y_xmap_x_lower</span></span>
<span><span class="co">## 1         0.364   0.03509439      0.4904932      0.2375068</span></span>
<span></span>
<span><span class="va">g2</span> <span class="op">=</span> <span class="fu">tEDM</span><span class="fu">::</span><span class="fu"><a href="../reference/cmc.html">cmc</a></span><span class="op">(</span><span class="va">cvd</span>,<span class="st">"so2"</span>,<span class="st">"cvd"</span>,E <span class="op">=</span> <span class="fl">11</span>,k <span class="op">=</span> <span class="fl">50</span>,progressbar <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">g2</span></span>
<span><span class="co">##   neighbors so2-&gt;cvd cvd-&gt;so2</span></span>
<span><span class="co">## 1        50    0.046     0.46</span></span>
<span><span class="va">g2</span><span class="op">$</span><span class="va">xmap</span></span>
<span><span class="co">##   neighbors x_xmap_y_mean x_xmap_y_sig x_xmap_y_upper x_xmap_y_lower</span></span>
<span><span class="co">## 1        50          0.46    0.5434416      0.5890263      0.3309737</span></span>
<span><span class="co">##   y_xmap_x_mean y_xmap_x_sig y_xmap_x_upper y_xmap_x_lower</span></span>
<span><span class="co">## 1         0.046 3.508029e-77      0.0938521              0</span></span>
<span></span>
<span><span class="va">g3</span> <span class="op">=</span> <span class="fu">tEDM</span><span class="fu">::</span><span class="fu"><a href="../reference/cmc.html">cmc</a></span><span class="op">(</span><span class="va">cvd</span>,<span class="st">"no2"</span>,<span class="st">"cvd"</span>,E <span class="op">=</span> <span class="fl">11</span>,k <span class="op">=</span> <span class="fl">50</span>,progressbar <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">g3</span></span>
<span><span class="co">##   neighbors no2-&gt;cvd cvd-&gt;no2</span></span>
<span><span class="co">## 1        50   0.2728    0.446</span></span>
<span><span class="va">g3</span><span class="op">$</span><span class="va">xmap</span></span>
<span><span class="co">##   neighbors x_xmap_y_mean x_xmap_y_sig x_xmap_y_upper x_xmap_y_lower</span></span>
<span><span class="co">## 1        50         0.446    0.4123805      0.5751162      0.3168838</span></span>
<span><span class="co">##   y_xmap_x_mean y_xmap_x_sig y_xmap_x_upper y_xmap_x_lower</span></span>
<span><span class="co">## 1        0.2728 0.0001114126      0.3880356      0.1575644</span></span>
<span></span>
<span><span class="va">g4</span> <span class="op">=</span> <span class="fu">tEDM</span><span class="fu">::</span><span class="fu"><a href="../reference/cmc.html">cmc</a></span><span class="op">(</span><span class="va">cvd</span>,<span class="st">"o3"</span>,<span class="st">"cvd"</span>,E <span class="op">=</span> <span class="fl">11</span>,k <span class="op">=</span> <span class="fl">50</span>,progressbar <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">g4</span></span>
<span><span class="co">##   neighbors o3-&gt;cvd cvd-&gt;o3</span></span>
<span><span class="co">## 1        50  0.0536  0.4628</span></span>
<span><span class="va">g4</span><span class="op">$</span><span class="va">xmap</span></span>
<span><span class="co">##   neighbors x_xmap_y_mean x_xmap_y_sig x_xmap_y_upper x_xmap_y_lower</span></span>
<span><span class="co">## 1        50        0.4628    0.5733574      0.5922777      0.3333223</span></span>
<span><span class="co">##   y_xmap_x_mean y_xmap_x_sig y_xmap_x_upper y_xmap_x_lower</span></span>
<span><span class="co">## 1        0.0536 8.756939e-60      0.1072525              0</span></span></code></pre></div>
<p>The causal paths from CVDs to air pollutants are not statistically
significant in the CMC analysis results, allowing us to rule out these
four directions. Meanwhile, the causal strength from SO₂ to CVDs is too
weak (approximately 0.05), excluding the existence of a causal path from
SO₂ to CVDs. Therefore, we conclude that only RSP and NO₂ exhibit causal
influences on CVDs, with no evidence of feedback causality.</p>
<p>We further aim to explore the potential causal interactions among
different air pollutants. However, due to space constraints in this
vignette, we limit our analysis to a single test case — specifically,
examining whether <strong>NO₂</strong> exerts a causal influence on
<strong>Respirable Suspended Particulates (rsp)</strong>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">no2_rsp</span> <span class="op">=</span> <span class="fu">tEDM</span><span class="fu">::</span><span class="fu"><a href="../reference/pcm.html">pcm</a></span><span class="op">(</span><span class="va">cvd</span>,<span class="st">"no2"</span>,<span class="st">"rsp"</span>,<span class="st">"cvd"</span>,libsizes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">32</span>,<span class="fl">1032</span>,<span class="fl">100</span><span class="op">)</span>,E <span class="op">=</span> <span class="fl">11</span>,k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>,<span class="fl">13</span>,<span class="fl">12</span><span class="op">)</span>,progressbar <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">no2_rsp</span></span>
<span><span class="co">## -------------------------------------- </span></span>
<span><span class="co">## ***partial cross mapping prediction*** </span></span>
<span><span class="co">## -------------------------------------- </span></span>
<span><span class="co">##    libsizes  no2-&gt;rsp  rsp-&gt;no2</span></span>
<span><span class="co">## 1        32 0.5003795 0.5287113</span></span>
<span><span class="co">## 2       132 0.6586740 0.6540733</span></span>
<span><span class="co">## 3       232 0.6739825 0.6725413</span></span>
<span><span class="co">## 4       332 0.6869853 0.6898026</span></span>
<span><span class="co">## 5       432 0.6936791 0.7003889</span></span>
<span><span class="co">## 6       532 0.6972028 0.7064767</span></span>
<span><span class="co">## 7       632 0.7021889 0.7115672</span></span>
<span><span class="co">## 8       732 0.7038956 0.7154391</span></span>
<span><span class="co">## 9       832 0.7051222 0.7172094</span></span>
<span><span class="co">## 10      932 0.7053735 0.7181287</span></span>
<span><span class="co">## 11     1021 0.7355427 0.7249313</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ------------------------------ </span></span>
<span><span class="co">## ***cross mapping prediction*** </span></span>
<span><span class="co">## ------------------------------ </span></span>
<span><span class="co">##    libsizes  no2-&gt;rsp  rsp-&gt;no2</span></span>
<span><span class="co">## 1        32 0.4973450 0.5286056</span></span>
<span><span class="co">## 2       132 0.6727828 0.6705453</span></span>
<span><span class="co">## 3       232 0.6958408 0.6953063</span></span>
<span><span class="co">## 4       332 0.7076968 0.7127944</span></span>
<span><span class="co">## 5       432 0.7114252 0.7198838</span></span>
<span><span class="co">## 6       532 0.7128014 0.7238218</span></span>
<span><span class="co">## 7       632 0.7132465 0.7269140</span></span>
<span><span class="co">## 8       732 0.7139286 0.7281575</span></span>
<span><span class="co">## 9       832 0.7148172 0.7286784</span></span>
<span><span class="co">## 10      932 0.7156600 0.7287909</span></span>
<span><span class="co">## 11     1021 0.7438401 0.7541179</span></span>
<span></span>
<span><span class="va">figa</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">no2_rsp</span>,partial <span class="op">=</span> <span class="cn">FALSE</span>,ylimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.45</span>,<span class="fl">0.8</span><span class="op">)</span>,ybreaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.45</span>,<span class="fl">0.8</span>,<span class="fl">0.05</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">figb</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">no2_rsp</span>,ylimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.45</span>,<span class="fl">0.8</span><span class="op">)</span>,ybreaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.45</span>,<span class="fl">0.8</span>,<span class="fl">0.05</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fig3</span> <span class="op">=</span> <span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">figa</span>, <span class="va">figb</span>, ncol <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                          label_fontfamily <span class="op">=</span> <span class="st">'serif'</span>,</span>
<span>                          labels <span class="op">=</span> <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">fig3</span></span></code></pre></div>
<div class="float">
<img src="../reference/figures/edm/fig3-1.png" alt="Figure 3. Cross-mapping results between no₂ and respirable suspended particulates. a. CCM results without accounting for other variables. b. PCM results controlling for the influence of CVDs."><div class="figcaption">
<strong>Figure 3</strong>. Cross-mapping results
between no₂ and respirable suspended particulates. <strong>a</strong>.
CCM results without accounting for other variables. <strong>b</strong>.
PCM results controlling for the influence of CVDs.</div>
</div>
<p>The CCM and PCM results between <strong>NO₂</strong> and
<strong>respirable suspended particulates</strong> show minimal
differences and are both statistically significant, indicating the
presence of a causal relationship between the two. Therefore, the final
set of confirmed causal pathways is as follows (exclude those with no
causal influence on CVDs):</p>
<div class="float">
<img src="../reference/figures/edm/hk-cvd.png" alt="Figure 4. Causal interactions between air pollutants and cardiovascular diseases in Hong Kong."><div class="figcaption">
<strong>Figure 4</strong>. Causal interactions
between air pollutants and cardiovascular diseases in Hong Kong.</div>
</div>
</div>
<div class="section level3">
<h3 id="us-county-carbon-emissions-and-temperature-dynamics">US County Carbon Emissions and Temperature Dynamics<a class="anchor" aria-label="anchor" href="#us-county-carbon-emissions-and-temperature-dynamics"></a>
</h3>
<p>To examine whether a causal relationship exists between annual mean
temperature and total annual CO₂ emissions, we implement the CMC method
across counties.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stscl.github.io/tEDM/">tEDM</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">carbon</span> <span class="op">=</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"case/carbon.csv.gz"</span>,package <span class="op">=</span> <span class="st">"tEDM"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## Rows: 113627 Columns: 4</span></span>
<span><span class="co">## ── Column specification ─────────────────────────────────────────────────────────</span></span>
<span><span class="co">## Delimiter: ","</span></span>
<span><span class="co">## dbl (4): year, fips, tem, carbon</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ℹ Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">carbon</span><span class="op">)</span></span>
<span><span class="co">## # A tibble: 6 × 4</span></span>
<span><span class="co">##    year  fips   tem     carbon</span></span>
<span><span class="co">##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span><span class="co">## 1  1981  1001  17.4 192607687.</span></span>
<span><span class="co">## 2  1982  1001  18.4 187149414.</span></span>
<span><span class="co">## 3  1983  1001  16.9 191584445.</span></span>
<span><span class="co">## 4  1984  1001  17.8 199157579.</span></span>
<span><span class="co">## 5  1985  1001  17.9 205207564.</span></span>
<span><span class="co">## 6  1986  1001  18.5 218446030.</span></span>
<span></span>
<span><span class="va">carbon_list</span> <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_split.html" class="external-link">group_split</a></span><span class="op">(</span><span class="va">carbon</span>, by <span class="op">=</span> <span class="va">fips</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">carbon_list</span><span class="op">)</span></span>
<span><span class="co">## [1] 3071</span></span></code></pre></div>
<p>Using the 100th county as an example, we determine the appropriate
embedding dimension by applying the FNN method.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tEDM</span><span class="fu">::</span><span class="fu"><a href="../reference/fnn.html">fnn</a></span><span class="op">(</span><span class="va">carbon_list</span><span class="op">[[</span><span class="fl">100</span><span class="op">]</span><span class="op">]</span>,<span class="st">"carbon"</span>,E <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">10</span>,eps <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">carbon_list</span><span class="op">[[</span><span class="fl">100</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">carbon</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">##        E:1        E:2        E:3        E:4        E:5        E:6        E:7 </span></span>
<span><span class="co">## 0.37037037 0.03703704 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 </span></span>
<span><span class="co">##        E:8        E:9 </span></span>
<span><span class="co">## 0.00000000 0.00000000</span></span></code></pre></div>
<p>When E equals 3, the FNN ratio begins to drop to zero; therefore, we
select <span class="math inline">\(E = 3\)</span> as the embedding
dimension for the CMC analysis.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">=</span> <span class="va">carbon_list</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_dfr</a></span><span class="op">(</span>\<span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">g</span> <span class="op">=</span> <span class="fu">tEDM</span><span class="fu">::</span><span class="fu"><a href="../reference/cmc.html">cmc</a></span><span class="op">(</span><span class="va">.x</span>,<span class="st">"tem"</span>,<span class="st">"carbon"</span>,E <span class="op">=</span> <span class="fl">3</span>,k <span class="op">=</span> <span class="fl">20</span>,progressbar <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">g</span><span class="op">$</span><span class="va">xmap</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span><span class="co">##   neighbors x_xmap_y_mean x_xmap_y_sig x_xmap_y_upper x_xmap_y_lower</span></span>
<span><span class="co">## 1        20       0.25125 2.124762e-03      0.4099436     0.09255637</span></span>
<span><span class="co">## 2        20       0.20375 5.512985e-05      0.3477313     0.05976872</span></span>
<span><span class="co">## 3        20       0.19875 3.159932e-05      0.3406271     0.05687288</span></span>
<span><span class="co">## 4        20       0.19875 4.990860e-05      0.3443198     0.05318018</span></span>
<span><span class="co">## 5        20       0.23875 1.142665e-03      0.3961644     0.08133556</span></span>
<span><span class="co">## 6        20       0.17375 1.734913e-06      0.3074655     0.04003447</span></span>
<span><span class="co">##   y_xmap_x_mean y_xmap_x_sig y_xmap_x_upper y_xmap_x_lower</span></span>
<span><span class="co">## 1       0.05125 2.626718e-31      0.1268212              0</span></span>
<span><span class="co">## 2       0.05875 8.667168e-29      0.1364321              0</span></span>
<span><span class="co">## 3       0.06125 8.776684e-26      0.1431602              0</span></span>
<span><span class="co">## 4       0.06000 3.141877e-27      0.1397885              0</span></span>
<span><span class="co">## 5       0.06250 1.945554e-26      0.1430922              0</span></span>
<span><span class="co">## 6       0.05375 5.280357e-31      0.1292878              0</span></span>
<span></span>
<span><span class="va">res_carbon</span> <span class="op">=</span> <span class="va">res</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">neighbors</span>,</span>
<span>                carbon_tem <span class="op">=</span> <span class="va">x_xmap_y_mean</span>,</span>
<span>                tem_carbon <span class="op">=</span> <span class="va">y_xmap_x_mean</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">carbon_tem</span>, <span class="va">tem_carbon</span><span class="op">)</span>,</span>
<span>                      names_to <span class="op">=</span> <span class="st">"variable"</span>, values_to <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res_carbon</span><span class="op">)</span></span>
<span><span class="co">## # A tibble: 6 × 3</span></span>
<span><span class="co">##   neighbors variable    value</span></span>
<span><span class="co">##       &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;</span></span>
<span><span class="co">## 1        20 carbon_tem 0.251 </span></span>
<span><span class="co">## 2        20 tem_carbon 0.0512</span></span>
<span><span class="co">## 3        20 carbon_tem 0.204 </span></span>
<span><span class="co">## 4        20 tem_carbon 0.0588</span></span>
<span><span class="co">## 5        20 carbon_tem 0.199 </span></span>
<span><span class="co">## 6        20 tem_carbon 0.0612</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fig_case2</span> <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">res_carbon</span>,</span>
<span>                            <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">variable</span>, y <span class="op">=</span> <span class="va">value</span>, fill <span class="op">=</span> <span class="va">variable</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">"Causal Strength"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"carbon_tem"</span> <span class="op">=</span> <span class="st">"carbon → tem"</span>,</span>
<span>                                       <span class="st">"tem_carbon"</span> <span class="op">=</span> <span class="st">"tem → carbon"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span><span class="va">fig_case2</span></span></code></pre></div>
<div class="float">
<img src="../reference/figures/edm/fig_case2-1.png" alt="Figure 5. Causal strength scores between annual mean temperature and total annual CO₂ emissions across US counties, with embedding dimension E set to 6 and number of neighbors set to 20."><div class="figcaption">
<strong>Figure 5</strong>. Causal strength
scores between annual mean temperature and total annual CO₂ emissions
across US counties, with embedding dimension E set to 6 and number of
neighbors set to 20.</div>
</div>
</div>
<div class="section level3">
<h3 id="covid-19-spread-across-japanese-prefectures">COVID-19 Spread Across Japanese Prefectures<a class="anchor" aria-label="anchor" href="#covid-19-spread-across-japanese-prefectures"></a>
</h3>
<p>We examine the COVID-19 transmission between Tokyo and other
prefectures by applying CCM to identify the underlying causal dynamics
of the epidemic spread</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stscl.github.io/tEDM/">tEDM</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">covid</span> <span class="op">=</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"case/covid.csv"</span>,package <span class="op">=</span> <span class="st">"tEDM"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## Rows: 334 Columns: 47</span></span>
<span><span class="co">## ── Column specification ─────────────────────────────────────────────────────────</span></span>
<span><span class="co">## Delimiter: ","</span></span>
<span><span class="co">## dbl (47): Hokkaido, Aomori, Iwate, Miyagi, Akita, Yamagata, Fukushima, Ibarak...</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ℹ Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">covid</span><span class="op">)</span></span>
<span><span class="co">## # A tibble: 6 × 47</span></span>
<span><span class="co">##   Hokkaido Aomori Iwate Miyagi Akita Yamagata Fukushima Ibaraki Tochigi Gunma</span></span>
<span><span class="co">##      &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">## 1        0      0     0      0     0        0         0       0       0     0</span></span>
<span><span class="co">## 2        0      0     0      0     0        0         0       0       0     0</span></span>
<span><span class="co">## 3        0      0     0      0     0        0         0       0       0     0</span></span>
<span><span class="co">## 4        0      0     0      0     0        0         0       0       0     0</span></span>
<span><span class="co">## 5        0      0     0      0     0        0         0       0       0     0</span></span>
<span><span class="co">## 6        0      0     0      0     0        0         0       0       0     0</span></span>
<span><span class="co">## # ℹ 37 more variables: Saitama &lt;dbl&gt;, Chiba &lt;dbl&gt;, Tokyo &lt;dbl&gt;, Kanagawa &lt;dbl&gt;,</span></span>
<span><span class="co">## #   Niigata &lt;dbl&gt;, Toyama &lt;dbl&gt;, Ishikawa &lt;dbl&gt;, Fukui &lt;dbl&gt;, Yamanashi &lt;dbl&gt;,</span></span>
<span><span class="co">## #   Nagano &lt;dbl&gt;, Gifu &lt;dbl&gt;, Shizuoka &lt;dbl&gt;, Aichi &lt;dbl&gt;, Mie &lt;dbl&gt;,</span></span>
<span><span class="co">## #   Shiga &lt;dbl&gt;, Kyoto &lt;dbl&gt;, Osaka &lt;dbl&gt;, Hyogo &lt;dbl&gt;, Nara &lt;dbl&gt;,</span></span>
<span><span class="co">## #   Wakayama &lt;dbl&gt;, Tottori &lt;dbl&gt;, Shimane &lt;dbl&gt;, Okayama &lt;dbl&gt;,</span></span>
<span><span class="co">## #   Hiroshima &lt;dbl&gt;, Yamaguchi &lt;dbl&gt;, Tokushima &lt;dbl&gt;, Kagawa &lt;dbl&gt;,</span></span>
<span><span class="co">## #   Ehime &lt;dbl&gt;, Kochi &lt;dbl&gt;, Fukuoka &lt;dbl&gt;, Saga &lt;dbl&gt;, Nagasaki &lt;dbl&gt;, …</span></span></code></pre></div>
<p>The data are first differenced:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">covid</span> <span class="op">=</span> <span class="va">covid</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                              \<span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Using Tokyo’s COVID-19 infection data to test the optimal embedding
dimension.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tEDM</span><span class="fu">::</span><span class="fu"><a href="../reference/fnn.html">fnn</a></span><span class="op">(</span><span class="va">covid</span>,<span class="st">"Tokyo"</span>,E <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">30</span>,eps <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">covid</span><span class="op">$</span><span class="va">Tokyo</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">##        E:1        E:2        E:3        E:4        E:5        E:6        E:7 </span></span>
<span><span class="co">## 0.79452055 0.16901408 0.01351351 0.00000000 0.00000000 0.00000000 0.00000000 </span></span>
<span><span class="co">##        E:8        E:9       E:10       E:11       E:12       E:13       E:14 </span></span>
<span><span class="co">## 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 </span></span>
<span><span class="co">##       E:15       E:16       E:17       E:18       E:19       E:20       E:21 </span></span>
<span><span class="co">## 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 </span></span>
<span><span class="co">##       E:22       E:23       E:24       E:25       E:26       E:27       E:28 </span></span>
<span><span class="co">## 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 </span></span>
<span><span class="co">##       E:29 </span></span>
<span><span class="co">## 0.00000000</span></span></code></pre></div>
<p>Since the FNN ratio begins to approach zero when E equals 4,
embedding dimensions from 4 onward are evaluated, and the pair of E and
k yielding the highest self-prediction accuracy is selected for the CCM
procedure.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tEDM</span><span class="fu">::</span><span class="fu"><a href="../reference/simplex.html">simplex</a></span><span class="op">(</span><span class="va">covid</span>,<span class="st">"Tokyo"</span>,<span class="st">"Tokyo"</span>,E <span class="op">=</span> <span class="fl">4</span><span class="op">:</span><span class="fl">50</span>,k <span class="op">=</span> <span class="fl">5</span><span class="op">:</span><span class="fl">60</span><span class="op">)</span></span>
<span><span class="co">## The suggested E and k for variable Tokyo is 4 and 5</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">covid</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="st">"Tokyo"</span>,<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">covid</span><span class="op">)</span><span class="op">)</span><span class="op">]</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_dfr</a></span><span class="op">(</span>\<span class="op">(</span><span class="va">.l</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">g</span> <span class="op">=</span> <span class="fu">tEDM</span><span class="fu">::</span><span class="fu"><a href="../reference/ccm.html">ccm</a></span><span class="op">(</span><span class="va">covid</span>,<span class="st">"Tokyo"</span>,<span class="va">.l</span>,E <span class="op">=</span> <span class="fl">4</span>,k <span class="op">=</span> <span class="fl">5</span>,tau <span class="op">=</span> <span class="fl">0</span>,progressbar <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>    <span class="va">res</span> <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">g</span><span class="op">$</span><span class="va">xmap</span>,x <span class="op">=</span> <span class="st">"Tokyo"</span>,y <span class="op">=</span> <span class="va">.l</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span><span class="co">##   libsizes x_xmap_y_mean x_xmap_y_sig x_xmap_y_upper x_xmap_y_lower</span></span>
<span><span class="co">## 1      330    0.67946026 5.040237e-46     0.61673862      0.7336087</span></span>
<span><span class="co">## 2      330    0.16587490 2.504472e-03     0.05896709      0.2690210</span></span>
<span><span class="co">## 3      330    0.57198896 4.570356e-30     0.49456667      0.6404051</span></span>
<span><span class="co">## 4      330    0.48695807 4.721760e-21     0.40002512      0.5652068</span></span>
<span><span class="co">## 5      330    0.01813049 7.428103e-01    -0.09000951      0.1258480</span></span>
<span><span class="co">## 6      330    0.59876324 1.747480e-33     0.52471981      0.6638149</span></span>
<span><span class="co">##   y_xmap_x_mean y_xmap_x_sig y_xmap_x_upper y_xmap_x_lower     x        y</span></span>
<span><span class="co">## 1     0.7109490 4.377688e-52      0.6531163      0.7605365 Tokyo Hokkaido</span></span>
<span><span class="co">## 2     0.4283765 3.684937e-16      0.3359501      0.5126315 Tokyo   Aomori</span></span>
<span><span class="co">## 3     0.7497992 8.652007e-61      0.6983692      0.7935262 Tokyo    Iwate</span></span>
<span><span class="co">## 4     0.7060805 4.274506e-51      0.6474744      0.7563843 Tokyo   Miyagi</span></span>
<span><span class="co">## 5     0.2951683 4.658751e-08      0.1933666      0.3906821 Tokyo    Akita</span></span>
<span><span class="co">## 6     0.5089213 3.832070e-23      0.4242690      0.5847557 Tokyo Yamagata</span></span>
<span></span>
<span><span class="va">df1</span> <span class="op">=</span> <span class="va">res</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,<span class="va">y_xmap_x_mean</span>,<span class="va">y_xmap_x_sig</span><span class="op">)</span><span class="op">|&gt;</span></span>
<span>    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/set_names.html" class="external-link">set_names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cause"</span>,<span class="st">"effect"</span>,<span class="st">"cs"</span>,<span class="st">"sig"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df2</span> <span class="op">=</span> <span class="va">res</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">y</span>,<span class="va">x</span>,<span class="va">x_xmap_y_mean</span>,<span class="va">x_xmap_y_sig</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/set_names.html" class="external-link">set_names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cause"</span>,<span class="st">"effect"</span>,<span class="st">"cs"</span>,<span class="st">"sig"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">res_covid</span> <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">df1</span>,<span class="va">df2</span><span class="op">)</span><span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">cause</span> <span class="op">==</span> <span class="st">"Tokyo"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">cs</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res_covid</span>,<span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">##    cause   effect        cs           sig</span></span>
<span><span class="co">## 1  Tokyo    Osaka 0.9296920 2.534740e-144</span></span>
<span><span class="co">## 2  Tokyo Kanagawa 0.9260169 7.921221e-141</span></span>
<span><span class="co">## 3  Tokyo  Saitama 0.9105236 7.469393e-128</span></span>
<span><span class="co">## 4  Tokyo    Chiba 0.9092392 6.936383e-127</span></span>
<span><span class="co">## 5  Tokyo    Hyogo 0.8998115 3.402957e-120</span></span>
<span><span class="co">## 6  Tokyo    Aichi 0.8990747 1.062894e-119</span></span>
<span><span class="co">## 7  Tokyo     Nara 0.8743578 5.100364e-105</span></span>
<span><span class="co">## 8  Tokyo  Ibaraki 0.8719708 9.088820e-104</span></span>
<span><span class="co">## 9  Tokyo Shizuoka 0.8680988 8.611093e-102</span></span>
<span><span class="co">## 10 Tokyo     Gifu 0.8470633  4.766119e-92</span></span></code></pre></div>
<p>Our CCM analysis reproduced the same results as the <a href="https://doi.org/10.1016/j.fmre.2023.01.007" class="external-link">original CMC
study</a>, with the top five prefectures most affected by Tokyo’s
COVID-19 spread matching those previously identified.</p>
<div class="float">
<img src="../reference/figures/edm/jp-covid19.png" alt="Figure 6. The five prefectures most affected by Tokyo, Kanagawa, Osaka, Saitama, Chiba, and Aichi, are located on the map. Red, blue and green dashed rings represent Tokyo, Nagoya and Osaka metropolitan areas, respectively. (Figure adapted from CMC article.)"><div class="figcaption">
<strong>Figure 6</strong>. The five prefectures
most affected by Tokyo, Kanagawa, Osaka, Saitama, Chiba, and Aichi, are
located on the map. Red, blue and green dashed rings represent Tokyo,
Nagoya and Osaka metropolitan areas, respectively. (<em>Figure adapted
from <a href="https://doi.org/10.1016/j.fmre.2023.01.007" class="external-link">CMC
article</a>.</em>)</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="reference">Reference<a class="anchor" aria-label="anchor" href="#reference"></a>
</h2>
<p>Sugihara, G., May, R., Ye, H., Hsieh, C., Deyle, E., Fogarty, M.,
Munch, S., 2012. Detecting Causality in Complex Ecosystems. Science 338,
496–500. <a href="https://doi.org/10.1126/science.1227079" class="external-link">https://doi.org/10.1126/science.1227079</a>.</p>
<p>Leng, S., Ma, H., Kurths, J., Lai, Y.-C., Lin, W., Aihara, K., Chen,
L., 2020. Partial cross mapping eliminates indirect causal influences.
Nature Communications 11. <a href="https://doi.org/10.1038/s41467-020-16238-0" class="external-link">https://doi.org/10.1038/s41467-020-16238-0</a>.</p>
<p>Tao, P., Wang, Q., Shi, J., Hao, X., Liu, X., Min, B., Zhang, Y., Li,
C., Cui, H., Chen, L., 2023. Detecting dynamical causality by
intersection cardinal concavity. Fundamental Research. <a href="https://doi.org/10.1016/j.fmre.2023.01.007" class="external-link">https://doi.org/10.1016/j.fmre.2023.01.007</a>.</p>
<p>Clark, A.T., Ye, H., Isbell, F., Deyle, E.R., Cowles, J., Tilman,
G.D., Sugihara, G., 2015. Spatial convergent cross mapping to detect
causal relationships from short time series. Ecology 96, 1174–1181. <a href="https://doi.org/10.1890/14-1479.1" class="external-link">https://doi.org/10.1890/14-1479.1</a>.</p>
<p>Gan, T., Succar, R., Macrì, S., Marín, M.R., Porfiri, M., 2025.
Causal discovery from city data, where urban scaling meets information
theory. Cities 162, 105980. <a href="https://doi.org/10.1016/j.cities.2025.105980" class="external-link">https://doi.org/10.1016/j.cities.2025.105980</a>.</p>
<p> </p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://spatlyu.github.io/" class="external-link">Wenbo Lv</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
