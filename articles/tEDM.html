<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Temporal Empirical Dynamic Modeling • tEDM</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Temporal Empirical Dynamic Modeling">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tEDM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><a class="dropdown-item" href="../articles/tEDM.html">Temporal Empirical Dynamic Modeling</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/stscl/tEDM/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Temporal Empirical Dynamic Modeling</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/stscl/tEDM/blob/main/vignettes/tEDM.Rmd" class="external-link"><code>vignettes/tEDM.Rmd</code></a></small>
      <div class="d-none name"><code>tEDM.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction-to-the-tedm-package">1. Introduction to the <code>tEDM</code> package<a class="anchor" aria-label="anchor" href="#introduction-to-the-tedm-package"></a>
</h2>
<p>The <code>tEDM</code> package provides a suite of tools for exploring
and quantifying causality in time series using Empirical Dynamic
Modeling (EDM). It implements four fundamental EDM-based causal
discovery methods:</p>
<ul>
<li><p><a href="https://doi.org/10.1126/science.1227079" class="external-link"><strong>Convergent Cross
Mapping (CCM)</strong></a></p></li>
<li><p><a href="https://doi.org/10.1038/s41467-020-16238-0" class="external-link"><strong>Partial Cross
Mapping (PCM)</strong></a></p></li>
<li><p><a href="https://doi.org/10.1016/j.fmre.2023.01.007" class="external-link"><strong>Cross Mapping
Cardinality (CMC)</strong></a></p></li>
<li><p><a href="https://doi.org/10.1890/14-1479.1" class="external-link"><strong>Multispatial
Convergent Cross Mapping (MultispatialCCM)</strong></a></p></li>
</ul>
<p>These methods enable researchers to:</p>
<ul>
<li><p><strong>Identify</strong> potential causal interactions without
assuming a predefined model structure.</p></li>
<li><p><strong>Distinguish</strong> between direct causation and
indirect (mediated or confounded) influences.</p></li>
<li><p><strong>Reconstruct</strong> underlying causal dynamics from
replicated univariate time series observed across multiple spatial
units.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="example-data-in-the-tedm-package">2. Example data in the <code>tEDM</code> package<a class="anchor" aria-label="anchor" href="#example-data-in-the-tedm-package"></a>
</h2>
<div class="section level3">
<h3 id="hong-kong-air-pollution-and-cardiovascular-admissions">Hong Kong Air Pollution and Cardiovascular Admissions<a class="anchor" aria-label="anchor" href="#hong-kong-air-pollution-and-cardiovascular-admissions"></a>
</h3>
<p>A daily time series dataset(from 1995-3 to 1997-11) for Hong Kong
that includes cardiovascular hospital admissions and major air pollutant
concentrations.</p>
<p><strong>File</strong>: <code>cvd.csv</code></p>
<p><strong>Columns</strong>:</p>
<table class="table">
<thead><tr class="header">
<th>Column</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>cvd</code></td>
<td>Daily number of cardiovascular-related hospital admissions.</td>
</tr>
<tr class="even">
<td><code>rsp</code></td>
<td>Respirable suspended particulates (μg/m³).</td>
</tr>
<tr class="odd">
<td><code>no2</code></td>
<td>Nitrogen dioxide concentration (μg/m³).</td>
</tr>
<tr class="even">
<td><code>so2</code></td>
<td>Sulfur dioxide concentration (μg/m³).</td>
</tr>
<tr class="odd">
<td><code>o3</code></td>
<td>Ozone concentration (μg/m³).</td>
</tr>
</tbody>
</table>
<p><strong>Source</strong>: Data adapted from <a href="https://doi.org/10.1038/s41467-020-16238-0" class="external-link">PCM article</a>.</p>
<hr>
</div>
<div class="section level3">
<h3 id="us-county-level-carbon-emissions-dataset">US County-Level Carbon Emissions Dataset<a class="anchor" aria-label="anchor" href="#us-county-level-carbon-emissions-dataset"></a>
</h3>
<p>A panel dataset covering U.S. county-level temperature and carbon
emissions across time.</p>
<p><strong>File</strong>: <code>carbon.csv.gz</code></p>
<p><strong>Columns</strong>:</p>
<table class="table">
<colgroup>
<col width="10%">
<col width="90%">
</colgroup>
<thead><tr class="header">
<th>Column</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>year</code></td>
<td>Observation year (1981–2017).</td>
</tr>
<tr class="even">
<td><code>fips</code></td>
<td>County FIPS code (5-digit Federal Information Processing Standard
code).</td>
</tr>
<tr class="odd">
<td><code>tem</code></td>
<td>Mean annual temperature (in Kelvin).</td>
</tr>
<tr class="even">
<td><code>carbon</code></td>
<td>Total carbon emissions per year (in kilograms of CO₂).</td>
</tr>
</tbody>
</table>
<p><strong>Source</strong>: Data adapted from <a href="https://doi.org/10.1016/j.cities.2025.105980" class="external-link">FsATE
article</a>.</p>
<hr>
</div>
<div class="section level3">
<h3 id="covid-19-infection-counts-in-japan">COVID-19 Infection Counts in Japan<a class="anchor" aria-label="anchor" href="#covid-19-infection-counts-in-japan"></a>
</h3>
<p>A spatio-temporal dataset capturing the number of confirmed COVID-19
infections across Japan’s 47 prefectures over time.</p>
<p><strong>File</strong>: <code>covid.csv</code></p>
<p><strong>Structure</strong>:</p>
<ul>
<li>Each <strong>column</strong> represents one of the 47 Japanese
prefectures (e.g., <code>Tokyo</code>, <code>Osaka</code>,
<code>Hokkaido</code>).</li>
<li>Each <strong>row</strong> corresponds to a time step (daily).</li>
</ul>
<p><strong>Source</strong>: Data adapted from <a href="https://doi.org/10.1016/j.fmre.2023.01.007" class="external-link">CMC article</a>.</p>
</div>
</div>
<div class="section level2">
<h2 id="case-studies-of-the-tedm-package">3. Case studies of the <code>tEDM</code> package<a class="anchor" aria-label="anchor" href="#case-studies-of-the-tedm-package"></a>
</h2>
<p>Install the stable version:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"tEDM"</span>, dep <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>or dev version:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"tEDM"</span>,</span>
<span>                 repos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"https://stscl.r-universe.dev"</span>,</span>
<span>                           <span class="st">"https://cloud.r-project.org"</span><span class="op">)</span>,</span>
<span>                 dep <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="air-pollution-and-cardiovascular-health-in-hong-kong">Air Pollution and Cardiovascular Health in Hong Kong<a class="anchor" aria-label="anchor" href="#air-pollution-and-cardiovascular-health-in-hong-kong"></a>
</h3>
<p>Employing CCM, CMC and PCM to investigate the causal relationships
between various air pollutants and cardiovascular diseases:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stscl.github.io/tEDM/">tEDM</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">cvd</span> <span class="op">=</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"case/cvd.csv"</span>,package <span class="op">=</span> <span class="st">"tEDM"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">1032</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">5</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">## <span style="font-weight: bold;">Delimiter:</span> ","</span></span>
<span><span class="co">## <span style="color: #00BB00;">dbl</span> (5): cvd, rsp, no2, so2, o3</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">cvd</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 5</span></span></span>
<span><span class="co">##     cvd   rsp   no2   so2    o3</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>   214  73.7  74.5  19.1 17.4 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>   203  77.6  80.9  18.8 39.4 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>   202  64.8  67.1  13.8 56.4 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span>   182  68.8  74.7  30.8  5.6 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span>   181  49.4  62.3  23.1  3.6 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span>   129  67.4  63.6  17.4  6.73</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cvd_long</span> <span class="op">=</span> <span class="va">cvd</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">rowid_to_column</a></span><span class="op">(</span><span class="st">"id"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span><span class="va">id</span>,</span>
<span>                      names_to <span class="op">=</span> <span class="st">"variable"</span>, values_to <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fig1</span> <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">cvd_long</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">id</span>, y <span class="op">=</span> <span class="va">value</span>, color <span class="op">=</span> <span class="va">variable</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Days (from 1995-3 to 1997-11)"</span>, y <span class="op">=</span> <span class="st">"Concentrations or \nNO. of CVD admissions"</span>, color <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.direction <span class="op">=</span> <span class="st">"horizontal"</span>,</span>
<span>                 legend.position <span class="op">=</span> <span class="st">"inside"</span>,</span>
<span>                 legend.justification <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"center"</span>,<span class="st">"top"</span><span class="op">)</span>,</span>
<span>                 legend.background <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"transparent"</span>, color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fig1</span></span></code></pre></div>
<div class="figure">
<img src="tEDM_files/figure-html/fig1-1.png" alt="**Figure 1**. Time series of air pollutants and confirmed CVD cases in Hong Kong from March 1995 to November 1997." width="650"><p class="caption">
<strong>Figure 1</strong>. Time series of air pollutants and confirmed
CVD cases in Hong Kong from March 1995 to November 1997.
</p>
</div>
<p>Determining optimal embedding dimension:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tEDM</span><span class="fu">::</span><span class="fu"><a href="../reference/fnn.html">fnn</a></span><span class="op">(</span><span class="va">cvd</span>,<span class="st">"cvd"</span>,E <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">50</span>,eps <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">cvd</span><span class="op">$</span><span class="va">cvd</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##       E:1       E:2       E:3       E:4       E:5       E:6       E:7       E:8 </span></span>
<span><span class="co">## 0.4827586 0.5611765 0.3894850 0.3004292 0.2682403 0.2564378 0.2607296 0.2671674 </span></span>
<span><span class="co">##       E:9      E:10      E:11      E:12      E:13      E:14      E:15      E:16 </span></span>
<span><span class="co">## 0.2639485 0.2607296 0.2521459 0.2682403 0.2467811 0.2457082 0.2392704 0.2242489 </span></span>
<span><span class="co">##      E:17      E:18      E:19      E:20      E:21      E:22      E:23      E:24 </span></span>
<span><span class="co">## 0.2306867 0.2371245 0.2435622 0.2414163 0.2317597 0.2242489 0.2199571 0.2296137 </span></span>
<span><span class="co">##      E:25      E:26      E:27      E:28      E:29      E:30      E:31      E:32 </span></span>
<span><span class="co">## 0.2253219 0.2242489 0.2285408 0.2435622 0.2339056 0.2306867 0.2242489 0.2360515 </span></span>
<span><span class="co">##      E:33      E:34      E:35      E:36      E:37      E:38      E:39      E:40 </span></span>
<span><span class="co">## 0.2510730 0.2532189 0.2553648 0.2532189 0.2500000 0.2521459 0.2564378 0.2457082 </span></span>
<span><span class="co">##      E:41      E:42      E:43      E:44      E:45      E:46      E:47      E:48 </span></span>
<span><span class="co">## 0.2478541 0.2414163 0.2435622 0.2478541 0.2489270 0.2585837 0.2671674 0.2553648 </span></span>
<span><span class="co">##      E:49 </span></span>
<span><span class="co">## 0.2585837</span></span></code></pre>
<p>Starting at <span class="math inline">\(E = 5\)</span>, the FNN ratio
stabilizes near 0.2; thus, embedding dimension E and neighbor number k
are chosen from 5 onward for subsequent self-prediction parameter
selection.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tEDM</span><span class="fu">::</span><span class="fu"><a href="../reference/simplex.html">simplex</a></span><span class="op">(</span><span class="va">cvd</span>,<span class="st">"cvd"</span>,<span class="st">"cvd"</span>,E <span class="op">=</span> <span class="fl">5</span><span class="op">:</span><span class="fl">25</span>,k <span class="op">=</span> <span class="fl">6</span><span class="op">:</span><span class="fl">35</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## The suggested E and k for variable cvd is 5 and 6</span></span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tEDM</span><span class="fu">::</span><span class="fu"><a href="../reference/simplex.html">simplex</a></span><span class="op">(</span><span class="va">cvd</span>,<span class="st">"rsp"</span>,<span class="st">"rsp"</span>,E <span class="op">=</span> <span class="fl">5</span><span class="op">:</span><span class="fl">25</span>,k <span class="op">=</span> <span class="fl">6</span><span class="op">:</span><span class="fl">35</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## The suggested E and k for variable rsp is 5 and 6</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tEDM</span><span class="fu">::</span><span class="fu"><a href="../reference/simplex.html">simplex</a></span><span class="op">(</span><span class="va">cvd</span>,<span class="st">"no2"</span>,<span class="st">"no2"</span>,E <span class="op">=</span> <span class="fl">5</span><span class="op">:</span><span class="fl">25</span>,k <span class="op">=</span> <span class="fl">6</span><span class="op">:</span><span class="fl">35</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## The suggested E and k for variable no2 is 5 and 8</span></span></code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tEDM</span><span class="fu">::</span><span class="fu"><a href="../reference/simplex.html">simplex</a></span><span class="op">(</span><span class="va">cvd</span>,<span class="st">"so2"</span>,<span class="st">"so2"</span>,E <span class="op">=</span> <span class="fl">5</span><span class="op">:</span><span class="fl">25</span>,k <span class="op">=</span> <span class="fl">6</span><span class="op">:</span><span class="fl">35</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## The suggested E and k for variable so2 is 5 and 15</span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tEDM</span><span class="fu">::</span><span class="fu"><a href="../reference/simplex.html">simplex</a></span><span class="op">(</span><span class="va">cvd</span>,<span class="st">"o3"</span>,<span class="st">"o3"</span>,E <span class="op">=</span> <span class="fl">5</span><span class="op">:</span><span class="fl">25</span>,k <span class="op">=</span> <span class="fl">6</span><span class="op">:</span><span class="fl">35</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## The suggested E and k for variable o3 is 5 and 6</span></span></code></pre>
<p>We first use CCM to explore the causal influences of air pollutants
on the incidence of cardiovascular diseases.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rsp_cvd</span> <span class="op">=</span> <span class="fu">tEDM</span><span class="fu">::</span><span class="fu"><a href="../reference/ccm.html">ccm</a></span><span class="op">(</span><span class="va">cvd</span>,<span class="st">"rsp"</span>,<span class="st">"cvd"</span>,libsizes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">32</span>,<span class="fl">1032</span>,<span class="fl">100</span><span class="op">)</span>,E <span class="op">=</span> <span class="fl">5</span>,k <span class="op">=</span> <span class="fl">6</span>,progressbar <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">rsp_cvd</span></span></code></pre></div>
<pre><code><span><span class="co">##    libsizes   rsp-&gt;cvd   cvd-&gt;rsp</span></span>
<span><span class="co">## 1        32 0.04319516 0.01319450</span></span>
<span><span class="co">## 2       132 0.04437840 0.04042972</span></span>
<span><span class="co">## 3       232 0.05755968 0.04856251</span></span>
<span><span class="co">## 4       332 0.05213455 0.05497566</span></span>
<span><span class="co">## 5       432 0.04204529 0.05345864</span></span>
<span><span class="co">## 6       532 0.03869321 0.05163371</span></span>
<span><span class="co">## 7       632 0.03449846 0.05149252</span></span>
<span><span class="co">## 8       732 0.02813186 0.05075322</span></span>
<span><span class="co">## 9       832 0.02364578 0.05075094</span></span>
<span><span class="co">## 10      932 0.02226927 0.05080212</span></span>
<span><span class="co">## 11     1027 0.07212221 0.05626339</span></span></code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">no2_cvd</span> <span class="op">=</span> <span class="fu">tEDM</span><span class="fu">::</span><span class="fu"><a href="../reference/ccm.html">ccm</a></span><span class="op">(</span><span class="va">cvd</span>,<span class="st">"no2"</span>,<span class="st">"cvd"</span>,libsizes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">32</span>,<span class="fl">1032</span>,<span class="fl">100</span><span class="op">)</span>,E <span class="op">=</span> <span class="fl">5</span>,k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>,<span class="fl">6</span><span class="op">)</span>,progressbar <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">no2_cvd</span></span></code></pre></div>
<pre><code><span><span class="co">##    libsizes   no2-&gt;cvd   cvd-&gt;no2</span></span>
<span><span class="co">## 1        32 0.09597753 0.04864942</span></span>
<span><span class="co">## 2       132 0.12416134 0.09638212</span></span>
<span><span class="co">## 3       232 0.15621628 0.11924223</span></span>
<span><span class="co">## 4       332 0.16302570 0.12659628</span></span>
<span><span class="co">## 5       432 0.15722930 0.12724020</span></span>
<span><span class="co">## 6       532 0.15592151 0.12779650</span></span>
<span><span class="co">## 7       632 0.15271207 0.12670729</span></span>
<span><span class="co">## 8       732 0.14752161 0.12305037</span></span>
<span><span class="co">## 9       832 0.14525414 0.12052819</span></span>
<span><span class="co">## 10      932 0.14519559 0.11924900</span></span>
<span><span class="co">## 11     1027 0.23186797 0.17037681</span></span></code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">so2_cvd</span> <span class="op">=</span> <span class="fu">tEDM</span><span class="fu">::</span><span class="fu"><a href="../reference/ccm.html">ccm</a></span><span class="op">(</span><span class="va">cvd</span>,<span class="st">"so2"</span>,<span class="st">"cvd"</span>,libsizes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">32</span>,<span class="fl">1032</span>,<span class="fl">100</span><span class="op">)</span>,E <span class="op">=</span> <span class="fl">5</span>,k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>,<span class="fl">6</span><span class="op">)</span>,progressbar <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">so2_cvd</span></span></code></pre></div>
<pre><code><span><span class="co">##    libsizes    so2-&gt;cvd   cvd-&gt;so2</span></span>
<span><span class="co">## 1        32 0.038665119 0.03405003</span></span>
<span><span class="co">## 2       132 0.023943075 0.06258078</span></span>
<span><span class="co">## 3       232 0.020748020 0.07086180</span></span>
<span><span class="co">## 4       332 0.019672824 0.07066856</span></span>
<span><span class="co">## 5       432 0.017233107 0.07339913</span></span>
<span><span class="co">## 6       532 0.016922496 0.07205969</span></span>
<span><span class="co">## 7       632 0.014945947 0.07428336</span></span>
<span><span class="co">## 8       732 0.011701558 0.07877438</span></span>
<span><span class="co">## 9       832 0.009729901 0.08091936</span></span>
<span><span class="co">## 10      932 0.009048317 0.08116150</span></span>
<span><span class="co">## 11     1027 0.011257499 0.07416282</span></span></code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">o3_cvd</span> <span class="op">=</span> <span class="fu">tEDM</span><span class="fu">::</span><span class="fu"><a href="../reference/ccm.html">ccm</a></span><span class="op">(</span><span class="va">cvd</span>,<span class="st">"o3"</span>,<span class="st">"cvd"</span>,libsizes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">32</span>,<span class="fl">1032</span>,<span class="fl">100</span><span class="op">)</span>,E <span class="op">=</span> <span class="fl">5</span>,k <span class="op">=</span> <span class="fl">6</span>,progressbar <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">o3_cvd</span></span></code></pre></div>
<pre><code><span><span class="co">##    libsizes       o3-&gt;cvd    cvd-&gt;o3</span></span>
<span><span class="co">## 1        32 -0.0021382170 0.02675574</span></span>
<span><span class="co">## 2       132 -0.0028994401 0.03818003</span></span>
<span><span class="co">## 3       232  0.0015246470 0.04784981</span></span>
<span><span class="co">## 4       332  0.0047085847 0.04764828</span></span>
<span><span class="co">## 5       432  0.0030374107 0.04542627</span></span>
<span><span class="co">## 6       532  0.0020648753 0.04110124</span></span>
<span><span class="co">## 7       632  0.0009115659 0.03699687</span></span>
<span><span class="co">## 8       732 -0.0017126973 0.03108036</span></span>
<span><span class="co">## 9       832 -0.0011312952 0.02697292</span></span>
<span><span class="co">## 10      932  0.0004006101 0.02451813</span></span>
<span><span class="co">## 11     1027  0.0480365415 0.06844222</span></span></code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">figa</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">rsp_cvd</span>,ylimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.01</span>,<span class="fl">0.1</span><span class="op">)</span>,ybreaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.05</span>,<span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">figb</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">no2_cvd</span>,ylimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.03</span>,<span class="fl">0.25</span><span class="op">)</span>,ybreaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.05</span>,<span class="fl">0.25</span>,<span class="fl">0.05</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">figc</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">so2_cvd</span>,ylimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.01</span>,<span class="fl">0.1</span><span class="op">)</span>,ybreaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.05</span>,<span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">figd</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">o3_cvd</span>,ylimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.01</span>,<span class="fl">0.1</span><span class="op">)</span>,ybreaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.05</span>,<span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fig2</span> <span class="op">=</span> <span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">figa</span>, <span class="va">figb</span>, <span class="va">figc</span>, <span class="va">figd</span>, ncol <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                         label_fontfamily <span class="op">=</span> <span class="st">'serif'</span>,</span>
<span>                         labels <span class="op">=</span> <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">fig2</span></span></code></pre></div>
<div class="figure">
<img src="tEDM_files/figure-html/fig2-1.png" alt="**Figure 2**. Cross-mapping results between different air pollutants and cardiovascular diseases." width="750"><p class="caption">
<strong>Figure 2</strong>. Cross-mapping results between different air
pollutants and cardiovascular diseases.
</p>
</div>
<p>The results shown in Figure2 indicate the presence of the following
causal influences:</p>
<ul>
<li>rsp → cvd<br>
</li>
<li>no₂ → cvd<br>
</li>
<li>cvd → no₂<br>
</li>
<li>cvd → o₃</li>
</ul>
<p>However, based on practical experience, the relationship between CVDs
and spatial pollution is likely reflective rather than causal.
Therefore, we further employ CCM to examine the causal paths of cvd →
no₂ and cvd → o₃.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g1</span> <span class="op">=</span> <span class="fu">tEDM</span><span class="fu">::</span><span class="fu"><a href="../reference/cmc.html">cmc</a></span><span class="op">(</span><span class="va">cvd</span>,<span class="st">"o3"</span>,<span class="st">"cvd"</span>,E <span class="op">=</span> <span class="fl">5</span>,k <span class="op">=</span> <span class="fl">100</span>,progressbar <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">g1</span></span></code></pre></div>
<pre><code><span><span class="co">##   neighbors o3-&gt;cvd cvd-&gt;o3</span></span>
<span><span class="co">## 1       100  0.2344  0.5589</span></span></code></pre>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g1</span><span class="op">$</span><span class="va">xmap</span></span></code></pre></div>
<pre><code><span><span class="co">##   neighbors x_xmap_y_mean x_xmap_y_sig x_xmap_y_upper x_xmap_y_lower</span></span>
<span><span class="co">## 1       100        0.5589     0.188823      0.6467507      0.4710493</span></span>
<span><span class="co">##   y_xmap_x_mean y_xmap_x_sig y_xmap_x_upper y_xmap_x_lower</span></span>
<span><span class="co">## 1        0.2344 2.138197e-12      0.3085003      0.1602997</span></span></code></pre>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g2</span> <span class="op">=</span> <span class="fu">tEDM</span><span class="fu">::</span><span class="fu"><a href="../reference/cmc.html">cmc</a></span><span class="op">(</span><span class="va">cvd</span>,<span class="st">"no2"</span>,<span class="st">"cvd"</span>,E <span class="op">=</span> <span class="fl">5</span>,k <span class="op">=</span> <span class="fl">100</span>,progressbar <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">g2</span></span></code></pre></div>
<pre><code><span><span class="co">##   neighbors no2-&gt;cvd cvd-&gt;no2</span></span>
<span><span class="co">## 1       100   0.4833   0.5363</span></span></code></pre>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g2</span><span class="op">$</span><span class="va">xmap</span></span></code></pre></div>
<pre><code><span><span class="co">##   neighbors x_xmap_y_mean x_xmap_y_sig x_xmap_y_upper x_xmap_y_lower</span></span>
<span><span class="co">## 1       100        0.5363    0.4205595      0.6246315      0.4479685</span></span>
<span><span class="co">##   y_xmap_x_mean y_xmap_x_sig y_xmap_x_upper y_xmap_x_lower</span></span>
<span><span class="co">## 1        0.4833    0.7186329      0.5741482      0.3924518</span></span></code></pre>
<p>The causal paths <strong>cvd → no₂</strong> and <strong>cvd →
o₃</strong> are not statistically significant in the CMC analysis
results, allowing us to rule out these two directions. Therefore, we
conclude that only <strong>rsp</strong> and <strong>no₂</strong> exhibit
causal influences on CVDs.</p>
<p>We further aim to explore the potential causal interactions among
different air pollutants. However, due to space constraints in this
vignette, we limit our analysis to a single test case — specifically,
examining whether <strong>NO₂</strong> exerts a causal influence on
<strong>Respirable Suspended Particulates (rsp)</strong>.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">no2_rsp</span> <span class="op">=</span> <span class="fu">tEDM</span><span class="fu">::</span><span class="fu"><a href="../reference/pcm.html">pcm</a></span><span class="op">(</span><span class="va">cvd</span>,<span class="st">"no2"</span>,<span class="st">"rsp"</span>,<span class="st">"cvd"</span>,libsizes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">32</span>,<span class="fl">1032</span>,<span class="fl">100</span><span class="op">)</span>,E <span class="op">=</span> <span class="fl">5</span>,k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>,<span class="fl">6</span>,<span class="fl">6</span><span class="op">)</span>,progressbar <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">no2_rsp</span></span></code></pre></div>
<pre><code><span><span class="co">## -------------------------------------- </span></span>
<span><span class="co">## ***partial cross mapping prediction*** </span></span>
<span><span class="co">## -------------------------------------- </span></span>
<span><span class="co">##    libsizes  no2-&gt;rsp  rsp-&gt;no2</span></span>
<span><span class="co">## 1        32 0.5718384 0.5872235</span></span>
<span><span class="co">## 2       132 0.6926588 0.6891724</span></span>
<span><span class="co">## 3       232 0.7129181 0.6999073</span></span>
<span><span class="co">## 4       332 0.7251034 0.7065649</span></span>
<span><span class="co">## 5       432 0.7292544 0.7132728</span></span>
<span><span class="co">## 6       532 0.7305393 0.7175689</span></span>
<span><span class="co">## 7       632 0.7308904 0.7208970</span></span>
<span><span class="co">## 8       732 0.7322006 0.7239768</span></span>
<span><span class="co">## 9       832 0.7335073 0.7282566</span></span>
<span><span class="co">## 10      932 0.7338654 0.7295781</span></span>
<span><span class="co">## 11     1027 0.7362657 0.7246647</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ------------------------------ </span></span>
<span><span class="co">## ***cross mapping prediction*** </span></span>
<span><span class="co">## ------------------------------ </span></span>
<span><span class="co">##    libsizes  no2-&gt;rsp  rsp-&gt;no2</span></span>
<span><span class="co">## 1        32 0.5891342 0.6095253</span></span>
<span><span class="co">## 2       132 0.7085988 0.7137024</span></span>
<span><span class="co">## 3       232 0.7235291 0.7327955</span></span>
<span><span class="co">## 4       332 0.7325251 0.7409321</span></span>
<span><span class="co">## 5       432 0.7368667 0.7435845</span></span>
<span><span class="co">## 6       532 0.7382566 0.7454804</span></span>
<span><span class="co">## 7       632 0.7389185 0.7473104</span></span>
<span><span class="co">## 8       732 0.7397101 0.7479086</span></span>
<span><span class="co">## 9       832 0.7399319 0.7481982</span></span>
<span><span class="co">## 10      932 0.7399475 0.7481772</span></span>
<span><span class="co">## 11     1027 0.7623938 0.7574991</span></span></code></pre>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">figa</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">no2_rsp</span>,partial <span class="op">=</span> <span class="cn">FALSE</span>,ylimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">0.85</span><span class="op">)</span>,ybreaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">0.85</span>,<span class="fl">0.05</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">figb</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">no2_rsp</span>,ylimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">0.85</span><span class="op">)</span>,ybreaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">0.85</span>,<span class="fl">0.05</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fig3</span> <span class="op">=</span> <span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">figa</span>, <span class="va">figb</span>, ncol <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                          label_fontfamily <span class="op">=</span> <span class="st">'serif'</span>,</span>
<span>                          labels <span class="op">=</span> <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">fig3</span></span></code></pre></div>
<div class="figure">
<img src="tEDM_files/figure-html/fig3-1.png" alt="**Figure 3**. Cross-mapping results between no₂ and respirable suspended particulates. **a**. CCM results without accounting for other variables. **b**. PCM results controlling for the influence of CVDs." width="650"><p class="caption">
<strong>Figure 3</strong>. Cross-mapping results between no₂ and
respirable suspended particulates. <strong>a</strong>. CCM results
without accounting for other variables. <strong>b</strong>. PCM results
controlling for the influence of CVDs.
</p>
</div>
<p>The CCM and PCM results between <strong>NO₂</strong> and
<strong>respirable suspended particulates</strong> show minimal
differences and are both statistically significant, indicating the
presence of a causal relationship between the two. Therefore, the final
set of confirmed causal pathways is as follows (exclude those with no
causal influence on CVDs):</p>
<div class="float">
<img src="../reference/figures/edm/hk-cvd.png" alt="Figure 4. Causal interactions between air pollutants and cardiovascular diseases in Hong Kong."><div class="figcaption">
<strong>Figure 4</strong>. Causal interactions
between air pollutants and cardiovascular diseases in Hong Kong.</div>
</div>
</div>
<div class="section level3">
<h3 id="us-county-carbon-emissions-and-temperature-dynamics">US County Carbon Emissions and Temperature Dynamics<a class="anchor" aria-label="anchor" href="#us-county-carbon-emissions-and-temperature-dynamics"></a>
</h3>
<p>To examine whether a causal relationship exists between annual mean
temperature and total annual CO₂ emissions, we implement the CMC method
across counties.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stscl.github.io/tEDM/">tEDM</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">carbon</span> <span class="op">=</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"case/carbon.csv.gz"</span>,package <span class="op">=</span> <span class="st">"tEDM"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">113627</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">4</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">## <span style="font-weight: bold;">Delimiter:</span> ","</span></span>
<span><span class="co">## <span style="color: #00BB00;">dbl</span> (4): year, fips, tem, carbon</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span></code></pre>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">carbon</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 4</span></span></span>
<span><span class="co">##    year  fips   tem     carbon</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>  <span style="text-decoration: underline;">1</span>981  <span style="text-decoration: underline;">1</span>001  17.4 192<span style="text-decoration: underline;">607</span>687.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>  <span style="text-decoration: underline;">1</span>982  <span style="text-decoration: underline;">1</span>001  18.4 187<span style="text-decoration: underline;">149</span>414.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>  <span style="text-decoration: underline;">1</span>983  <span style="text-decoration: underline;">1</span>001  16.9 191<span style="text-decoration: underline;">584</span>445.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span>  <span style="text-decoration: underline;">1</span>984  <span style="text-decoration: underline;">1</span>001  17.8 199<span style="text-decoration: underline;">157</span>579.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span>  <span style="text-decoration: underline;">1</span>985  <span style="text-decoration: underline;">1</span>001  17.9 205<span style="text-decoration: underline;">207</span>564.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span>  <span style="text-decoration: underline;">1</span>986  <span style="text-decoration: underline;">1</span>001  18.5 218<span style="text-decoration: underline;">446</span>030.</span></span></code></pre>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">carbon_list</span> <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_split.html" class="external-link">group_split</a></span><span class="op">(</span><span class="va">carbon</span>, by <span class="op">=</span> <span class="va">fips</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">carbon_list</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 3071</span></span></code></pre>
<p>Using the 100th county as an example, we determine the appropriate
embedding dimension by applying the FNN method.</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tEDM</span><span class="fu">::</span><span class="fu"><a href="../reference/fnn.html">fnn</a></span><span class="op">(</span><span class="va">carbon_list</span><span class="op">[[</span><span class="fl">100</span><span class="op">]</span><span class="op">]</span>,<span class="st">"carbon"</span>,E <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">10</span>,eps <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">carbon_list</span><span class="op">[[</span><span class="fl">100</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">carbon</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##        E:1        E:2        E:3        E:4        E:5        E:6        E:7 </span></span>
<span><span class="co">## 0.58823529 0.23529412 0.23529412 0.17647059 0.05882353 0.00000000 0.00000000 </span></span>
<span><span class="co">##        E:8        E:9 </span></span>
<span><span class="co">## 0.00000000 0.00000000</span></span></code></pre>
<p>When E equals 6, the FNN ratio begins to drop to zero; therefore, we
select <span class="math inline">\(E = 6\)</span> as the embedding
dimension for the CMC analysis.</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">=</span> <span class="va">carbon_list</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_dfr</a></span><span class="op">(</span>\<span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">g</span> <span class="op">=</span> <span class="fu">tEDM</span><span class="fu">::</span><span class="fu"><a href="../reference/cmc.html">cmc</a></span><span class="op">(</span><span class="va">.x</span>,<span class="st">"tem"</span>,<span class="st">"carbon"</span>,E <span class="op">=</span> <span class="fl">6</span>,k <span class="op">=</span> <span class="fl">20</span>,progressbar <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">g</span><span class="op">$</span><span class="va">xmap</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   neighbors x_xmap_y_mean x_xmap_y_sig x_xmap_y_upper x_xmap_y_lower</span></span>
<span><span class="co">## 1        20       0.23000 7.559829e-04      0.3871031     0.07289694</span></span>
<span><span class="co">## 2        20       0.15250 5.155608e-08      0.2775652     0.02743478</span></span>
<span><span class="co">## 3        20       0.15125 3.546400e-08      0.2752574     0.02724258</span></span>
<span><span class="co">## 4        20       0.14125 1.237298e-08      0.2647264     0.01777360</span></span>
<span><span class="co">## 5        20       0.14625 2.766598e-08      0.2710497     0.02145029</span></span>
<span><span class="co">## 6        20       0.13625 9.223181e-09      0.2603593     0.01214072</span></span>
<span><span class="co">##   y_xmap_x_mean y_xmap_x_sig y_xmap_x_upper y_xmap_x_lower</span></span>
<span><span class="co">## 1       0.03875 2.661759e-41      0.1059107              0</span></span>
<span><span class="co">## 2       0.04250 3.673257e-37      0.1128988              0</span></span>
<span><span class="co">## 3       0.04375 2.129338e-31      0.1204663              0</span></span>
<span><span class="co">## 4       0.04375 2.129338e-31      0.1204663              0</span></span>
<span><span class="co">## 5       0.04500 1.570561e-32      0.1200890              0</span></span>
<span><span class="co">## 6       0.03750 2.118657e-39      0.1065211              0</span></span></code></pre>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_carbon</span> <span class="op">=</span> <span class="va">res</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">neighbors</span>,</span>
<span>                carbon_tem <span class="op">=</span> <span class="va">x_xmap_y_mean</span>,</span>
<span>                tem_carbon <span class="op">=</span> <span class="va">y_xmap_x_mean</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">carbon_tem</span>, <span class="va">tem_carbon</span><span class="op">)</span>, </span>
<span>                      names_to <span class="op">=</span> <span class="st">"variable"</span>, values_to <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res_carbon</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 3</span></span></span>
<span><span class="co">##   neighbors variable    value</span></span>
<span><span class="co">##       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>        20 carbon_tem 0.23  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>        20 tem_carbon 0.038<span style="text-decoration: underline;">8</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>        20 carbon_tem 0.152 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span>        20 tem_carbon 0.042<span style="text-decoration: underline;">5</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span>        20 carbon_tem 0.151 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span>        20 tem_carbon 0.043<span style="text-decoration: underline;">8</span></span></span></code></pre>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fig_case2</span> <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">res_carbon</span>, </span>
<span>                            <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">variable</span>, y <span class="op">=</span> <span class="va">value</span>, fill <span class="op">=</span> <span class="va">variable</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">"Causal Strength"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"carbon_tem"</span> <span class="op">=</span> <span class="st">"carbon → tem"</span>,</span>
<span>                                       <span class="st">"tem_carbon"</span> <span class="op">=</span> <span class="st">"tem → carbon"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span><span class="va">fig_case2</span></span></code></pre></div>
<div class="figure">
<img src="tEDM_files/figure-html/fig_case2-1.png" alt="**Figure 5**. Causal strength scores between annual mean temperature and total annual CO₂ emissions across US counties, with embedding dimension E set to 6 and number of neighbors set to 20." width="450"><p class="caption">
<strong>Figure 5</strong>. Causal strength scores between annual mean
temperature and total annual CO₂ emissions across US counties, with
embedding dimension E set to 6 and number of neighbors set to 20.
</p>
</div>
</div>
<div class="section level3">
<h3 id="covid-19-spread-across-japanese-prefectures">COVID-19 Spread Across Japanese Prefectures<a class="anchor" aria-label="anchor" href="#covid-19-spread-across-japanese-prefectures"></a>
</h3>
<p>We examine the COVID-19 transmission between Tokyo and other
prefectures by applying CCM to identify the underlying causal dynamics
of the epidemic spread</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stscl.github.io/tEDM/">tEDM</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">covid</span> <span class="op">=</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"case/covid.csv"</span>,package <span class="op">=</span> <span class="st">"tEDM"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">334</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">47</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">## <span style="font-weight: bold;">Delimiter:</span> ","</span></span>
<span><span class="co">## <span style="color: #00BB00;">dbl</span> (47): Hokkaido, Aomori, Iwate, Miyagi, Akita, Yamagata, Fukushima, Ibara...</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span></code></pre>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">covid</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 47</span></span></span>
<span><span class="co">##   Hokkaido Aomori Iwate Miyagi Akita Yamagata Fukushima Ibaraki Tochigi Gunma</span></span>
<span><span class="co">##      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>        0      0     0      0     0        0         0       0       0     0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>        0      0     0      0     0        0         0       0       0     0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>        0      0     0      0     0        0         0       0       0     0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span>        0      0     0      0     0        0         0       0       0     0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span>        0      0     0      0     0        0         0       0       0     0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span>        0      0     0      0     0        0         0       0       0     0</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 37 more variables: Saitama &lt;dbl&gt;, Chiba &lt;dbl&gt;, Tokyo &lt;dbl&gt;, Kanagawa &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   Niigata &lt;dbl&gt;, Toyama &lt;dbl&gt;, Ishikawa &lt;dbl&gt;, Fukui &lt;dbl&gt;, Yamanashi &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   Nagano &lt;dbl&gt;, Gifu &lt;dbl&gt;, Shizuoka &lt;dbl&gt;, Aichi &lt;dbl&gt;, Mie &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   Shiga &lt;dbl&gt;, Kyoto &lt;dbl&gt;, Osaka &lt;dbl&gt;, Hyogo &lt;dbl&gt;, Nara &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   Wakayama &lt;dbl&gt;, Tottori &lt;dbl&gt;, Shimane &lt;dbl&gt;, Okayama &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   Hiroshima &lt;dbl&gt;, Yamaguchi &lt;dbl&gt;, Tokushima &lt;dbl&gt;, Kagawa &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   Ehime &lt;dbl&gt;, Kochi &lt;dbl&gt;, Fukuoka &lt;dbl&gt;, Saga &lt;dbl&gt;, Nagasaki &lt;dbl&gt;, …</span></span></span></code></pre>
<p>The data are first differenced:</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">covid</span> <span class="op">=</span> <span class="va">covid</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                              \<span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Using Tokyo’s COVID-19 infection data to test the optimal embedding
dimension.</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tEDM</span><span class="fu">::</span><span class="fu"><a href="../reference/fnn.html">fnn</a></span><span class="op">(</span><span class="va">covid</span>,<span class="st">"Tokyo"</span>,E <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">30</span>,eps <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">covid</span><span class="op">$</span><span class="va">Tokyo</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##        E:1        E:2        E:3        E:4        E:5        E:6        E:7 </span></span>
<span><span class="co">## 0.82432432 0.43333333 0.14598540 0.07664234 0.06934307 0.05474453 0.03284672 </span></span>
<span><span class="co">##        E:8        E:9       E:10       E:11       E:12       E:13       E:14 </span></span>
<span><span class="co">## 0.01459854 0.01459854 0.00729927 0.00000000 0.00000000 0.00000000 0.00000000 </span></span>
<span><span class="co">##       E:15       E:16       E:17       E:18       E:19       E:20       E:21 </span></span>
<span><span class="co">## 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 </span></span>
<span><span class="co">##       E:22       E:23       E:24       E:25       E:26       E:27       E:28 </span></span>
<span><span class="co">## 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 </span></span>
<span><span class="co">##       E:29 </span></span>
<span><span class="co">## 0.00000000</span></span></code></pre>
<p>Since the FNN ratio begins to approach zero when E equals 11,
embedding dimensions from 11 onward are evaluated, and the pair of E and
k yielding the highest self-prediction accuracy is selected for the CCM
procedure.</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tEDM</span><span class="fu">::</span><span class="fu"><a href="../reference/simplex.html">simplex</a></span><span class="op">(</span><span class="va">covid</span>,<span class="st">"Tokyo"</span>,<span class="st">"Tokyo"</span>,E <span class="op">=</span> <span class="fl">11</span><span class="op">:</span><span class="fl">50</span>,k <span class="op">=</span> <span class="fl">15</span><span class="op">:</span><span class="fl">60</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## The suggested E and k for variable Tokyo is 11 and 16</span></span></code></pre>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">covid</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="st">"Tokyo"</span>,<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">covid</span><span class="op">)</span><span class="op">)</span><span class="op">]</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_dfr</a></span><span class="op">(</span>\<span class="op">(</span><span class="va">.l</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">g</span> <span class="op">=</span> <span class="fu">tEDM</span><span class="fu">::</span><span class="fu"><a href="../reference/ccm.html">ccm</a></span><span class="op">(</span><span class="va">covid</span>,<span class="st">"Tokyo"</span>,<span class="va">.l</span>,E <span class="op">=</span> <span class="fl">11</span>,k <span class="op">=</span> <span class="fl">16</span>,tau <span class="op">=</span> <span class="fl">0</span>,progressbar <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>    <span class="va">res</span> <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">g</span><span class="op">$</span><span class="va">xmap</span>,x <span class="op">=</span> <span class="st">"Tokyo"</span>,y <span class="op">=</span> <span class="va">.l</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   libsizes x_xmap_y_mean x_xmap_y_sig x_xmap_y_upper x_xmap_y_lower</span></span>
<span><span class="co">## 1      323     0.7194347 9.527435e-53     0.66230393      0.7682476</span></span>
<span><span class="co">## 2      323     0.2356305 1.879218e-05     0.12984019      0.3361165</span></span>
<span><span class="co">## 3      323     0.5676352 6.057533e-29     0.48878419      0.6372872</span></span>
<span><span class="co">## 4      323     0.6004427 5.029307e-33     0.52576481      0.6659358</span></span>
<span><span class="co">## 5      323     0.1912783 5.475818e-04     0.08390065      0.2942648</span></span>
<span><span class="co">## 6      323     0.7341790 6.346860e-56     0.67949098      0.7807538</span></span>
<span><span class="co">##   y_xmap_x_mean y_xmap_x_sig y_xmap_x_upper y_xmap_x_lower     x        y</span></span>
<span><span class="co">## 1     0.7813231 1.089493e-67      0.7348512      0.8204928 Tokyo Hokkaido</span></span>
<span><span class="co">## 2     0.5286610 1.185012e-24      0.4452176      0.6030015 Tokyo   Aomori</span></span>
<span><span class="co">## 3     0.7795907 3.314325e-67      0.7328059      0.8190392 Tokyo    Iwate</span></span>
<span><span class="co">## 4     0.7972467 2.392638e-72      0.7536909      0.8338302 Tokyo   Miyagi</span></span>
<span><span class="co">## 5     0.4590275 3.079043e-18      0.3683504      0.5410534 Tokyo    Akita</span></span>
<span><span class="co">## 6     0.5694476 3.704062e-29      0.4908197      0.6388748 Tokyo Yamagata</span></span></code></pre>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df1</span> <span class="op">=</span> <span class="va">res</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,<span class="va">y_xmap_x_mean</span>,<span class="va">y_xmap_x_sig</span><span class="op">)</span><span class="op">|&gt;</span></span>
<span>    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/set_names.html" class="external-link">set_names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cause"</span>,<span class="st">"effect"</span>,<span class="st">"cs"</span>,<span class="st">"sig"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df2</span> <span class="op">=</span> <span class="va">res</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">y</span>,<span class="va">x</span>,<span class="va">x_xmap_y_mean</span>,<span class="va">x_xmap_y_sig</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/set_names.html" class="external-link">set_names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cause"</span>,<span class="st">"effect"</span>,<span class="st">"cs"</span>,<span class="st">"sig"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">res_covid</span> <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">df1</span>,<span class="va">df2</span><span class="op">)</span><span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">cause</span> <span class="op">==</span> <span class="st">"Tokyo"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">cs</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res_covid</span>,<span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   cause   effect        cs           sig</span></span>
<span><span class="co">## 1 Tokyo Kanagawa 0.9337641 2.698678e-145</span></span>
<span><span class="co">## 2 Tokyo    Osaka 0.9277809 1.762531e-139</span></span>
<span><span class="co">## 3 Tokyo  Saitama 0.9247632 9.810852e-137</span></span>
<span><span class="co">## 4 Tokyo    Chiba 0.9174220 1.653727e-130</span></span>
<span><span class="co">## 5 Tokyo    Aichi 0.9153784 7.065131e-129</span></span></code></pre>
<p>Our CCM analysis reproduced the same results as the <a href="https://doi.org/10.1016/j.fmre.2023.01.007" class="external-link">original CMC
study</a>, with the top five prefectures most affected by Tokyo’s
COVID-19 spread matching those previously identified.</p>
<div class="float">
<img src="../reference/figures/edm/jp-covid19.png" alt="Figure 6. The five prefectures most affected by Tokyo, Kanagawa, Osaka, Saitama, Chiba, and Aichi, are located on the map. Red, blue and green dashed rings represent Tokyo, Nagoya and Osaka metropolitan areas, respectively. (Figure adapted from CMC article.)"><div class="figcaption">
<strong>Figure 6</strong>. The five prefectures
most affected by Tokyo, Kanagawa, Osaka, Saitama, Chiba, and Aichi, are
located on the map. Red, blue and green dashed rings represent Tokyo,
Nagoya and Osaka metropolitan areas, respectively. (<em>Figure adapted
from <a href="https://doi.org/10.1016/j.fmre.2023.01.007" class="external-link">CMC
article</a>.</em>)</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="reference">Reference<a class="anchor" aria-label="anchor" href="#reference"></a>
</h2>
<p>Sugihara, G., May, R., Ye, H., Hsieh, C., Deyle, E., Fogarty, M.,
Munch, S., 2012. Detecting Causality in Complex Ecosystems. Science 338,
496–500. <a href="https://doi.org/10.1126/science.1227079" class="external-link">https://doi.org/10.1126/science.1227079</a>.</p>
<p>Leng, S., Ma, H., Kurths, J., Lai, Y.-C., Lin, W., Aihara, K., Chen,
L., 2020. Partial cross mapping eliminates indirect causal influences.
Nature Communications 11. <a href="https://doi.org/10.1038/s41467-020-16238-0" class="external-link">https://doi.org/10.1038/s41467-020-16238-0</a>.</p>
<p>Tao, P., Wang, Q., Shi, J., Hao, X., Liu, X., Min, B., Zhang, Y., Li,
C., Cui, H., Chen, L., 2023. Detecting dynamical causality by
intersection cardinal concavity. Fundamental Research. <a href="https://doi.org/10.1016/j.fmre.2023.01.007" class="external-link">https://doi.org/10.1016/j.fmre.2023.01.007</a>.</p>
<p>Clark, A.T., Ye, H., Isbell, F., Deyle, E.R., Cowles, J., Tilman,
G.D., Sugihara, G., 2015. Spatial convergent cross mapping to detect
causal relationships from short time series. Ecology 96, 1174–1181. <a href="https://doi.org/10.1890/14-1479.1" class="external-link">https://doi.org/10.1890/14-1479.1</a>.</p>
<p>Gan, T., Succar, R., Macrì, S., Marín, M.R., Porfiri, M., 2025.
Causal discovery from city data, where urban scaling meets information
theory. Cities 162, 105980. <a href="https://doi.org/10.1016/j.cities.2025.105980" class="external-link">https://doi.org/10.1016/j.cities.2025.105980</a>.</p>
<p> </p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://spatlyu.github.io/" class="external-link">Wenbo Lv</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
