[{"path":"https://stscl.github.io/tEDM/articles/tEDM.html","id":"introduction-to-the-tedm-package","dir":"Articles","previous_headings":"","what":"1. Introduction to the tEDM package","title":"Temporal Empirical Dynamic Modeling","text":"tEDM package provides suite tools exploring quantifying causality time series using Empirical Dynamic Modeling (EDM). implements four fundamental EDM-based causal discovery methods: Convergent Cross Mapping (CCM) Partial Cross Mapping (PCM) Cross Mapping Cardinality (CMC) Multispatial Convergent Cross Mapping (MultispatialCCM) methods enable researchers : Identify potential causal interactions without assuming predefined model structure. Distinguish direct causation indirect (mediated confounded) influences. Reconstruct underlying causal dynamics replicated univariate time series observed across multiple spatial units.","code":""},{"path":[]},{"path":"https://stscl.github.io/tEDM/articles/tEDM.html","id":"hong-kong-air-pollution-and-cardiovascular-admissions","dir":"Articles","previous_headings":"2. Example data in the tEDM package","what":"Hong Kong Air Pollution and Cardiovascular Admissions","title":"Temporal Empirical Dynamic Modeling","text":"daily time series dataset(1995-3 1997-11) Hong Kong includes cardiovascular hospital admissions major air pollutant concentrations. File: cvd.csv Columns: Source: Data adapted PCM article.","code":""},{"path":"https://stscl.github.io/tEDM/articles/tEDM.html","id":"us-county-level-carbon-emissions-dataset","dir":"Articles","previous_headings":"2. Example data in the tEDM package","what":"US County-Level Carbon Emissions Dataset","title":"Temporal Empirical Dynamic Modeling","text":"panel dataset covering U.S. county-level temperature carbon emissions across time. File: carbon.csv.gz Columns: Source: Data adapted FsATE article.","code":""},{"path":"https://stscl.github.io/tEDM/articles/tEDM.html","id":"covid-19-infection-counts-in-japan","dir":"Articles","previous_headings":"2. Example data in the tEDM package","what":"COVID-19 Infection Counts in Japan","title":"Temporal Empirical Dynamic Modeling","text":"spatio-temporal dataset capturing number confirmed COVID-19 infections across Japan’s 47 prefectures time. File: covid.csv Structure: column represents one 47 Japanese prefectures (e.g., Tokyo, Osaka, Hokkaido). row corresponds time step (daily). Source: Data adapted CMC article.","code":""},{"path":"https://stscl.github.io/tEDM/articles/tEDM.html","id":"case-studies-of-the-tedm-package","dir":"Articles","previous_headings":"","what":"3. Case studies of the tEDM package","title":"Temporal Empirical Dynamic Modeling","text":"Install stable version: dev version:","code":"install.packages(\"tEDM\", dep = TRUE) install.packages(\"tEDM\",                  repos = c(\"https://stscl.r-universe.dev\",                            \"https://cloud.r-project.org\"),                  dep = TRUE)"},{"path":"https://stscl.github.io/tEDM/articles/tEDM.html","id":"air-pollution-and-cardiovascular-health-in-hong-kong","dir":"Articles","previous_headings":"3. Case studies of the tEDM package","what":"Air Pollution and Cardiovascular Health in Hong Kong","title":"Temporal Empirical Dynamic Modeling","text":"Employing CCM, CMC PCM investigate causal relationships various air pollutants cardiovascular diseases: Figure 1. Time series air pollutants confirmed CVD cases Hong Kong March 1995 November 1997. Determining optimal embedding dimension: Starting \\(E = 5\\), FNN ratio stabilizes near 0.2; thus, embedding dimension E neighbor number k chosen 5 onward subsequent self-prediction parameter selection. first use CCM explore causal influences air pollutants incidence cardiovascular diseases. Figure 2. Cross-mapping results different air pollutants cardiovascular diseases. results shown Figure2 indicate presence following causal influences: rsp → cvd ₂ → cvd cvd → ₂ cvd → o₃ However, based practical experience, relationship CVDs spatial pollution likely reflective rather causal. Therefore, employ CCM examine causal paths cvd → ₂ cvd → o₃. causal paths cvd → ₂ cvd → o₃ statistically significant CMC analysis results, allowing us rule two directions. Therefore, conclude rsp ₂ exhibit causal influences CVDs. aim explore potential causal interactions among different air pollutants. However, due space constraints vignette, limit analysis single test case — specifically, examining whether ₂ exerts causal influence Respirable Suspended Particulates (rsp). Figure 3. Cross-mapping results ₂ respirable suspended particulates. . CCM results without accounting variables. b. PCM results controlling influence CVDs. CCM PCM results ₂ respirable suspended particulates show minimal differences statistically significant, indicating presence causal relationship two. Therefore, final set confirmed causal pathways follows (exclude causal influence CVDs):","code":"library(tEDM)  cvd = readr::read_csv(system.file(\"case/cvd.csv\",package = \"tEDM\")) ## Rows: 1032 Columns: 5 ## ── Column specification ──────────────────────────────────────────────────────── ## Delimiter: \",\" ## dbl (5): cvd, rsp, no2, so2, o3 ##  ## ℹ Use `spec()` to retrieve the full column specification for this data. ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message. head(cvd) ## # A tibble: 6 × 5 ##     cvd   rsp   no2   so2    o3 ##   <dbl> <dbl> <dbl> <dbl> <dbl> ## 1   214  73.7  74.5  19.1 17.4  ## 2   203  77.6  80.9  18.8 39.4  ## 3   202  64.8  67.1  13.8 56.4  ## 4   182  68.8  74.7  30.8  5.6  ## 5   181  49.4  62.3  23.1  3.6  ## 6   129  67.4  63.6  17.4  6.73 cvd_long = cvd |>    tibble::rowid_to_column(\"id\") |>    tidyr::pivot_longer(cols = -id,                       names_to = \"variable\", values_to = \"value\")  fig1 = ggplot2::ggplot(cvd_long, ggplot2::aes(x = id, y = value, color = variable)) +   ggplot2::geom_line(linewidth = 1) +   ggplot2::labs(x = \"Days (from 1995-3 to 1997-11)\", y = \"Concentrations or \\nNO. of CVD admissions\", color = \"\") +   ggplot2::theme_bw() +   ggplot2::theme(legend.direction = \"horizontal\",                  legend.position = \"inside\",                  legend.justification = c(\"center\",\"top\"),                  legend.background = ggplot2::element_rect(fill = \"transparent\", color = NA)) fig1 tEDM::fnn(cvd,\"cvd\",E = 2:50,eps = stats::sd(cvd$cvd)) ##       E:1       E:2       E:3       E:4       E:5       E:6       E:7       E:8  ## 0.4827586 0.5611765 0.3894850 0.3004292 0.2682403 0.2564378 0.2607296 0.2671674  ##       E:9      E:10      E:11      E:12      E:13      E:14      E:15      E:16  ## 0.2639485 0.2607296 0.2521459 0.2682403 0.2467811 0.2457082 0.2392704 0.2242489  ##      E:17      E:18      E:19      E:20      E:21      E:22      E:23      E:24  ## 0.2306867 0.2371245 0.2435622 0.2414163 0.2317597 0.2242489 0.2199571 0.2296137  ##      E:25      E:26      E:27      E:28      E:29      E:30      E:31      E:32  ## 0.2253219 0.2242489 0.2285408 0.2435622 0.2339056 0.2306867 0.2242489 0.2360515  ##      E:33      E:34      E:35      E:36      E:37      E:38      E:39      E:40  ## 0.2510730 0.2532189 0.2553648 0.2532189 0.2500000 0.2521459 0.2564378 0.2457082  ##      E:41      E:42      E:43      E:44      E:45      E:46      E:47      E:48  ## 0.2478541 0.2414163 0.2435622 0.2478541 0.2489270 0.2585837 0.2671674 0.2553648  ##      E:49  ## 0.2585837 tEDM::simplex(cvd,\"cvd\",\"cvd\",E = 5:25,k = 6:35) ## The suggested E and k for variable cvd is 5 and 6 tEDM::simplex(cvd,\"rsp\",\"rsp\",E = 5:25,k = 6:35) ## The suggested E and k for variable rsp is 5 and 6 tEDM::simplex(cvd,\"no2\",\"no2\",E = 5:25,k = 6:35) ## The suggested E and k for variable no2 is 5 and 8 tEDM::simplex(cvd,\"so2\",\"so2\",E = 5:25,k = 6:35) ## The suggested E and k for variable so2 is 5 and 15 tEDM::simplex(cvd,\"o3\",\"o3\",E = 5:25,k = 6:35) ## The suggested E and k for variable o3 is 5 and 6 rsp_cvd = tEDM::ccm(cvd,\"rsp\",\"cvd\",libsizes = seq(32,1032,100),E = 5,k = 6,progressbar = FALSE) rsp_cvd ##    libsizes   rsp->cvd   cvd->rsp ## 1        32 0.04319516 0.01319450 ## 2       132 0.04437840 0.04042972 ## 3       232 0.05755968 0.04856251 ## 4       332 0.05213455 0.05497566 ## 5       432 0.04204529 0.05345864 ## 6       532 0.03869321 0.05163371 ## 7       632 0.03449846 0.05149252 ## 8       732 0.02813186 0.05075322 ## 9       832 0.02364578 0.05075094 ## 10      932 0.02226927 0.05080212 ## 11     1027 0.07212221 0.05626339 no2_cvd = tEDM::ccm(cvd,\"no2\",\"cvd\",libsizes = seq(32,1032,100),E = 5,k = c(8,6),progressbar = FALSE) no2_cvd ##    libsizes   no2->cvd   cvd->no2 ## 1        32 0.09597753 0.04864942 ## 2       132 0.12416134 0.09638212 ## 3       232 0.15621628 0.11924223 ## 4       332 0.16302570 0.12659628 ## 5       432 0.15722930 0.12724020 ## 6       532 0.15592151 0.12779650 ## 7       632 0.15271207 0.12670729 ## 8       732 0.14752161 0.12305037 ## 9       832 0.14525414 0.12052819 ## 10      932 0.14519559 0.11924900 ## 11     1027 0.23186797 0.17037681 so2_cvd = tEDM::ccm(cvd,\"so2\",\"cvd\",libsizes = seq(32,1032,100),E = 5,k = c(15,6),progressbar = FALSE) so2_cvd ##    libsizes    so2->cvd   cvd->so2 ## 1        32 0.038665119 0.03405003 ## 2       132 0.023943075 0.06258078 ## 3       232 0.020748020 0.07086180 ## 4       332 0.019672824 0.07066856 ## 5       432 0.017233107 0.07339913 ## 6       532 0.016922496 0.07205969 ## 7       632 0.014945947 0.07428336 ## 8       732 0.011701558 0.07877438 ## 9       832 0.009729901 0.08091936 ## 10      932 0.009048317 0.08116150 ## 11     1027 0.011257499 0.07416282 o3_cvd = tEDM::ccm(cvd,\"o3\",\"cvd\",libsizes = seq(32,1032,100),E = 5,k = 6,progressbar = FALSE) o3_cvd ##    libsizes       o3->cvd    cvd->o3 ## 1        32 -0.0021382170 0.02675574 ## 2       132 -0.0028994401 0.03818003 ## 3       232  0.0015246470 0.04784981 ## 4       332  0.0047085847 0.04764828 ## 5       432  0.0030374107 0.04542627 ## 6       532  0.0020648753 0.04110124 ## 7       632  0.0009115659 0.03699687 ## 8       732 -0.0017126973 0.03108036 ## 9       832 -0.0011312952 0.02697292 ## 10      932  0.0004006101 0.02451813 ## 11     1027  0.0480365415 0.06844222 figa = plot(rsp_cvd,ylimits = c(-0.01,0.1),ybreaks = c(0,0.05,0.1)) figb = plot(no2_cvd,ylimits = c(0.03,0.25),ybreaks = seq(0.05,0.25,0.05)) figc = plot(so2_cvd,ylimits = c(-0.01,0.1),ybreaks = c(0,0.05,0.1)) figd = plot(o3_cvd,ylimits = c(-0.01,0.1),ybreaks = c(0,0.05,0.1))  fig2 = cowplot::plot_grid(figa, figb, figc, figd, ncol = 2,                          label_fontfamily = 'serif',                          labels = letters[1:4]) fig2 g1 = tEDM::cmc(cvd,\"o3\",\"cvd\",E = 5,k = 100,progressbar = FALSE) g1 ##   neighbors o3->cvd cvd->o3 ## 1       100  0.2344  0.5589 g1$xmap ##   neighbors x_xmap_y_mean x_xmap_y_sig x_xmap_y_upper x_xmap_y_lower ## 1       100        0.5589     0.188823      0.6467507      0.4710493 ##   y_xmap_x_mean y_xmap_x_sig y_xmap_x_upper y_xmap_x_lower ## 1        0.2344 2.138197e-12      0.3085003      0.1602997 g2 = tEDM::cmc(cvd,\"no2\",\"cvd\",E = 5,k = 100,progressbar = FALSE) g2 ##   neighbors no2->cvd cvd->no2 ## 1       100   0.4833   0.5363 g2$xmap ##   neighbors x_xmap_y_mean x_xmap_y_sig x_xmap_y_upper x_xmap_y_lower ## 1       100        0.5363    0.4205595      0.6246315      0.4479685 ##   y_xmap_x_mean y_xmap_x_sig y_xmap_x_upper y_xmap_x_lower ## 1        0.4833    0.7186329      0.5741482      0.3924518 no2_rsp = tEDM::pcm(cvd,\"no2\",\"rsp\",\"cvd\",libsizes = seq(32,1032,100),E = 5,k = c(8,6,6),progressbar = FALSE) no2_rsp ## --------------------------------------  ## ***partial cross mapping prediction***  ## --------------------------------------  ##    libsizes  no2->rsp  rsp->no2 ## 1        32 0.5718384 0.5872235 ## 2       132 0.6926588 0.6891724 ## 3       232 0.7129181 0.6999073 ## 4       332 0.7251034 0.7065649 ## 5       432 0.7292544 0.7132728 ## 6       532 0.7305393 0.7175689 ## 7       632 0.7308904 0.7208970 ## 8       732 0.7322006 0.7239768 ## 9       832 0.7335073 0.7282566 ## 10      932 0.7338654 0.7295781 ## 11     1027 0.7362657 0.7246647 ##  ## ------------------------------  ## ***cross mapping prediction***  ## ------------------------------  ##    libsizes  no2->rsp  rsp->no2 ## 1        32 0.5891342 0.6095253 ## 2       132 0.7085988 0.7137024 ## 3       232 0.7235291 0.7327955 ## 4       332 0.7325251 0.7409321 ## 5       432 0.7368667 0.7435845 ## 6       532 0.7382566 0.7454804 ## 7       632 0.7389185 0.7473104 ## 8       732 0.7397101 0.7479086 ## 9       832 0.7399319 0.7481982 ## 10      932 0.7399475 0.7481772 ## 11     1027 0.7623938 0.7574991 figa = plot(no2_rsp,partial = FALSE,ylimits = c(0.5,0.85),ybreaks = seq(0.5,0.85,0.05)) figb = plot(no2_rsp,ylimits = c(0.5,0.85),ybreaks = seq(0.5,0.85,0.05))  fig3 = cowplot::plot_grid(figa, figb, ncol = 2,                           label_fontfamily = 'serif',                           labels = letters[1:2]) fig3"},{"path":"https://stscl.github.io/tEDM/articles/tEDM.html","id":"us-county-carbon-emissions-and-temperature-dynamics","dir":"Articles","previous_headings":"3. Case studies of the tEDM package","what":"US County Carbon Emissions and Temperature Dynamics","title":"Temporal Empirical Dynamic Modeling","text":"examine whether causal relationship exists annual mean temperature total annual CO₂ emissions, implement CMC method across counties. Using 100th county example, determine appropriate embedding dimension applying FNN method. E equals 6, FNN ratio begins drop zero; therefore, select \\(E = 6\\) embedding dimension CMC analysis. Figure 5. Causal strength scores annual mean temperature total annual CO₂ emissions across US counties, embedding dimension E set 6 number neighbors set 20.","code":"library(tEDM)  carbon = readr::read_csv(system.file(\"case/carbon.csv.gz\",package = \"tEDM\")) ## Rows: 113627 Columns: 4 ## ── Column specification ──────────────────────────────────────────────────────── ## Delimiter: \",\" ## dbl (4): year, fips, tem, carbon ##  ## ℹ Use `spec()` to retrieve the full column specification for this data. ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message. head(carbon) ## # A tibble: 6 × 4 ##    year  fips   tem     carbon ##   <dbl> <dbl> <dbl>      <dbl> ## 1  1981  1001  17.4 192607687. ## 2  1982  1001  18.4 187149414. ## 3  1983  1001  16.9 191584445. ## 4  1984  1001  17.8 199157579. ## 5  1985  1001  17.9 205207564. ## 6  1986  1001  18.5 218446030. carbon_list = dplyr::group_split(carbon, by = fips) length(carbon_list) ## [1] 3071 tEDM::fnn(carbon_list[[100]],\"carbon\",E = 2:10,eps = stats::sd(carbon_list[[100]]$carbon)) ##        E:1        E:2        E:3        E:4        E:5        E:6        E:7  ## 0.58823529 0.23529412 0.23529412 0.17647059 0.05882353 0.00000000 0.00000000  ##        E:8        E:9  ## 0.00000000 0.00000000 res = carbon_list |>    purrr::map_dfr(\\(.x) {     g = tEDM::cmc(.x,\"tem\",\"carbon\",E = 6,k = 20,progressbar = FALSE)     return(g$xmap)   }) head(res) ##   neighbors x_xmap_y_mean x_xmap_y_sig x_xmap_y_upper x_xmap_y_lower ## 1        20       0.23000 7.559829e-04      0.3871031     0.07289694 ## 2        20       0.15250 5.155608e-08      0.2775652     0.02743478 ## 3        20       0.15125 3.546400e-08      0.2752574     0.02724258 ## 4        20       0.14125 1.237298e-08      0.2647264     0.01777360 ## 5        20       0.14625 2.766598e-08      0.2710497     0.02145029 ## 6        20       0.13625 9.223181e-09      0.2603593     0.01214072 ##   y_xmap_x_mean y_xmap_x_sig y_xmap_x_upper y_xmap_x_lower ## 1       0.03875 2.661759e-41      0.1059107              0 ## 2       0.04250 3.673257e-37      0.1128988              0 ## 3       0.04375 2.129338e-31      0.1204663              0 ## 4       0.04375 2.129338e-31      0.1204663              0 ## 5       0.04500 1.570561e-32      0.1200890              0 ## 6       0.03750 2.118657e-39      0.1065211              0 res_carbon = res |>    dplyr::select(neighbors,                 carbon_tem = x_xmap_y_mean,                 tem_carbon = y_xmap_x_mean) |>    tidyr::pivot_longer(c(carbon_tem, tem_carbon),                        names_to = \"variable\", values_to = \"value\") head(res_carbon) ## # A tibble: 6 × 3 ##   neighbors variable    value ##       <dbl> <chr>       <dbl> ## 1        20 carbon_tem 0.23   ## 2        20 tem_carbon 0.0388 ## 3        20 carbon_tem 0.152  ## 4        20 tem_carbon 0.0425 ## 5        20 carbon_tem 0.151  ## 6        20 tem_carbon 0.0438 fig_case2 = ggplot2::ggplot(res_carbon,                              ggplot2::aes(x = variable, y = value, fill = variable)) +   ggplot2::geom_boxplot() +   ggplot2::theme_bw() +   ggplot2::labs(x = \"\", y = \"Causal Strength\") +   ggplot2::scale_x_discrete(labels = c(\"carbon_tem\" = \"carbon → tem\",                                        \"tem_carbon\" = \"tem → carbon\")) +   ggplot2::theme(legend.position = \"none\") fig_case2"},{"path":"https://stscl.github.io/tEDM/articles/tEDM.html","id":"covid-19-spread-across-japanese-prefectures","dir":"Articles","previous_headings":"3. Case studies of the tEDM package","what":"COVID-19 Spread Across Japanese Prefectures","title":"Temporal Empirical Dynamic Modeling","text":"examine COVID-19 transmission Tokyo prefectures applying CCM identify underlying causal dynamics epidemic spread data first differenced: Using Tokyo’s COVID-19 infection data test optimal embedding dimension. Since FNN ratio begins approach zero E equals 11, embedding dimensions 11 onward evaluated, pair E k yielding highest self-prediction accuracy selected CCM procedure. CCM analysis reproduced results original CMC study, top five prefectures affected Tokyo’s COVID-19 spread matching previously identified.","code":"library(tEDM)  covid = readr::read_csv(system.file(\"case/covid.csv\",package = \"tEDM\")) ## Rows: 334 Columns: 47 ## ── Column specification ──────────────────────────────────────────────────────── ## Delimiter: \",\" ## dbl (47): Hokkaido, Aomori, Iwate, Miyagi, Akita, Yamagata, Fukushima, Ibara... ##  ## ℹ Use `spec()` to retrieve the full column specification for this data. ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message. head(covid) ## # A tibble: 6 × 47 ##   Hokkaido Aomori Iwate Miyagi Akita Yamagata Fukushima Ibaraki Tochigi Gunma ##      <dbl>  <dbl> <dbl>  <dbl> <dbl>    <dbl>     <dbl>   <dbl>   <dbl> <dbl> ## 1        0      0     0      0     0        0         0       0       0     0 ## 2        0      0     0      0     0        0         0       0       0     0 ## 3        0      0     0      0     0        0         0       0       0     0 ## 4        0      0     0      0     0        0         0       0       0     0 ## 5        0      0     0      0     0        0         0       0       0     0 ## 6        0      0     0      0     0        0         0       0       0     0 ## # ℹ 37 more variables: Saitama <dbl>, Chiba <dbl>, Tokyo <dbl>, Kanagawa <dbl>, ## #   Niigata <dbl>, Toyama <dbl>, Ishikawa <dbl>, Fukui <dbl>, Yamanashi <dbl>, ## #   Nagano <dbl>, Gifu <dbl>, Shizuoka <dbl>, Aichi <dbl>, Mie <dbl>, ## #   Shiga <dbl>, Kyoto <dbl>, Osaka <dbl>, Hyogo <dbl>, Nara <dbl>, ## #   Wakayama <dbl>, Tottori <dbl>, Shimane <dbl>, Okayama <dbl>, ## #   Hiroshima <dbl>, Yamaguchi <dbl>, Tokushima <dbl>, Kagawa <dbl>, ## #   Ehime <dbl>, Kochi <dbl>, Fukuoka <dbl>, Saga <dbl>, Nagasaki <dbl>, … covid = covid |>    dplyr::mutate(dplyr::across(dplyr::everything(),                               \\(.x) c(NA,diff(.x)))) tEDM::fnn(covid,\"Tokyo\",E = 2:30,eps = stats::sd(covid$Tokyo)) ##        E:1        E:2        E:3        E:4        E:5        E:6        E:7  ## 0.82432432 0.43333333 0.14598540 0.07664234 0.06934307 0.05474453 0.03284672  ##        E:8        E:9       E:10       E:11       E:12       E:13       E:14  ## 0.01459854 0.01459854 0.00729927 0.00000000 0.00000000 0.00000000 0.00000000  ##       E:15       E:16       E:17       E:18       E:19       E:20       E:21  ## 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000  ##       E:22       E:23       E:24       E:25       E:26       E:27       E:28  ## 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000  ##       E:29  ## 0.00000000 tEDM::simplex(covid,\"Tokyo\",\"Tokyo\",E = 11:50,k = 15:60) ## The suggested E and k for variable Tokyo is 11 and 16 res = names(covid)[-match(\"Tokyo\",names(covid))] |>    purrr::map_dfr(\\(.l) {     g = tEDM::ccm(covid,\"Tokyo\",.l,E = 11,k = 16,tau = 0,progressbar = FALSE)     res = dplyr::mutate(g$xmap,x = \"Tokyo\",y = .l)     return(res)   }) head(res) ##   libsizes x_xmap_y_mean x_xmap_y_sig x_xmap_y_upper x_xmap_y_lower ## 1      323     0.7194347 9.527435e-53     0.66230393      0.7682476 ## 2      323     0.2356305 1.879218e-05     0.12984019      0.3361165 ## 3      323     0.5676352 6.057533e-29     0.48878419      0.6372872 ## 4      323     0.6004427 5.029307e-33     0.52576481      0.6659358 ## 5      323     0.1912783 5.475818e-04     0.08390065      0.2942648 ## 6      323     0.7341790 6.346860e-56     0.67949098      0.7807538 ##   y_xmap_x_mean y_xmap_x_sig y_xmap_x_upper y_xmap_x_lower     x        y ## 1     0.7813231 1.089493e-67      0.7348512      0.8204928 Tokyo Hokkaido ## 2     0.5286610 1.185012e-24      0.4452176      0.6030015 Tokyo   Aomori ## 3     0.7795907 3.314325e-67      0.7328059      0.8190392 Tokyo    Iwate ## 4     0.7972467 2.392638e-72      0.7536909      0.8338302 Tokyo   Miyagi ## 5     0.4590275 3.079043e-18      0.3683504      0.5410534 Tokyo    Akita ## 6     0.5694476 3.704062e-29      0.4908197      0.6388748 Tokyo Yamagata df1 = res |>     dplyr::select(x,y,y_xmap_x_mean,y_xmap_x_sig)|>     purrr::set_names(c(\"cause\",\"effect\",\"cs\",\"sig\")) df2 = res |>     dplyr::select(y,x,x_xmap_y_mean,x_xmap_y_sig) |>     purrr::set_names(c(\"cause\",\"effect\",\"cs\",\"sig\")) res_covid = dplyr::bind_rows(df1,df2)|>    dplyr::filter(cause == \"Tokyo\") |>    dplyr::arrange(dplyr::desc(cs)) head(res_covid,5) ##   cause   effect        cs           sig ## 1 Tokyo Kanagawa 0.9337641 2.698678e-145 ## 2 Tokyo    Osaka 0.9277809 1.762531e-139 ## 3 Tokyo  Saitama 0.9247632 9.810852e-137 ## 4 Tokyo    Chiba 0.9174220 1.653727e-130 ## 5 Tokyo    Aichi 0.9153784 7.065131e-129"},{"path":"https://stscl.github.io/tEDM/articles/tEDM.html","id":"reference","dir":"Articles","previous_headings":"","what":"Reference","title":"Temporal Empirical Dynamic Modeling","text":"Sugihara, G., May, R., Ye, H., Hsieh, C., Deyle, E., Fogarty, M., Munch, S., 2012. Detecting Causality Complex Ecosystems. Science 338, 496–500. https://doi.org/10.1126/science.1227079. Leng, S., Ma, H., Kurths, J., Lai, Y.-C., Lin, W., Aihara, K., Chen, L., 2020. Partial cross mapping eliminates indirect causal influences. Nature Communications 11. https://doi.org/10.1038/s41467-020-16238-0. Tao, P., Wang, Q., Shi, J., Hao, X., Liu, X., Min, B., Zhang, Y., Li, C., Cui, H., Chen, L., 2023. Detecting dynamical causality intersection cardinal concavity. Fundamental Research. https://doi.org/10.1016/j.fmre.2023.01.007. Clark, .T., Ye, H., Isbell, F., Deyle, E.R., Cowles, J., Tilman, G.D., Sugihara, G., 2015. Spatial convergent cross mapping detect causal relationships short time series. Ecology 96, 1174–1181. https://doi.org/10.1890/14-1479.1. Gan, T., Succar, R., Macrì, S., Marín, M.R., Porfiri, M., 2025. Causal discovery city data, urban scaling meets information theory. Cities 162, 105980. https://doi.org/10.1016/j.cities.2025.105980.  ","code":""},{"path":"https://stscl.github.io/tEDM/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Wenbo Lv. Author, maintainer, copyright holder.","code":""},{"path":"https://stscl.github.io/tEDM/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Lv W (2025). tEDM: Temporal Empirical Dynamic Modeling. R package version 1.0, https://stscl.github.io/tEDM/.","code":"@Manual{,   title = {tEDM: Temporal Empirical Dynamic Modeling},   author = {Wenbo Lv},   year = {2025},   note = {R package version 1.0},   url = {https://stscl.github.io/tEDM/}, }"},{"path":"https://stscl.github.io/tEDM/index.html","id":"tedm-","dir":"","previous_headings":"","what":"tEDM | Temporal Empirical Dynamic Modeling\n","title":"tEDM | Temporal Empirical Dynamic Modeling\n","text":"Temporal Empirical Dynamic Modeling","code":""},{"path":"https://stscl.github.io/tEDM/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"tEDM | Temporal Empirical Dynamic Modeling\n","text":"tEDM package provides suite tools exploring quantifying causality time series using Empirical Dynamic Modeling (EDM). particularly designed detect, differentiate, reconstruct causal dynamics systems traditional assumptions linearity stationarity may hold. package implements four fundamental EDM-based methods: Convergent Cross Mapping (CCM) – detecting nonlinear causal relationships time series. Partial Cross Mapping (PCM) – disentangling direct indirect causal influences. Cross Mapping Cardinality (CMC) – identifying time-varying state-dependent causal linkages. Multispatial Convergent Cross Mapping (MultispatialCCM) – reconstructing causal dynamics replicated time series across multiple spatial locations.","code":""},{"path":"https://stscl.github.io/tEDM/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"tEDM | Temporal Empirical Dynamic Modeling\n","text":"Install CRAN : Install binary version R-universe : Install source code GitHub :","code":"install.packages(\"tEDM\", dep = TRUE) install.packages(\"tEDM\",                  repos = c(\"https://stscl.r-universe.dev\",                            \"https://cloud.r-project.org\"),                  dep = TRUE) if (!requireNamespace(\"devtools\")) {     install.packages(\"devtools\") } devtools::install_github(\"stscl/tEDM\",                          #build_vignettes = TRUE,                          dep = TRUE)"},{"path":"https://stscl.github.io/tEDM/index.html","id":"reference","dir":"","previous_headings":"","what":"Reference","title":"tEDM | Temporal Empirical Dynamic Modeling\n","text":"Sugihara, G., May, R., Ye, H., Hsieh, C., Deyle, E., Fogarty, M., Munch, S., 2012. Detecting Causality Complex Ecosystems. Science 338, 496–500. https://doi.org/10.1126/science.1227079. Leng, S., Ma, H., Kurths, J., Lai, Y.-C., Lin, W., Aihara, K., Chen, L., 2020. Partial cross mapping eliminates indirect causal influences. Nature Communications 11. https://doi.org/10.1038/s41467-020-16238-0. Tao, P., Wang, Q., Shi, J., Hao, X., Liu, X., Min, B., Zhang, Y., Li, C., Cui, H., Chen, L., 2023. Detecting dynamical causality intersection cardinal concavity. Fundamental Research. https://doi.org/10.1016/j.fmre.2023.01.007. Clark, .T., Ye, H., Isbell, F., Deyle, E.R., Cowles, J., Tilman, G.D., Sugihara, G., 2015. Spatial convergent cross mapping detect causal relationships short time series. Ecology 96, 1174–1181. https://doi.org/10.1890/14-1479.1.  ","code":""},{"path":"https://stscl.github.io/tEDM/reference/ccm.html","id":null,"dir":"Reference","previous_headings":"","what":"convergent cross mapping — ccm","title":"convergent cross mapping — ccm","text":"convergent cross mapping","code":""},{"path":"https://stscl.github.io/tEDM/reference/ccm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"convergent cross mapping — ccm","text":"","code":"# S4 method for class 'data.frame' ccm(   data,   cause,   effect,   libsizes = NULL,   E = 3,   tau = 0,   k = E + 1,   theta = 1,   algorithm = \"simplex\",   lib = NULL,   pred = NULL,   threads = length(libsizes),   parallel.level = \"low\",   bidirectional = TRUE,   progressbar = TRUE )"},{"path":"https://stscl.github.io/tEDM/reference/ccm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"convergent cross mapping — ccm","text":"data observation data. cause name causal variable. effect name effect variable. libsizes (optional) number time points used. E (optional) embedding dimensions. tau (optional) step time lags. k (optional) number nearest neighbors. theta (optional) weighting parameter distances, useful algorithm smap. algorithm (optional) prediction algorithm. lib (optional) libraries indices. pred (optional) predictions indices. threads (optional) number threads use. parallel.level (optional) level parallelism, low high. bidirectional (optional) whether examine bidirectional causality. progressbar (optional) whether show progress bar.","code":""},{"path":"https://stscl.github.io/tEDM/reference/ccm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"convergent cross mapping — ccm","text":"list xmap cross mapping results varname names causal effect variable bidirectional whether examine bidirectional causality","code":""},{"path":"https://stscl.github.io/tEDM/reference/ccm.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"convergent cross mapping — ccm","text":"Sugihara, G., May, R., Ye, H., Hsieh, C., Deyle, E., Fogarty, M., Munch, S., 2012. Detecting Causality Complex Ecosystems. Science 338, 496–500.","code":""},{"path":"https://stscl.github.io/tEDM/reference/ccm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"convergent cross mapping — ccm","text":"","code":"sim = logistic_map(x = 0.4,y = 0.4,step = 45,beta_xy = 0.5,beta_yx = 0) ccm(sim,\"x\",\"y\",libsizes = seq(5,35,5),E = 8,k = 7,threads = 1) #>  Computing: [========================================] 100% (done)                          #>  Computing: [========================================] 100% (done)                          #>   libsizes      x->y      y->x #> 1        5 0.6658725 0.4459743 #> 2       10 0.7903164 0.5440701 #> 3       15 0.8073800 0.5425474 #> 4       20 0.8056960 0.5364679 #> 5       25 0.8020987 0.5307466 #> 6       30 0.7983809 0.5253733 #> 7       35 0.7965829 0.5258838"},{"path":"https://stscl.github.io/tEDM/reference/cmc.html","id":null,"dir":"Reference","previous_headings":"","what":"cross mapping cardinality — cmc","title":"cross mapping cardinality — cmc","text":"cross mapping cardinality","code":""},{"path":"https://stscl.github.io/tEDM/reference/cmc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"cross mapping cardinality — cmc","text":"","code":"# S4 method for class 'data.frame' cmc(   data,   cause,   effect,   libsizes = NULL,   E = 3,   tau = 0,   k = pmin(E^2),   lib = NULL,   pred = NULL,   threads = length(libsizes),   parallel.level = \"low\",   bidirectional = TRUE,   progressbar = TRUE )"},{"path":"https://stscl.github.io/tEDM/reference/cmc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"cross mapping cardinality — cmc","text":"data observation data. cause name causal variable. effect name effect variable. libsizes (optional) number time points used. E (optional) embedding dimensions. tau (optional) step time lags. k (optional) number nearest neighbors. lib (optional) libraries indices. pred (optional) predictions indices. threads (optional) number threads use. parallel.level (optional) level parallelism, low high. bidirectional (optional) whether examine bidirectional causality. progressbar (optional) whether show progress bar.","code":""},{"path":"https://stscl.github.io/tEDM/reference/cmc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"cross mapping cardinality — cmc","text":"list xmap cross mapping results cs causal strength varname names causal effect variable bidirectional whether examine bidirectional causality","code":""},{"path":"https://stscl.github.io/tEDM/reference/cmc.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"cross mapping cardinality — cmc","text":"Tao, P., Wang, Q., Shi, J., Hao, X., Liu, X., Min, B., Zhang, Y., Li, C., Cui, H., Chen, L., 2023. Detecting dynamical causality intersection cardinal concavity. Fundamental Research.","code":""},{"path":"https://stscl.github.io/tEDM/reference/cmc.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"cross mapping cardinality — cmc","text":"","code":"sim = logistic_map(x = 0.4,y = 0.4,step = 45,beta_xy = 0.5,beta_yx = 0) cmc(sim,\"x\",\"y\",E = 9,k = 15,threads = 1) #>  Computing: [========================================] 100% (done)                          #>  Computing: [========================================] 100% (done)                          #>   neighbors x->y       y->x #> 1        15 0.16 0.07555556"},{"path":"https://stscl.github.io/tEDM/reference/embedded.html","id":null,"dir":"Reference","previous_headings":"","what":"embedding time series data — embedded","title":"embedding time series data — embedded","text":"embedding time series data","code":""},{"path":"https://stscl.github.io/tEDM/reference/embedded.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"embedding time series data — embedded","text":"","code":"# S4 method for class 'data.frame' embedded(data, target, E = 3, tau = 0)"},{"path":"https://stscl.github.io/tEDM/reference/embedded.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"embedding time series data — embedded","text":"data observation data. target name target variable. E (optional) embedding dimensions. tau (optional) step time lags.","code":""},{"path":"https://stscl.github.io/tEDM/reference/embedded.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"embedding time series data — embedded","text":"matrix","code":""},{"path":"https://stscl.github.io/tEDM/reference/embedded.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"embedding time series data — embedded","text":"","code":"embedded(data.frame(t = 1:5),\"t\",3) #>      [,1] [,2] [,3] #> [1,]    1  NaN  NaN #> [2,]    2    1  NaN #> [3,]    3    2    1 #> [4,]    4    3    2 #> [5,]    5    4    3"},{"path":"https://stscl.github.io/tEDM/reference/fnn.html","id":null,"dir":"Reference","previous_headings":"","what":"false nearest neighbours — fnn","title":"false nearest neighbours — fnn","text":"false nearest neighbours","code":""},{"path":"https://stscl.github.io/tEDM/reference/fnn.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"false nearest neighbours — fnn","text":"","code":"# S4 method for class 'data.frame' fnn(   data,   target,   lib = NULL,   pred = NULL,   E = 2:10,   tau = 0,   rt = 10,   eps = 2,   threads = length(E) )"},{"path":"https://stscl.github.io/tEDM/reference/fnn.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"false nearest neighbours — fnn","text":"data observation data. target name target variable. lib (optional) libraries indices. pred (optional) predictions indices. E (optional) embedding dimensions. tau (optional) step time lags. rt (optional) escape factor. eps (optional) neighborhood diameter. threads (optional) number threads use.","code":""},{"path":"https://stscl.github.io/tEDM/reference/fnn.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"false nearest neighbours — fnn","text":"vector","code":""},{"path":"https://stscl.github.io/tEDM/reference/fnn.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"false nearest neighbours — fnn","text":"Kennel M. B., Brown R. Abarbanel H. D. ., Determining embedding dimension phase-space reconstruction using geometrical construction, Phys. Rev. , Volume 45, 3403 (1992).","code":""},{"path":"https://stscl.github.io/tEDM/reference/fnn.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"false nearest neighbours — fnn","text":"","code":"sim = logistic_map(x = 0.4,y = 0.4,step = 45,beta_xy = 0.5,beta_yx = 0) fnn(sim,\"x\") #>  E:1  E:2  E:3  E:4  E:5  E:6  E:7  E:8  E:9  #> 0.48 0.36 0.20 0.16 0.08 0.08 0.08 0.08 0.00"},{"path":"https://stscl.github.io/tEDM/reference/ic.html","id":null,"dir":"Reference","previous_headings":"","what":"intersection cardinality — ic","title":"intersection cardinality — ic","text":"intersection cardinality","code":""},{"path":"https://stscl.github.io/tEDM/reference/ic.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"intersection cardinality — ic","text":"","code":"# S4 method for class 'data.frame' ic(   data,   column,   target,   lib = NULL,   pred = NULL,   E = 2:10,   tau = 0,   k = E + 2,   threads = length(pred),   parallel.level = \"low\" )"},{"path":"https://stscl.github.io/tEDM/reference/ic.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"intersection cardinality — ic","text":"data observation data. column name library variable. target name target variable. lib (optional) libraries indices. pred (optional) predictions indices. E (optional) embedding dimensions. tau (optional) step time lags. k (optional) number nearest neighbors used prediction. threads (optional) number threads use. parallel.level (optional) level parallelism, low high.","code":""},{"path":"https://stscl.github.io/tEDM/reference/ic.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"intersection cardinality — ic","text":"list xmap cross mapping performance varname name target variable method method cross mapping tau step time lag","code":""},{"path":"https://stscl.github.io/tEDM/reference/ic.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"intersection cardinality — ic","text":"Tao, P., Wang, Q., Shi, J., Hao, X., Liu, X., Min, B., Zhang, Y., Li, C., Cui, H., Chen, L., 2023. Detecting dynamical causality intersection cardinal concavity. Fundamental Research.","code":""},{"path":"https://stscl.github.io/tEDM/reference/ic.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"intersection cardinality — ic","text":"","code":"sim = logistic_map(x = 0.4,y = 0.4,step = 45,beta_xy = 0.5,beta_yx = 0) ic(sim,\"x\",\"y\",E = 9,k = 15:30,threads = 1) #> The suggested E and k for variable y is 9 and 15"},{"path":"https://stscl.github.io/tEDM/reference/logistic_map.html","id":null,"dir":"Reference","previous_headings":"","what":"logistic map — logistic_map","title":"logistic map — logistic_map","text":"logistic map","code":""},{"path":"https://stscl.github.io/tEDM/reference/logistic_map.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"logistic map — logistic_map","text":"","code":"logistic_map(   x,   y = NULL,   z = NULL,   step = 15,   alpha_x = 3.6,   alpha_y = 3.72,   alpha_z = 3.68,   beta_xy = 0.05,   beta_xz = 0.05,   beta_yx = 0.2,   beta_yz = 0.2,   beta_zx = 0.35,   beta_zy = 0.35,   threshold = Inf,   transient = 1 )"},{"path":"https://stscl.github.io/tEDM/reference/logistic_map.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"logistic map — logistic_map","text":"x value x. y (optional) value y. z (optional) value z. step (optional) number simulation time steps. alpha_x (optional) growth parameter x. alpha_y (optional) growth parameter y. alpha_z (optional) growth parameter y. beta_xy (optional) cross-inhibition x y. beta_xz (optional) cross-inhibition x z. beta_yx (optional) cross-inhibition y x. beta_yz (optional) cross-inhibition y z. beta_zx (optional) cross-inhibition z x. beta_zy (optional) cross-inhibition z y. threshold (optional) set NaN absolute value exceeds threshold. transient (optional) transients excluded results.","code":""},{"path":"https://stscl.github.io/tEDM/reference/logistic_map.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"logistic map — logistic_map","text":"data.frame","code":""},{"path":"https://stscl.github.io/tEDM/reference/logistic_map.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"logistic map — logistic_map","text":"","code":"logistic_map(x = 0.2) #>            x #> 1  0.5760000 #> 2  0.8792064 #> 3  0.3823290 #> 4  0.8501527 #> 5  0.4586150 #> 6  0.8938342 #> 7  0.3416206 #> 8  0.8096975 #> 9  0.5547149 #> 10 0.8892226 #> 11 0.3546207 #> 12 0.8239135 #> 13 0.5222881 #> 14 0.8982117 #> 15 0.3291389"},{"path":"https://stscl.github.io/tEDM/reference/multispatialccm.html","id":null,"dir":"Reference","previous_headings":"","what":"multispatial convergent cross mapping — multispatialccm","title":"multispatial convergent cross mapping — multispatialccm","text":"multispatial convergent cross mapping","code":""},{"path":"https://stscl.github.io/tEDM/reference/multispatialccm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"multispatial convergent cross mapping — multispatialccm","text":"","code":"# S4 method for class 'list' multispatialccm(   data,   cause,   effect,   libsizes,   E = 3,   tau = 0,   k = E + 1,   boot = 99,   seed = 42,   threads = length(libsizes),   parallel.level = \"low\",   bidirectional = TRUE,   progressbar = TRUE )"},{"path":"https://stscl.github.io/tEDM/reference/multispatialccm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"multispatial convergent cross mapping — multispatialccm","text":"data observation data. cause name causal variable. effect name effect variable. libsizes number time points used prediction. E (optional) embedding dimensions. tau (optional) step time lags. k (optional) number nearest neighbors used prediction. boot (optional) number bootstraps perform. seed (optional) random seed. threads (optional) number threads use. parallel.level (optional) level parallelism, low high. bidirectional (optional) whether examine bidirectional causality. progressbar (optional) whether show progress bar.","code":""},{"path":"https://stscl.github.io/tEDM/reference/multispatialccm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"multispatial convergent cross mapping — multispatialccm","text":"list xmap cross mapping results varname names causal effect variable bidirectional whether examine bidirectional causality","code":""},{"path":"https://stscl.github.io/tEDM/reference/multispatialccm.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"multispatial convergent cross mapping — multispatialccm","text":"Clark, .T., Ye, H., Isbell, F., Deyle, E.R., Cowles, J., Tilman, G.D., Sugihara, G., 2015. Spatial convergent cross mapping detect causal relationships short time series. Ecology 96, 1174–1181.","code":""},{"path":"https://stscl.github.io/tEDM/reference/multispatialccm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"multispatial convergent cross mapping — multispatialccm","text":"","code":"set.seed(42) obs = runif(15,0,0.1) sim = vector(\"list\",15) for (i in seq_along(obs)){   sim[[i]] = logistic_map(x = obs[i],y = obs[i],step = 15,beta_xy = 0.5,beta_yx = 0) } lst = list(x = do.call(cbind, lapply(sim, function(df) df$x)),            y = do.call(cbind, lapply(sim, function(df) df$y))) multispatialccm(lst,\"x\",\"y\",libsizes = 5:15,E = c(7,2),k = 6,threads = 1) #>  Computing: [========================================] 100% (done)                          #>  Computing: [========================================] 100% (done)                          #>    libsizes      x->y      y->x #> 1         5 0.7665126 0.6929759 #> 2         6 0.8155336 0.7418481 #> 3         7 0.8427247 0.7738482 #> 4         8 0.8615120 0.7983056 #> 5         9 0.8751009 0.8152952 #> 6        10 0.8853064 0.8323882 #> 7        11 0.8987007 0.8527309 #> 8        12 0.9110421 0.8747777 #> 9        13 0.9201259 0.8843184 #> 10       14 0.9287790 0.8966083 #> 11       15 0.9357402 0.9051681"},{"path":"https://stscl.github.io/tEDM/reference/pcm.html","id":null,"dir":"Reference","previous_headings":"","what":"partial cross mapping — pcm","title":"partial cross mapping — pcm","text":"partial cross mapping","code":""},{"path":"https://stscl.github.io/tEDM/reference/pcm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"partial cross mapping — pcm","text":"","code":"# S4 method for class 'data.frame' pcm(   data,   cause,   effect,   conds,   libsizes = NULL,   E = 3,   tau = 0,   k = E + 1,   theta = 1,   algorithm = \"simplex\",   lib = NULL,   pred = NULL,   threads = length(libsizes),   parallel.level = \"low\",   bidirectional = TRUE,   cumulate = FALSE,   progressbar = TRUE )"},{"path":"https://stscl.github.io/tEDM/reference/pcm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"partial cross mapping — pcm","text":"data observation data. cause name causal variable. effect name effect variable. conds name conditioning variables. libsizes (optional) number time points used. E (optional) embedding dimensions. tau (optional) step time lags. k (optional) number nearest neighbors. theta (optional) weighting parameter distances, useful algorithm smap. algorithm (optional) prediction algorithm. lib (optional) libraries indices. pred (optional) predictions indices. threads (optional) number threads use. parallel.level (optional) level parallelism, low high. bidirectional (optional) whether examine bidirectional causality. cumulate (optional) serial cumulative computation partial cross mapping. progressbar (optional) whether show progress bar.","code":""},{"path":"https://stscl.github.io/tEDM/reference/pcm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"partial cross mapping — pcm","text":"list pxmap partial cross mapping results xmap cross mapping results varname names causal effect variable bidirectional whether examine bidirectional causality","code":""},{"path":"https://stscl.github.io/tEDM/reference/pcm.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"partial cross mapping — pcm","text":"Leng, S., Ma, H., Kurths, J. et al. Partial cross mapping eliminates indirect causal influences. Nat Commun 11, 2632 (2020).","code":""},{"path":"https://stscl.github.io/tEDM/reference/pcm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"partial cross mapping — pcm","text":"","code":"sim = logistic_map(x = 0.4,y = 0.4,z = 0.4,step = 45,                    beta_xy = 0.5, beta_xz = 0,                    beta_yx = 0, beta_yz = 0.5,                    beta_zx = 0, beta_zy = 0) pcm(sim,\"x\",\"z\",\"y\",libsizes = seq(5,35,5),E = 10,k = 7,threads = 1) #>  Computing: [========================================] 100% (done)                          #>  Computing: [========================================] 100% (done)                          #> --------------------------------------  #> ***partial cross mapping prediction***  #> --------------------------------------  #>   libsizes      x->z      z->x #> 1        5 0.2549662 0.1687161 #> 2       10 0.1025583 0.1287902 #> 3       15 0.2345731 0.1407319 #> 4       20 0.1310661 0.2028892 #> 5       25 0.1266602 0.2397178 #> 6       30 0.1147702 0.2771978 #> 7       35 0.1245560 0.5516479 #>  #> ------------------------------  #> ***cross mapping prediction***  #> ------------------------------  #>   libsizes      x->z      z->x #> 1        5 0.8099271 0.6423512 #> 2       10 0.8818607 0.6830390 #> 3       15 0.8961755 0.6924374 #> 4       20 0.8961413 0.6965852 #> 5       25 0.8948321 0.7039838 #> 6       30 0.8941432 0.7064543 #> 7       35 0.9346800 0.7623188"},{"path":"https://stscl.github.io/tEDM/reference/simplex.html","id":null,"dir":"Reference","previous_headings":"","what":"simplex forecast — simplex","title":"simplex forecast — simplex","text":"simplex forecast","code":""},{"path":"https://stscl.github.io/tEDM/reference/simplex.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"simplex forecast — simplex","text":"","code":"# S4 method for class 'data.frame' simplex(   data,   column,   target,   lib = NULL,   pred = NULL,   E = 2:10,   tau = 0,   k = E + 1,   threads = length(E) )  # S4 method for class 'list' simplex(   data,   column,   target,   lib = NULL,   pred = NULL,   E = 2:10,   tau = 0,   k = E + 1,   threads = length(E) )"},{"path":"https://stscl.github.io/tEDM/reference/simplex.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"simplex forecast — simplex","text":"data observation data. column name library variable. target name target variable. lib (optional) libraries indices. pred (optional) predictions indices. E (optional) embedding dimensions. tau (optional) step time lags. k (optional) number nearest neighbors used prediction. threads (optional) number threads use.","code":""},{"path":"https://stscl.github.io/tEDM/reference/simplex.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"simplex forecast — simplex","text":"list xmap forecast performance varname name target variable method method cross mapping tau step time lag","code":""},{"path":"https://stscl.github.io/tEDM/reference/simplex.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"simplex forecast — simplex","text":"Sugihara G. May R. 1990. Nonlinear forecasting way distinguishing chaos measurement error time series. Nature, 344:734-741.","code":""},{"path":"https://stscl.github.io/tEDM/reference/simplex.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"simplex forecast — simplex","text":"","code":"sim = logistic_map(x = 0.4,y = 0.4,step = 45,beta_xy = 0.5,beta_yx = 0) simplex(sim,\"x\",\"y\",k = 7,threads = 1) #> The suggested E and k for variable y is 8 and 7"},{"path":"https://stscl.github.io/tEDM/reference/smap.html","id":null,"dir":"Reference","previous_headings":"","what":"smap forecast — smap","title":"smap forecast — smap","text":"smap forecast","code":""},{"path":"https://stscl.github.io/tEDM/reference/smap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"smap forecast — smap","text":"","code":"# S4 method for class 'data.frame' smap(   data,   column,   target,   lib = NULL,   pred = NULL,   E = 3,   tau = 0,   k = E + 1,   theta = c(0, 1e-04, 3e-04, 0.001, 0.003, 0.01, 0.03, 0.1, 0.3, 0.5, 0.75, 1, 1.5, 2, 3,     4, 6, 8),   threads = length(theta) )"},{"path":"https://stscl.github.io/tEDM/reference/smap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"smap forecast — smap","text":"data observation data. column name library variable. target name target variable. lib (optional) libraries indices. pred (optional) predictions indices. E (optional) embedding dimensions. tau (optional) step time lags. k (optional) number nearest neighbors used prediction. theta (optional) weighting parameter distances. threads (optional) number threads use.","code":""},{"path":"https://stscl.github.io/tEDM/reference/smap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"smap forecast — smap","text":"list xmap forecast performance varname name target variable method method cross mapping","code":""},{"path":"https://stscl.github.io/tEDM/reference/smap.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"smap forecast — smap","text":"Sugihara G. 1994. Nonlinear forecasting classification natural time series. Philosophical Transactions: Physical Sciences Engineering, 348 (1688):477-495.","code":""},{"path":"https://stscl.github.io/tEDM/reference/smap.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"smap forecast — smap","text":"","code":"sim = logistic_map(x = 0.4,y = 0.4,step = 45,beta_xy = 0.5,beta_yx = 0) smap(sim,\"x\",\"y\",E = 8,k = 7,threads = 1) #> The suggested theta for variable y is 0"},{"path":"https://stscl.github.io/tEDM/news/index.html","id":"tedm-10","dir":"Changelog","previous_headings":"","what":"tEDM 1.0","title":"tEDM 1.0","text":"First stable release.","code":""}]
