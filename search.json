[{"path":"https://stscl.github.io/tEDM/articles/tEDM.html","id":"introduction-to-the-tedm-package","dir":"Articles","previous_headings":"","what":"1. Introduction to the tEDM package","title":"Temporal Empirical Dynamic Modeling","text":"tEDM package provides suite tools exploring quantifying causality time series using Empirical Dynamic Modeling (EDM). implements four fundamental EDM-based causal discovery methods: Convergent Cross Mapping (CCM) Partial Cross Mapping (PCM) Cross Mapping Cardinality (CMC) Multispatial Convergent Cross Mapping (MultispatialCCM) methods enable researchers : Identify potential causal interactions without assuming predefined model structure. Distinguish direct causation indirect (mediated confounded) influences. Reconstruct underlying causal dynamics replicated univariate time series observed across multiple spatial units.","code":""},{"path":[]},{"path":"https://stscl.github.io/tEDM/articles/tEDM.html","id":"hong-kong-air-pollution-and-cardiovascular-admissions","dir":"Articles","previous_headings":"2. Example data in the tEDM package","what":"Hong Kong Air Pollution and Cardiovascular Admissions","title":"Temporal Empirical Dynamic Modeling","text":"daily time series dataset(1995-3 1997-11) Hong Kong includes cardiovascular hospital admissions major air pollutant concentrations. File: cvd.csv Columns: Source: Data adapted PCM article.","code":""},{"path":"https://stscl.github.io/tEDM/articles/tEDM.html","id":"us-county-level-carbon-emissions-dataset","dir":"Articles","previous_headings":"2. Example data in the tEDM package","what":"US County-Level Carbon Emissions Dataset","title":"Temporal Empirical Dynamic Modeling","text":"panel dataset covering U.S. county-level temperature carbon emissions across time. File: carbon.csv.gz Columns: Source: Data adapted FsATE article.","code":""},{"path":"https://stscl.github.io/tEDM/articles/tEDM.html","id":"covid-19-infection-counts-in-japan","dir":"Articles","previous_headings":"2. Example data in the tEDM package","what":"COVID-19 Infection Counts in Japan","title":"Temporal Empirical Dynamic Modeling","text":"spatio-temporal dataset capturing number confirmed COVID-19 infections across Japan’s 47 prefectures time. File: covid.csv Structure: column represents one 47 Japanese prefectures (e.g., Tokyo, Osaka, Hokkaido). row corresponds time step (daily). Source: Data adapted CMC article.","code":""},{"path":"https://stscl.github.io/tEDM/articles/tEDM.html","id":"case-studies-of-the-tedm-package","dir":"Articles","previous_headings":"","what":"3. Case studies of the tEDM package","title":"Temporal Empirical Dynamic Modeling","text":"Install stable version: dev version:","code":"install.packages(\"tEDM\", dep = TRUE) install.packages(\"tEDM\",                  repos = c(\"https://stscl.r-universe.dev\",                            \"https://cloud.r-project.org\"),                  dep = TRUE)"},{"path":"https://stscl.github.io/tEDM/articles/tEDM.html","id":"air-pollution-and-cardiovascular-health-in-hong-kong","dir":"Articles","previous_headings":"3. Case studies of the tEDM package","what":"Air Pollution and Cardiovascular Health in Hong Kong","title":"Temporal Empirical Dynamic Modeling","text":"Employing PCM investigate causal relationships various air pollutants cardiovascular diseases: Determining optimal embedding dimension: Starting \\(E = 11\\), FNN ratio stabilizes near 0.18; thus, embedding dimension E neighbor number k chosen 11 onward subsequent self-prediction parameter selection. investigate causal influences air pollutants incidence cardiovascular diseases, performed PCM analysis using embedding dimension 11 12 nearest neighbors per variable pair. PCM results shown figure : Figure 3, can infer following causal links: Figure 4. Causal interactions air pollutants cardiovascular diseases Hong Kong.","code":"library(tEDM)  cvd = readr::read_csv(system.file(\"case/cvd.csv\",package = \"tEDM\")) ## Rows: 1032 Columns: 5 ## ── Column specification ───────────────────────────────────────────────────────── ## Delimiter: \",\" ## dbl (5): cvd, rsp, no2, so2, o3 ##  ## ℹ Use `spec()` to retrieve the full column specification for this data. ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message. head(cvd) ## # A tibble: 6 × 5 ##     cvd   rsp   no2   so2    o3 ##   <dbl> <dbl> <dbl> <dbl> <dbl> ## 1   214  73.7  74.5  19.1 17.4  ## 2   203  77.6  80.9  18.8 39.4  ## 3   202  64.8  67.1  13.8 56.4  ## 4   182  68.8  74.7  30.8  5.6  ## 5   181  49.4  62.3  23.1  3.6  ## 6   129  67.4  63.6  17.4  6.73 cvd_long = cvd |>   tibble::rowid_to_column(\"id\") |>   tidyr::pivot_longer(cols = -id,                       names_to = \"variable\", values_to = \"value\")  fig_cvds_ts = ggplot2::ggplot(cvd_long, ggplot2::aes(x = id, y = value, color = variable)) +   ggplot2::geom_line(linewidth = 0.5) +   ggplot2::labs(x = \"Days (from 1995-3 to 1997-11)\", y = \"Concentrations or \\nNO. of CVD admissions\", color = \"\") +   ggplot2::theme_bw() +   ggplot2::theme(legend.direction = \"horizontal\",                  legend.position = \"inside\",                  legend.justification = c(\"center\",\"top\"),                  legend.background = ggplot2::element_rect(fill = \"transparent\", color = NA)) fig_cvds_ts tEDM::fnn(cvd,\"cvd\",E = 2:50,eps = stats::sd(cvd$cvd)) ##       E:1       E:2       E:3       E:4       E:5       E:6       E:7       E:8  ## 0.8275862 0.4882729 0.3026188 0.2880698 0.2133851 0.2065955 0.1920466 0.1871969  ##       E:9      E:10      E:11      E:12      E:13      E:14      E:15      E:16  ## 0.1842871 0.1862270 0.1794374 0.1823472 0.1765276 0.1687682 0.1619787 0.1619787  ##      E:17      E:18      E:19      E:20      E:21      E:22      E:23      E:24  ## 0.1503395 0.1483996 0.1629486 0.1513094 0.1542192 0.1658584 0.1610087 0.1610087  ##      E:25      E:26      E:27      E:28      E:29      E:30      E:31      E:32  ## 0.1619787 0.1833172 0.1610087 0.1697381 0.1668283 0.1755577 0.1668283 0.1755577  ##      E:33      E:34      E:35      E:36      E:37      E:38      E:39      E:40  ## 0.1648885 0.1668283 0.1668283 0.1580989 0.1464597 0.1571290 0.1590689 0.1639185  ##      E:41      E:42      E:43      E:44      E:45      E:46      E:47      E:48  ## 0.1580989 0.1580989 0.1590689 0.1610087 0.1542192 0.1590689 0.1707081 0.1736178  ##      E:49  ## 0.1677983 tEDM::simplex(cvd,\"cvd\",\"cvd\",E = 11:25,k = 12:26) ## The suggested E and k for variable cvd is 11 and 12 tEDM::simplex(cvd,\"rsp\",\"rsp\",E = 11:25,k = 12:26) ## The suggested E and k for variable rsp is 11 and 12 tEDM::simplex(cvd,\"no2\",\"no2\",E = 11:25,k = 12:26) ## The suggested E and k for variable no2 is 11 and 12 tEDM::simplex(cvd,\"so2\",\"so2\",E = 11:25,k = 12:26) ## The suggested E and k for variable so2 is 11 and 16 tEDM::simplex(cvd,\"o3\",\"o3\",E = 11:25,k = 12:26) ## The suggested E and k for variable o3 is 11 and 12  s1 = tEDM::simplex(cvd,\"cvd\",\"cvd\",E = 11,k = 12:26) s2 = tEDM::simplex(cvd,\"rsp\",\"rsp\",E = 11,k = 12:26) s3 = tEDM::simplex(cvd,\"no2\",\"no2\",E = 11,k = 12:26) s4 = tEDM::simplex(cvd,\"so2\",\"so2\",E = 11,k = 12:26) s5 = tEDM::simplex(cvd,\"o3\",\"o3\",E = 11,k = 12:26)  list(s1,s2,s3,s4,s5) ## [[1]] ## The suggested E and k for variable cvd is 11 and 12  ##  ## [[2]] ## The suggested E and k for variable rsp is 11 and 12  ##  ## [[3]] ## The suggested E and k for variable no2 is 11 and 12  ##  ## [[4]] ## The suggested E and k for variable so2 is 11 and 15  ##  ## [[5]] ## The suggested E and k for variable o3 is 11 and 12  simplex_df = purrr::map2_dfr(list(s1,s2,s3,s4,s5),                              c(\"cvd\",\"rsp\",\"no2\",\"so2\",\"o3\"),                              \\(.list,.name) dplyr::mutate(.list$xmap,variable = .name)) ggplot2::ggplot(data = simplex_df) +   ggplot2::geom_line(ggplot2::aes(x = k, y = rho, color = variable)) vars = c(\"cvd\", \"rsp\", \"no2\", \"so2\", \"o3\") res = list() var_pairs = combn(vars, 2, simplify = FALSE)  for (pair in var_pairs) {   var1 = pair[1]   var2 = pair[2]   conds = setdiff(vars, pair)   key = paste0(var1, \"_\", var2)   res[[key]] = tEDM::pcm(data = cvd,                          cause = var2,                          effect = var1,                          conds = conds,                          libsizes = seq(12, 1012, 100),                          E = 11, k = 12,                          progress = FALSE) } fig_cvd_rsp = plot(res[[\"cvd_rsp\"]], partial = FALSE,                    ylimits = c(-0.01,0.2), ybreaks = seq(0,0.2,by = 0.05),                    legend_texts = c(\"CVD xmap RSP, P = 0\",                                     \"RSP xmap CVD, P = 0.001\")) fig_cvd_rsp_p = plot(res[[\"cvd_rsp\"]], ylimits = c(-0.01,0.2), ybreaks = seq(0,0.2,by = 0.05),                      legend_texts = c(\"CVD xmap RSP | NO2 & SO2 & O3, P = 0\",                                       \"RSP xmap CVD | NO2 & SO2 & O3, P = 0.0179\"))  fig_cvd_no2 = plot(res[[\"cvd_no2\"]], partial = FALSE,                    ylimits = c(0,0.35), ybreaks = seq(0,0.35,by = 0.05),                    legend_texts = c(\"CVD xmap NO2, P = 0\",                                     \"NO2 xmap CVD, P = 0\")) fig_cvd_no2_p = plot(res[[\"cvd_no2\"]], ylimits = c(0,0.35), ybreaks = seq(0,0.35,by = 0.05),                      legend_texts = c(\"CVD xmap NO2 | RSP & SO2 & O3, P = 0\",                                       \"NO2 xmap CVD | RSP & SO2 & O3, P = 0\"))  fig_cvd_so2 = plot(res[[\"cvd_so2\"]], partial = FALSE,                    ylimits = c(0,0.25), ybreaks = seq(0,0.25,by = 0.05),                    legend_texts = c(\"CVD xmap SO2, P = 0\",                                     \"SO2 xmap CVD, P = 0\")) fig_cvd_so2_p = plot(res[[\"cvd_so2\"]], ylimits = c(0,0.25), ybreaks = seq(0,0.25,by = 0.05),                      legend_texts = c(\"CVD xmap SO2 | RSP & NO2 & O3, P = 0\",                                       \"SO2 xmap CVD | RSP & NO2 & O3, P = 0.003\"))  fig_cvd_o3 = plot(res[[\"cvd_o3\"]], partial = FALSE,                   ylimits = c(-0.05,0.25), ybreaks = seq(-0.05,0.25,by = 0.05),                   legend_texts = c(\"CVD xmap O3, P = 0.495\",                                     \"O3 xmap CVD, P = 0.002\")) fig_cvd_o3_p = plot(res[[\"cvd_o3\"]], ylimits = c(-0.05,0.25), ybreaks = seq(-0.05,0.25,by = 0.05),                     legend_texts = c(\"CVD xmap O3 | RSP & NO2 & SO2, P = 0.402\",                                      \"O3 xmap CVD | RSP & NO2 & SO2, P = 0.028\"))  fig_rsp_no2 = plot(res[[\"rsp_no2\"]], partial = FALSE,                    ylimits = c(0.2,0.9), ybreaks = seq(0.2,0.9,by = 0.1),                    legend_texts = c(\"RSP xmap NO2, P = 0\",                                     \"NO2 xmap RSP, P = 0\")) fig_rsp_no2_p = plot(res[[\"rsp_no2\"]], ylimits = c(0.2,0.9), ybreaks = seq(0.2,0.9,by = 0.1),                      legend_texts = c(\"RSP xmap NO2 | CVD & SO2 & O3, P = 0\",                                       \"NO2 xmap RSP | CVD & SO2 & O3, P = 0\"))  fig_rsp_so2 = plot(res[[\"rsp_so2\"]], partial = FALSE,                    ylimits = c(0.05,0.55), ybreaks = seq(0.05,0.55,by = 0.1),                    legend_texts = c(\"RSP xmap SO2, P = 0\",                                     \"SO2 xmap RSP, P = 0\")) fig_rsp_so2_p = plot(res[[\"rsp_so2\"]], ylimits = c(0.05,0.55), ybreaks = seq(0.05,0.55,by = 0.1),                      legend_texts = c(\"RSP xmap SO2 | CVD & NO2 & O3, P = 0\",                                       \"SO2 xmap RSP | CVD & NO2 & O3, P = 0\"))  fig_rsp_o3 = plot(res[[\"rsp_o3\"]], partial = FALSE,                   ylimits = c(0.05,0.65), ybreaks = seq(0.05,0.65,by = 0.1),                   legend_texts = c(\"RSP xmap O3, P = 0\",                                    \"O3 xmap RSP, P = 0\")) fig_rsp_o3_p = plot(res[[\"rsp_o3\"]], ylimits = c(0.05,0.65), ybreaks = seq(0.05,0.65,by = 0.1),                     legend_texts = c(\"RSP xmap O3 | CVD & SO2 & NO2, P = 0\",                                      \"O3 xmap RSP | CVD & SO2 & NO2, P = 0\"))  fig_no2_so2 = plot(res[[\"no2_so2\"]], partial = FALSE,                    ylimits = c(0.15,0.75), ybreaks = seq(0.15,0.75,by = 0.1),                    legend_texts = c(\"NO2 xmap SO2, P = 0\",                                     \"SO2 xmap NO2, P = 0\")) fig_no2_so2_p = plot(res[[\"no2_so2\"]], ylimits = c(0.15,0.75), ybreaks = seq(0.15,0.75,by = 0.1),                      legend_texts = c(\"NO2 xmap SO2 | CVD & RSP & O3, P = 0\",                                       \"SO2 xmap NO2 | CVD & RSP & O3, P = 0\"))  fig_no2_o3 = plot(res[[\"no2_o3\"]], partial = FALSE,                   ylimits = c(0.05,0.65), ybreaks = seq(0.05,0.65,by = 0.1),                   legend_texts = c(\"NO2 xmap O3, P = 0\",                                    \"O3 xmap NO2, P = 0\")) fig_no2_o3_p = plot(res[[\"no2_o3\"]], ylimits = c(0.05,0.65), ybreaks = seq(0.05,0.65,by = 0.1),                     legend_texts = c(\"NO2 xmap O3 | CVD & RSP & SO2, P = 0\",                                      \"O3 xmap NO2 | CVD & RSP & SO2, P = 0\"))  fig_so2_o3 = plot(res[[\"so2_o3\"]], partial = FALSE,                   ylimits = c(-0.05,0.45), ybreaks = seq(-0.05,0.45,by = 0.1),                   legend_texts = c(\"SO2 xmap O3, P = 0\",                                    \"O3 xmap SO2, P = 0.094\")) fig_so2_o3_p = plot(res[[\"so2_o3\"]], ylimits = c(-0.05,0.45), ybreaks = seq(-0.05,0.45,by = 0.1),                     legend_texts = c(\"SO2 xmap O3 | CVD & RSP & NO2, P = 0\",                                      \"O3 xmap SO2 | CVD & RSP & NO2, P = 0.131\"))  fig_pcm = cowplot::plot_grid(fig_cvd_rsp, fig_cvd_rsp_p, fig_cvd_no2, fig_cvd_no2_p,                              fig_cvd_so2, fig_cvd_so2_p, fig_cvd_o3, fig_cvd_o3_p,                              fig_rsp_no2, fig_rsp_no2_p, fig_rsp_so2, fig_rsp_so2_p,                              fig_rsp_o3, fig_rsp_o3_p, fig_no2_so2, fig_no2_so2_p,                              fig_no2_o3, fig_no2_o3_p, fig_so2_o3, fig_so2_o3_p,                              ncol = 4, label_fontfamily = 'serif',                              labels = letters[1:20],                              label_x = -0.005, label_y = 1) fig_pcm"},{"path":"https://stscl.github.io/tEDM/articles/tEDM.html","id":"us-county-carbon-emissions-and-temperature-dynamics","dir":"Articles","previous_headings":"3. Case studies of the tEDM package","what":"US County Carbon Emissions and Temperature Dynamics","title":"Temporal Empirical Dynamic Modeling","text":"examine whether causal relationship exists annual mean temperature total annual CO₂ emissions, implement CMC method across counties. Using 100th county example, determine appropriate embedding dimension applying FNN method. E equals 3, FNN ratio begins drop zero; therefore, select \\(E = 3\\) embedding dimension CMC analysis.","code":"library(tEDM)  carbon = readr::read_csv(system.file(\"case/carbon.csv.gz\",package = \"tEDM\")) ## Rows: 113627 Columns: 4 ## ── Column specification ───────────────────────────────────────────────────────── ## Delimiter: \",\" ## dbl (4): year, fips, tem, carbon ##  ## ℹ Use `spec()` to retrieve the full column specification for this data. ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message. head(carbon) ## # A tibble: 6 × 4 ##    year  fips   tem     carbon ##   <dbl> <dbl> <dbl>      <dbl> ## 1  1981  1001  17.4 192607687. ## 2  1982  1001  18.4 187149414. ## 3  1983  1001  16.9 191584445. ## 4  1984  1001  17.8 199157579. ## 5  1985  1001  17.9 205207564. ## 6  1986  1001  18.5 218446030.  carbon_list = dplyr::group_split(carbon, by = fips) length(carbon_list) ## [1] 3071 tEDM::fnn(carbon_list[[100]],\"carbon\",E = 2:10,eps = stats::sd(carbon_list[[100]]$carbon)) ##        E:1        E:2        E:3        E:4        E:5        E:6        E:7  ## 0.29729730 0.02702703 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000  ##        E:8        E:9  ## 0.00000000 0.00000000 res = carbon_list |>   purrr::map_dfr(\\(.x) {     g = tEDM::cmc(.x,\"tem\",\"carbon\",E = 3,k = 20,progressbar = FALSE)     return(g$xmap)   }) head(res) ##   neighbors x_xmap_y_mean x_xmap_y_sig x_xmap_y_upper x_xmap_y_lower ## 1        20       0.17625 1.441152e-06      0.3079181     0.04458194 ## 2        20       0.15625 5.526258e-08      0.2802472     0.03225277 ## 3        20       0.15625 5.809091e-08      0.2804509     0.03204912 ## 4        20       0.20125 3.147621e-05      0.3419196     0.06058040 ## 5        20       0.20875 7.165149e-05      0.3525117     0.06498830 ## 6        20       0.13125 2.408340e-10      0.2453769     0.01712311 ##   y_xmap_x_mean y_xmap_x_sig y_xmap_x_upper y_xmap_x_lower ## 1       0.06375 4.154966e-26      0.1446512              0 ## 2       0.06250 1.381916e-28      0.1398111              0 ## 3       0.06250 4.667439e-26      0.1437169              0 ## 4       0.06625 2.180138e-25      0.1478975              0 ## 5       0.06875 2.677461e-23      0.1537491              0 ## 6       0.05875 1.135327e-30      0.1338684              0  res_carbon = res |>   dplyr::select(neighbors,                 carbon_tem = x_xmap_y_mean,                 tem_carbon = y_xmap_x_mean) |>   tidyr::pivot_longer(c(carbon_tem, tem_carbon),                       names_to = \"variable\", values_to = \"value\") head(res_carbon) ## # A tibble: 6 × 3 ##   neighbors variable    value ##       <dbl> <chr>       <dbl> ## 1        20 carbon_tem 0.176  ## 2        20 tem_carbon 0.0638 ## 3        20 carbon_tem 0.156  ## 4        20 tem_carbon 0.0625 ## 5        20 carbon_tem 0.156  ## 6        20 tem_carbon 0.0625 res_carbon$variable = factor(res_carbon$variable,                              levels = c(\"carbon_tem\", \"tem_carbon\"),                              labels = c(\"carbon → tem\", \"tem → carbon\")) fig_case2 = ggplot2::ggplot(res_carbon,                             ggplot2::aes(x = variable, y = value, fill = variable)) +   ggplot2::geom_boxplot() +   ggplot2::theme_bw() +   ggplot2::scale_x_discrete(name = \"\") +   ggplot2::scale_y_continuous(name = \"Causal Strength\",                               expand = c(0,0),                               limits = c(0,0.3),                               breaks = seq(0,0.3,by = 0.1)) +   ggplot2::theme(legend.position = \"none\") fig_case2"},{"path":"https://stscl.github.io/tEDM/articles/tEDM.html","id":"covid-19-spread-across-japanese-prefectures","dir":"Articles","previous_headings":"3. Case studies of the tEDM package","what":"COVID-19 Spread Across Japanese Prefectures","title":"Temporal Empirical Dynamic Modeling","text":"examine COVID-19 transmission Tokyo prefectures applying CCM identify underlying causal dynamics epidemic spread data first differenced: Using Tokyo’s COVID-19 infection data test optimal embedding dimension. Since FNN ratio begins approach zero E equals 4, embedding dimensions 4 onward evaluated, pair E k yielding highest self-prediction accuracy selected CCM procedure. Using 0.90 threshold (rounded two decimal places), map causal responses spread COVID-19 Tokyo causal strength greater 0.90.","code":"library(tEDM)  covid = readr::read_csv(system.file(\"case/covid.csv\",package = \"tEDM\")) ## Rows: 334 Columns: 47 ## ── Column specification ───────────────────────────────────────────────────────── ## Delimiter: \",\" ## dbl (47): Hokkaido, Aomori, Iwate, Miyagi, Akita, Yamagata, Fukushima, Ibarak... ##  ## ℹ Use `spec()` to retrieve the full column specification for this data. ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message. head(covid) ## # A tibble: 6 × 47 ##   Hokkaido Aomori Iwate Miyagi Akita Yamagata Fukushima Ibaraki Tochigi Gunma ##      <dbl>  <dbl> <dbl>  <dbl> <dbl>    <dbl>     <dbl>   <dbl>   <dbl> <dbl> ## 1        0      0     0      0     0        0         0       0       0     0 ## 2        0      0     0      0     0        0         0       0       0     0 ## 3        0      0     0      0     0        0         0       0       0     0 ## 4        0      0     0      0     0        0         0       0       0     0 ## 5        0      0     0      0     0        0         0       0       0     0 ## 6        0      0     0      0     0        0         0       0       0     0 ## # ℹ 37 more variables: Saitama <dbl>, Chiba <dbl>, Tokyo <dbl>, Kanagawa <dbl>, ## #   Niigata <dbl>, Toyama <dbl>, Ishikawa <dbl>, Fukui <dbl>, Yamanashi <dbl>, ## #   Nagano <dbl>, Gifu <dbl>, Shizuoka <dbl>, Aichi <dbl>, Mie <dbl>, ## #   Shiga <dbl>, Kyoto <dbl>, Osaka <dbl>, Hyogo <dbl>, Nara <dbl>, ## #   Wakayama <dbl>, Tottori <dbl>, Shimane <dbl>, Okayama <dbl>, ## #   Hiroshima <dbl>, Yamaguchi <dbl>, Tokushima <dbl>, Kagawa <dbl>, ## #   Ehime <dbl>, Kochi <dbl>, Fukuoka <dbl>, Saga <dbl>, Nagasaki <dbl>, … covid = covid |>   dplyr::mutate(dplyr::across(dplyr::everything(),                               \\(.x) c(NA,diff(.x)))) tEDM::fnn(covid,\"Tokyo\",E = 2:30,eps = stats::sd(covid$Tokyo)/10) ##        E:1        E:2        E:3        E:4        E:5        E:6        E:7  ## 0.79452055 0.16842105 0.01246106 0.00000000 0.00000000 0.00000000 0.00000000  ##        E:8        E:9       E:10       E:11       E:12       E:13       E:14  ## 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000  ##       E:15       E:16       E:17       E:18       E:19       E:20       E:21  ## 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000  ##       E:22       E:23       E:24       E:25       E:26       E:27       E:28  ## 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000  ##       E:29  ## 0.00000000 tEDM::simplex(covid,\"Tokyo\",\"Tokyo\",E = 4:50,k = 5:60,tau = 0) ## The suggested E and k for variable Tokyo is 4 and 5 res = names(covid)[-match(\"Tokyo\",names(covid))] |>   purrr::map_dfr(\\(.l) {     g = tEDM::ccm(covid,\"Tokyo\",.l,E = 4,k = 5,tau = 0,progressbar = FALSE)     res = dplyr::mutate(g$xmap,x = \"Tokyo\",y = .l)     return(res)   }) head(res) ##   libsizes x_xmap_y_mean x_xmap_y_sig x_xmap_y_upper x_xmap_y_lower ## 1      331     0.6804248 1.321676e-46     0.61815411      0.7342085 ## 2      331     0.1674893 2.165145e-03     0.06111370      0.2701030 ## 3      331     0.5723274 2.281528e-30     0.49531935      0.6404106 ## 4      331     0.4891147 1.974091e-21     0.40281406      0.5667952 ## 5      331     0.0190694 7.288116e-01    -0.08858792      0.1262863 ## 6      331     0.5992591 7.661109e-34     0.52563744      0.6639712 ##   y_xmap_x_mean y_xmap_x_sig y_xmap_x_upper y_xmap_x_lower     x        y ## 1     0.7135965 4.253739e-53      0.6564682      0.7625862 Tokyo Hokkaido ## 2     0.4300186 2.025965e-16      0.3381720      0.5137506 Tokyo   Aomori ## 3     0.7463769 1.717124e-60      0.6946219      0.7904451 Tokyo    Iwate ## 4     0.7101869 2.179223e-52      0.6525163      0.7596780 Tokyo   Miyagi ## 5     0.2902985 6.885531e-08      0.1887106      0.3857392 Tokyo    Akita ## 6     0.5091739 2.296441e-23      0.4249533      0.5846551 Tokyo Yamagata  df1 = res |>     dplyr::select(x,y,y_xmap_x_mean,y_xmap_x_sig)|>     purrr::set_names(c(\"cause\",\"effect\",\"cs\",\"sig\")) df2 = res |>     dplyr::select(y,x,x_xmap_y_mean,x_xmap_y_sig) |>     purrr::set_names(c(\"cause\",\"effect\",\"cs\",\"sig\")) res_covid = dplyr::bind_rows(df1,df2)|>   dplyr::filter(cause == \"Tokyo\") |>   dplyr::arrange(dplyr::desc(cs)) head(res_covid,10) ##    cause   effect        cs           sig ## 1  Tokyo    Osaka 0.9303327 2.926162e-146 ## 2  Tokyo Kanagawa 0.9267106 9.462232e-143 ## 3  Tokyo  Saitama 0.9114050 1.101151e-129 ## 4  Tokyo    Chiba 0.9101078 1.092484e-128 ## 5  Tokyo    Hyogo 0.9009604 4.603912e-122 ## 6  Tokyo    Aichi 0.9002959 1.315049e-121 ## 7  Tokyo     Nara 0.8740873 8.089958e-106 ## 8  Tokyo  Ibaraki 0.8733375 2.024607e-105 ## 9  Tokyo Shizuoka 0.8664110 7.418131e-102 ## 10 Tokyo     Gifu 0.8482974  2.078461e-93 res_covid = res_covid |>   dplyr::mutate(cs = round(res_covid$cs,2)) |>   dplyr::filter(cs >= 0.90) res_covid ##   cause   effect   cs           sig ## 1 Tokyo    Osaka 0.93 2.926162e-146 ## 2 Tokyo Kanagawa 0.93 9.462232e-143 ## 3 Tokyo  Saitama 0.91 1.101151e-129 ## 4 Tokyo    Chiba 0.91 1.092484e-128 ## 5 Tokyo    Hyogo 0.90 4.603912e-122 ## 6 Tokyo    Aichi 0.90 1.315049e-121  if (!requireNamespace(\"rnaturalearth\")) {   install.packages(\"rnaturalearth\") } ## Loading required namespace: rnaturalearth jp = rnaturalearth::ne_states(country = \"Japan\")  if (!requireNamespace(\"tidygeocoder\")) {   install.packages(\"tidygeocoder\") } ## Loading required namespace: tidygeocoder jpp = tibble::tibble(name = c(\"Tokyo\",res_covid$effect)) |>   dplyr::mutate(type = factor(c(\"source\",rep(\"target\",6)),                               levels = c(\"source\",\"target\"))) |>   tidygeocoder::geocode(state = name, method = \"arcgis\",                         long = \"lon\", lat = \"lat\") ## Passing 7 addresses to the ArcGIS single address geocoder ## Query completed in: 6.1 seconds  fig_case3 = ggplot2::ggplot() +   ggplot2::geom_sf(data = jp, fill = \"#ffe7b7\", color = \"grey\", linewidth = 0.45) +   ggplot2::geom_curve(data = jpp[-1,],                       ggplot2::aes(x = jpp[1,\"lon\",drop = TRUE],                                    y = jpp[1,\"lat\",drop = TRUE],                                    xend = lon, yend = lat),                       curvature = 0.2,                       arrow = ggplot2::arrow(length = ggplot2::unit(0.2, \"cm\")),                       color = \"#6eab47\", linewidth = 1) +   ggplot2::geom_point(data = jpp,                       ggplot2::aes(x = lon, y = lat, color = type),                       size = 1.25, show.legend = FALSE) +   ggrepel::geom_text_repel(data = jpp,                            ggplot2::aes(label = name, x = lon, y = lat, color = type),                            show.legend = FALSE) +   ggplot2::scale_color_manual(values = c(source = \"#2c74b7\",                                          target = \"#cf574b\")) +   ggplot2::coord_sf(xlim = range(jpp$lon) + c(-0.45,0.45),                     ylim = range(jpp$lat) + c(-0.75,0.75)) +   ggplot2::labs(x = \"\", y = \"\") +   ggplot2::theme_bw() +   ggplot2::theme(panel.background = ggplot2::element_rect(fill = \"#9cd1fd\", color = NA))  fig_case3"},{"path":"https://stscl.github.io/tEDM/articles/tEDM.html","id":"reference","dir":"Articles","previous_headings":"","what":"Reference","title":"Temporal Empirical Dynamic Modeling","text":"Sugihara, G., May, R., Ye, H., Hsieh, C., Deyle, E., Fogarty, M., Munch, S., 2012. Detecting Causality Complex Ecosystems. Science 338, 496–500. https://doi.org/10.1126/science.1227079. Leng, S., Ma, H., Kurths, J., Lai, Y.-C., Lin, W., Aihara, K., Chen, L., 2020. Partial cross mapping eliminates indirect causal influences. Nature Communications 11. https://doi.org/10.1038/s41467-020-16238-0. Tao, P., Wang, Q., Shi, J., Hao, X., Liu, X., Min, B., Zhang, Y., Li, C., Cui, H., Chen, L., 2023. Detecting dynamical causality intersection cardinal concavity. Fundamental Research. https://doi.org/10.1016/j.fmre.2023.01.007. Clark, .T., Ye, H., Isbell, F., Deyle, E.R., Cowles, J., Tilman, G.D., Sugihara, G., 2015. Spatial convergent cross mapping detect causal relationships short time series. Ecology 96, 1174–1181. https://doi.org/10.1890/14-1479.1. Gan, T., Succar, R., Macrì, S., Marín, M.R., Porfiri, M., 2025. Causal discovery city data, urban scaling meets information theory. Cities 162, 105980. https://doi.org/10.1016/j.cities.2025.105980.  ","code":""},{"path":"https://stscl.github.io/tEDM/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Wenbo Lv. Author, maintainer, copyright holder.","code":""},{"path":"https://stscl.github.io/tEDM/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Lv W (2025). tEDM: Temporal Empirical Dynamic Modeling. R package version 1.1, https://stscl.github.io/tEDM/.","code":"@Manual{,   title = {tEDM: Temporal Empirical Dynamic Modeling},   author = {Wenbo Lv},   year = {2025},   note = {R package version 1.1},   url = {https://stscl.github.io/tEDM/}, }"},{"path":"https://stscl.github.io/tEDM/index.html","id":"tedm-","dir":"","previous_headings":"","what":"tEDM | Temporal Empirical Dynamic Modeling\n","title":"tEDM | Temporal Empirical Dynamic Modeling\n","text":"Temporal Empirical Dynamic Modeling","code":""},{"path":"https://stscl.github.io/tEDM/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"tEDM | Temporal Empirical Dynamic Modeling\n","text":"tEDM package provides suite tools exploring quantifying causality time series using Empirical Dynamic Modeling (EDM). particularly designed detect, differentiate, reconstruct causal dynamics systems traditional assumptions linearity stationarity may hold. package implements four fundamental EDM-based methods: Convergent Cross Mapping (CCM) – detecting nonlinear causal relationships time series. Partial Cross Mapping (PCM) – disentangling direct indirect causal influences. Cross Mapping Cardinality (CMC) – identifying time-varying state-dependent causal linkages. Multispatial Convergent Cross Mapping (MultispatialCCM) – reconstructing causal dynamics replicated time series across multiple spatial locations.","code":""},{"path":"https://stscl.github.io/tEDM/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"tEDM | Temporal Empirical Dynamic Modeling\n","text":"Install CRAN : Install binary version R-universe : Install source code GitHub :","code":"install.packages(\"tEDM\", dep = TRUE) install.packages(\"tEDM\",                  repos = c(\"https://stscl.r-universe.dev\",                            \"https://cloud.r-project.org\"),                  dep = TRUE) if (!requireNamespace(\"devtools\")) {     install.packages(\"devtools\") } devtools::install_github(\"stscl/tEDM\",                          #build_vignettes = TRUE,                          dep = TRUE)"},{"path":"https://stscl.github.io/tEDM/index.html","id":"reference","dir":"","previous_headings":"","what":"Reference","title":"tEDM | Temporal Empirical Dynamic Modeling\n","text":"Sugihara, G., May, R., Ye, H., Hsieh, C., Deyle, E., Fogarty, M., Munch, S., 2012. Detecting Causality Complex Ecosystems. Science 338, 496–500. https://doi.org/10.1126/science.1227079. Leng, S., Ma, H., Kurths, J., Lai, Y.-C., Lin, W., Aihara, K., Chen, L., 2020. Partial cross mapping eliminates indirect causal influences. Nature Communications 11. https://doi.org/10.1038/s41467-020-16238-0. Tao, P., Wang, Q., Shi, J., Hao, X., Liu, X., Min, B., Zhang, Y., Li, C., Cui, H., Chen, L., 2023. Detecting dynamical causality intersection cardinal concavity. Fundamental Research. https://doi.org/10.1016/j.fmre.2023.01.007. Clark, .T., Ye, H., Isbell, F., Deyle, E.R., Cowles, J., Tilman, G.D., Sugihara, G., 2015. Spatial convergent cross mapping detect causal relationships short time series. Ecology 96, 1174–1181. https://doi.org/10.1890/14-1479.1.  ","code":""},{"path":"https://stscl.github.io/tEDM/reference/ccm.html","id":null,"dir":"Reference","previous_headings":"","what":"convergent cross mapping — ccm","title":"convergent cross mapping — ccm","text":"convergent cross mapping","code":""},{"path":"https://stscl.github.io/tEDM/reference/ccm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"convergent cross mapping — ccm","text":"","code":"# S4 method for class 'data.frame' ccm(   data,   cause,   effect,   libsizes = NULL,   E = 3,   tau = 0,   k = E + 1,   theta = 1,   algorithm = \"simplex\",   lib = NULL,   pred = NULL,   threads = length(pred),   parallel.level = \"low\",   bidirectional = TRUE,   progressbar = TRUE )"},{"path":"https://stscl.github.io/tEDM/reference/ccm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"convergent cross mapping — ccm","text":"data observation data. cause name causal variable. effect name effect variable. libsizes (optional) number time points used. E (optional) embedding dimensions. tau (optional) step time lags. k (optional) number nearest neighbors. theta (optional) weighting parameter distances, useful algorithm smap. algorithm (optional) prediction algorithm. lib (optional) libraries indices. pred (optional) predictions indices. threads (optional) number threads use. parallel.level (optional) level parallelism, low high. bidirectional (optional) whether examine bidirectional causality. progressbar (optional) whether show progress bar.","code":""},{"path":"https://stscl.github.io/tEDM/reference/ccm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"convergent cross mapping — ccm","text":"list xmap cross mapping results varname names causal effect variable bidirectional whether examine bidirectional causality","code":""},{"path":"https://stscl.github.io/tEDM/reference/ccm.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"convergent cross mapping — ccm","text":"Sugihara, G., May, R., Ye, H., Hsieh, C., Deyle, E., Fogarty, M., Munch, S., 2012. Detecting Causality Complex Ecosystems. Science 338, 496–500.","code":""},{"path":"https://stscl.github.io/tEDM/reference/ccm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"convergent cross mapping — ccm","text":"","code":"sim = logistic_map(x = 0.4,y = 0.4,step = 45,beta_xy = 0.5,beta_yx = 0) ccm(sim,\"x\",\"y\",libsizes = seq(5,45,5),E = 9,k = 7,threads = 1) #>  Computing: [========================================] 100% (done)                          #>  Computing: [========================================] 100% (done)                          #>   libsizes      x->y      y->x #> 1        5 0.7496181 0.5370231 #> 2       10 0.8629427 0.6227933 #> 3       15 0.8793957 0.6313704 #> 4       20 0.8774940 0.6349501 #> 5       25 0.8757301 0.6325427 #> 6       30 0.8730860 0.6325198 #> 7       35 0.8721347 0.6338847 #> 8       37 0.9058220 0.7074703"},{"path":"https://stscl.github.io/tEDM/reference/cmc.html","id":null,"dir":"Reference","previous_headings":"","what":"cross mapping cardinality — cmc","title":"cross mapping cardinality — cmc","text":"cross mapping cardinality","code":""},{"path":"https://stscl.github.io/tEDM/reference/cmc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"cross mapping cardinality — cmc","text":"","code":"# S4 method for class 'data.frame' cmc(   data,   cause,   effect,   libsizes = NULL,   E = 3,   tau = 1,   k = pmin(E^2),   lib = NULL,   pred = NULL,   dist.metric = \"L2\",   threads = length(pred),   parallel.level = \"low\",   bidirectional = TRUE,   progressbar = TRUE )"},{"path":"https://stscl.github.io/tEDM/reference/cmc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"cross mapping cardinality — cmc","text":"data observation data. cause name causal variable. effect name effect variable. libsizes (optional) number time points used. E (optional) embedding dimensions. tau (optional) step time lags. k (optional) number nearest neighbors. lib (optional) libraries indices. pred (optional) predictions indices. dist.metric (optional) distance metric (L1: Manhattan, L2: Euclidean). threads (optional) number threads use. parallel.level (optional) level parallelism, low high. bidirectional (optional) whether examine bidirectional causality. progressbar (optional) whether show progress bar.","code":""},{"path":"https://stscl.github.io/tEDM/reference/cmc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"cross mapping cardinality — cmc","text":"list xmap cross mapping results cs causal strength varname names causal effect variable bidirectional whether examine bidirectional causality","code":""},{"path":"https://stscl.github.io/tEDM/reference/cmc.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"cross mapping cardinality — cmc","text":"Tao, P., Wang, Q., Shi, J., Hao, X., Liu, X., Min, B., Zhang, Y., Li, C., Cui, H., Chen, L., 2023. Detecting dynamical causality intersection cardinal concavity. Fundamental Research.","code":""},{"path":"https://stscl.github.io/tEDM/reference/cmc.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"cross mapping cardinality — cmc","text":"","code":"sim = logistic_map(x = 0.4,y = 0.4,step = 45,beta_xy = 0.5,beta_yx = 0) cmc(sim,\"x\",\"y\",E = 4,k = 15,threads = 1) #>  Computing: [========================================] 100% (done)                          #>  Computing: [========================================] 100% (done)                          #>   neighbors      x->y      y->x #> 1        15 0.2444444 0.1266667"},{"path":"https://stscl.github.io/tEDM/reference/embedded.html","id":null,"dir":"Reference","previous_headings":"","what":"embedding time series data — embedded","title":"embedding time series data — embedded","text":"embedding time series data","code":""},{"path":"https://stscl.github.io/tEDM/reference/embedded.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"embedding time series data — embedded","text":"","code":"# S4 method for class 'data.frame' embedded(data, target, E = 3, tau = 1)"},{"path":"https://stscl.github.io/tEDM/reference/embedded.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"embedding time series data — embedded","text":"data observation data. target name target variable. E (optional) embedding dimensions. tau (optional) step time lags.","code":""},{"path":"https://stscl.github.io/tEDM/reference/embedded.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"embedding time series data — embedded","text":"matrix","code":""},{"path":"https://stscl.github.io/tEDM/reference/embedded.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"embedding time series data — embedded","text":"","code":"embedded(data.frame(t = 1:5),\"t\",3) #>      [,1] [,2] [,3] #> [1,]    1  NaN  NaN #> [2,]    2    1  NaN #> [3,]    3    2    1 #> [4,]    4    3    2 #> [5,]    5    4    3"},{"path":"https://stscl.github.io/tEDM/reference/fnn.html","id":null,"dir":"Reference","previous_headings":"","what":"false nearest neighbours — fnn","title":"false nearest neighbours — fnn","text":"false nearest neighbours","code":""},{"path":"https://stscl.github.io/tEDM/reference/fnn.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"false nearest neighbours — fnn","text":"","code":"# S4 method for class 'data.frame' fnn(   data,   target,   lib = NULL,   pred = NULL,   E = 2:10,   tau = 1,   dist.metric = \"L1\",   rt = 10,   eps = 2,   threads = length(E) )"},{"path":"https://stscl.github.io/tEDM/reference/fnn.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"false nearest neighbours — fnn","text":"data observation data. target name target variable. lib (optional) libraries indices. pred (optional) predictions indices. E (optional) embedding dimensions. tau (optional) step time lags. dist.metric (optional) distance metric (L1: Manhattan, L2: Euclidean). rt (optional) escape factor. eps (optional) neighborhood diameter. threads (optional) number threads use.","code":""},{"path":"https://stscl.github.io/tEDM/reference/fnn.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"false nearest neighbours — fnn","text":"vector","code":""},{"path":"https://stscl.github.io/tEDM/reference/fnn.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"false nearest neighbours — fnn","text":"Kennel M. B., Brown R. Abarbanel H. D. ., Determining embedding dimension phase-space reconstruction using geometrical construction, Phys. Rev. , Volume 45, 3403 (1992).","code":""},{"path":"https://stscl.github.io/tEDM/reference/fnn.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"false nearest neighbours — fnn","text":"","code":"sim = logistic_map(x = 0.4,y = 0.4,step = 45,beta_xy = 0.5,beta_yx = 0) fnn(sim,\"x\",threads = 1) #>       E:1       E:2       E:3       E:4       E:5       E:6       E:7       E:8  #> 0.1777778 0.1333333 0.1111111 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000  #>       E:9  #> 0.0000000"},{"path":"https://stscl.github.io/tEDM/reference/ic.html","id":null,"dir":"Reference","previous_headings":"","what":"intersection cardinality — ic","title":"intersection cardinality — ic","text":"intersection cardinality","code":""},{"path":"https://stscl.github.io/tEDM/reference/ic.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"intersection cardinality — ic","text":"","code":"# S4 method for class 'data.frame' ic(   data,   column,   target,   lib = NULL,   pred = NULL,   E = 2:10,   tau = 1,   k = E + 2,   dist.metric = \"L2\",   threads = length(pred),   parallel.level = \"low\" )"},{"path":"https://stscl.github.io/tEDM/reference/ic.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"intersection cardinality — ic","text":"data observation data. column name library variable. target name target variable. lib (optional) libraries indices. pred (optional) predictions indices. E (optional) embedding dimensions. tau (optional) step time lags. k (optional) number nearest neighbors used prediction. dist.metric (optional) distance metric (L1: Manhattan, L2: Euclidean). threads (optional) number threads use. parallel.level (optional) level parallelism, low high.","code":""},{"path":"https://stscl.github.io/tEDM/reference/ic.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"intersection cardinality — ic","text":"list xmap cross mapping performance varname name target variable method method cross mapping tau step time lag","code":""},{"path":"https://stscl.github.io/tEDM/reference/ic.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"intersection cardinality — ic","text":"Tao, P., Wang, Q., Shi, J., Hao, X., Liu, X., Min, B., Zhang, Y., Li, C., Cui, H., Chen, L., 2023. Detecting dynamical causality intersection cardinal concavity. Fundamental Research.","code":""},{"path":"https://stscl.github.io/tEDM/reference/ic.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"intersection cardinality — ic","text":"","code":"sim = logistic_map(x = 0.4,y = 0.4,step = 45,beta_xy = 0.5,beta_yx = 0) ic(sim,\"x\",\"y\",E = 4,k = 15:30,threads = 1) #> The suggested E and k for variable y is 4 and 15"},{"path":"https://stscl.github.io/tEDM/reference/logistic_map.html","id":null,"dir":"Reference","previous_headings":"","what":"logistic map — logistic_map","title":"logistic map — logistic_map","text":"logistic map","code":""},{"path":"https://stscl.github.io/tEDM/reference/logistic_map.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"logistic map — logistic_map","text":"","code":"logistic_map(   x,   y = NULL,   z = NULL,   step = 15,   alpha_x = 3.6,   alpha_y = 3.72,   alpha_z = 3.68,   beta_xy = 0.05,   beta_xz = 0.05,   beta_yx = 0.2,   beta_yz = 0.2,   beta_zx = 0.35,   beta_zy = 0.35,   threshold = Inf,   transient = 1 )"},{"path":"https://stscl.github.io/tEDM/reference/logistic_map.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"logistic map — logistic_map","text":"x value x. y (optional) value y. z (optional) value z. step (optional) number simulation time steps. alpha_x (optional) growth parameter x. alpha_y (optional) growth parameter y. alpha_z (optional) growth parameter y. beta_xy (optional) cross-inhibition x y. beta_xz (optional) cross-inhibition x z. beta_yx (optional) cross-inhibition y x. beta_yz (optional) cross-inhibition y z. beta_zx (optional) cross-inhibition z x. beta_zy (optional) cross-inhibition z y. threshold (optional) set NaN absolute value exceeds threshold. transient (optional) transients excluded results.","code":""},{"path":"https://stscl.github.io/tEDM/reference/logistic_map.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"logistic map — logistic_map","text":"data.frame","code":""},{"path":"https://stscl.github.io/tEDM/reference/logistic_map.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"logistic map — logistic_map","text":"","code":"logistic_map(x = 0.2) #>            x #> 1  0.5760000 #> 2  0.8792064 #> 3  0.3823290 #> 4  0.8501527 #> 5  0.4586150 #> 6  0.8938342 #> 7  0.3416206 #> 8  0.8096975 #> 9  0.5547149 #> 10 0.8892226 #> 11 0.3546207 #> 12 0.8239135 #> 13 0.5222881 #> 14 0.8982117 #> 15 0.3291389"},{"path":"https://stscl.github.io/tEDM/reference/multispatialccm.html","id":null,"dir":"Reference","previous_headings":"","what":"multispatial convergent cross mapping — multispatialccm","title":"multispatial convergent cross mapping — multispatialccm","text":"multispatial convergent cross mapping","code":""},{"path":"https://stscl.github.io/tEDM/reference/multispatialccm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"multispatial convergent cross mapping — multispatialccm","text":"","code":"# S4 method for class 'list' multispatialccm(   data,   cause,   effect,   libsizes,   E = 3,   tau = 0,   k = E + 1,   boot = 99,   seed = 42,   threads = length(libsizes),   parallel.level = \"low\",   bidirectional = TRUE,   progressbar = TRUE )"},{"path":"https://stscl.github.io/tEDM/reference/multispatialccm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"multispatial convergent cross mapping — multispatialccm","text":"data observation data. cause name causal variable. effect name effect variable. libsizes number time points used prediction. E (optional) embedding dimensions. tau (optional) step time lags. k (optional) number nearest neighbors used prediction. boot (optional) number bootstraps perform. seed (optional) random seed. threads (optional) number threads use. parallel.level (optional) level parallelism, low high. bidirectional (optional) whether examine bidirectional causality. progressbar (optional) whether show progress bar.","code":""},{"path":"https://stscl.github.io/tEDM/reference/multispatialccm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"multispatial convergent cross mapping — multispatialccm","text":"list xmap cross mapping results varname names causal effect variable bidirectional whether examine bidirectional causality","code":""},{"path":"https://stscl.github.io/tEDM/reference/multispatialccm.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"multispatial convergent cross mapping — multispatialccm","text":"Clark, .T., Ye, H., Isbell, F., Deyle, E.R., Cowles, J., Tilman, G.D., Sugihara, G., 2015. Spatial convergent cross mapping detect causal relationships short time series. Ecology 96, 1174–1181.","code":""},{"path":"https://stscl.github.io/tEDM/reference/multispatialccm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"multispatial convergent cross mapping — multispatialccm","text":"","code":"set.seed(42) obs = runif(15,0,0.1) sim = vector(\"list\",15) for (i in seq_along(obs)){   sim[[i]] = logistic_map(x = obs[i],y = obs[i],step = 15,beta_xy = 0.5,beta_yx = 0) } lst = list(x = do.call(cbind, lapply(sim, function(df) df$x)),            y = do.call(cbind, lapply(sim, function(df) df$y))) multispatialccm(lst,\"x\",\"y\",libsizes = 5:15,E = c(7,2),k = 6,threads = 1) #>  Computing: [========================================] 100% (done)                          #>  Computing: [========================================] 100% (done)                          #>    libsizes      x->y      y->x #> 1         5 0.7665126 0.6929759 #> 2         6 0.8155336 0.7418481 #> 3         7 0.8427247 0.7738482 #> 4         8 0.8615120 0.7983056 #> 5         9 0.8751009 0.8152952 #> 6        10 0.8853064 0.8323882 #> 7        11 0.8987007 0.8527309 #> 8        12 0.9110421 0.8747777 #> 9        13 0.9201259 0.8843184 #> 10       14 0.9287790 0.8966083 #> 11       15 0.9357402 0.9051681"},{"path":"https://stscl.github.io/tEDM/reference/pcm.html","id":null,"dir":"Reference","previous_headings":"","what":"partial cross mapping — pcm","title":"partial cross mapping — pcm","text":"partial cross mapping","code":""},{"path":"https://stscl.github.io/tEDM/reference/pcm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"partial cross mapping — pcm","text":"","code":"# S4 method for class 'data.frame' pcm(   data,   cause,   effect,   conds,   libsizes = NULL,   E = 3,   tau = 0,   k = E + 1,   theta = 1,   algorithm = \"simplex\",   lib = NULL,   pred = NULL,   threads = length(pred),   parallel.level = \"low\",   bidirectional = TRUE,   cumulate = FALSE,   progressbar = TRUE )"},{"path":"https://stscl.github.io/tEDM/reference/pcm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"partial cross mapping — pcm","text":"data observation data. cause name causal variable. effect name effect variable. conds name conditioning variables. libsizes (optional) number time points used. E (optional) embedding dimensions. tau (optional) step time lags. k (optional) number nearest neighbors. theta (optional) weighting parameter distances, useful algorithm smap. algorithm (optional) prediction algorithm. lib (optional) libraries indices. pred (optional) predictions indices. threads (optional) number threads use. parallel.level (optional) level parallelism, low high. bidirectional (optional) whether examine bidirectional causality. cumulate (optional) serial cumulative computation partial cross mapping. progressbar (optional) whether show progress bar.","code":""},{"path":"https://stscl.github.io/tEDM/reference/pcm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"partial cross mapping — pcm","text":"list pxmap partial cross mapping results xmap cross mapping results varname names causal effect variable bidirectional whether examine bidirectional causality","code":""},{"path":"https://stscl.github.io/tEDM/reference/pcm.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"partial cross mapping — pcm","text":"Leng, S., Ma, H., Kurths, J. et al. Partial cross mapping eliminates indirect causal influences. Nat Commun 11, 2632 (2020).","code":""},{"path":"https://stscl.github.io/tEDM/reference/pcm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"partial cross mapping — pcm","text":"","code":"sim = logistic_map(x = 0.4,y = 0.4,z = 0.4,step = 45,                    beta_xy = 0.5, beta_xz = 0,                    beta_yx = 0, beta_yz = 0.5,                    beta_zx = 0, beta_zy = 0) pcm(sim,\"x\",\"z\",\"y\",libsizes = seq(5,45,5),E = 9,k = 7,threads = 1) #>  Computing: [========================================] 100% (done)                          #>  Computing: [========================================] 100% (done)                          #> --------------------------------------  #> ***partial cross mapping prediction***  #> --------------------------------------  #>   libsizes      x->z       z->x #> 1        5 0.4031409 0.15436158 #> 2       10 0.2924073 0.06431117 #> 3       15 0.2315126 0.06146024 #> 4       20 0.2258133 0.11499257 #> 5       25 0.2212198 0.14445706 #> 6       29 0.1187136 0.19047712 #>  #> ------------------------------  #> ***cross mapping prediction***  #> ------------------------------  #>   libsizes      x->z      z->x #> 1        5 0.7951207 0.6217198 #> 2       10 0.8682935 0.6404764 #> 3       15 0.8797832 0.6379368 #> 4       20 0.8796930 0.6421839 #> 5       25 0.8758969 0.6457823 #> 6       29 0.9266489 0.6514443"},{"path":"https://stscl.github.io/tEDM/reference/simplex.html","id":null,"dir":"Reference","previous_headings":"","what":"simplex forecast — simplex","title":"simplex forecast — simplex","text":"simplex forecast","code":""},{"path":"https://stscl.github.io/tEDM/reference/simplex.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"simplex forecast — simplex","text":"","code":"# S4 method for class 'data.frame' simplex(   data,   column,   target,   lib = NULL,   pred = NULL,   E = 2:10,   tau = 1,   k = E + 1,   dist.metric = \"L2\",   dist.average = TRUE,   threads = length(E) )  # S4 method for class 'list' simplex(   data,   column,   target,   lib = NULL,   pred = NULL,   E = 2:10,   tau = 1,   k = E + 1,   threads = length(E) )"},{"path":"https://stscl.github.io/tEDM/reference/simplex.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"simplex forecast — simplex","text":"data observation data. column name library variable. target name target variable. lib (optional) libraries indices. pred (optional) predictions indices. E (optional) embedding dimensions. tau (optional) step time lags. k (optional) number nearest neighbors used prediction. dist.metric (optional) distance metric (L1: Manhattan, L2: Euclidean). dist.average (optional) whether average distance. threads (optional) number threads use.","code":""},{"path":"https://stscl.github.io/tEDM/reference/simplex.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"simplex forecast — simplex","text":"list xmap forecast performance varname name target variable method method cross mapping tau step time lag","code":""},{"path":"https://stscl.github.io/tEDM/reference/simplex.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"simplex forecast — simplex","text":"Sugihara G. May R. 1990. Nonlinear forecasting way distinguishing chaos measurement error time series. Nature, 344:734-741.","code":""},{"path":"https://stscl.github.io/tEDM/reference/simplex.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"simplex forecast — simplex","text":"","code":"sim = logistic_map(x = 0.4,y = 0.4,step = 45,beta_xy = 0.5,beta_yx = 0) simplex(sim,\"x\",\"y\",E = 4:10,k = 7,threads = 1) #> The suggested E and k for variable y is 9 and 7"},{"path":"https://stscl.github.io/tEDM/reference/smap.html","id":null,"dir":"Reference","previous_headings":"","what":"smap forecast — smap","title":"smap forecast — smap","text":"smap forecast","code":""},{"path":"https://stscl.github.io/tEDM/reference/smap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"smap forecast — smap","text":"","code":"# S4 method for class 'data.frame' smap(   data,   column,   target,   lib = NULL,   pred = NULL,   E = 3,   tau = 1,   k = E + 1,   dist.metric = \"L2\",   dist.average = TRUE,   theta = c(0, 1e-04, 3e-04, 0.001, 0.003, 0.01, 0.03, 0.1, 0.3, 0.5, 0.75, 1, 1.5, 2, 3,     4, 6, 8),   threads = length(theta) )"},{"path":"https://stscl.github.io/tEDM/reference/smap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"smap forecast — smap","text":"data observation data. column name library variable. target name target variable. lib (optional) libraries indices. pred (optional) predictions indices. E (optional) embedding dimensions. tau (optional) step time lags. k (optional) number nearest neighbors used prediction. dist.metric (optional) distance metric (L1: Manhattan, L2: Euclidean). dist.average (optional) whether average distance. theta (optional) weighting parameter distances. threads (optional) number threads use.","code":""},{"path":"https://stscl.github.io/tEDM/reference/smap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"smap forecast — smap","text":"list xmap forecast performance varname name target variable method method cross mapping","code":""},{"path":"https://stscl.github.io/tEDM/reference/smap.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"smap forecast — smap","text":"Sugihara G. 1994. Nonlinear forecasting classification natural time series. Philosophical Transactions: Physical Sciences Engineering, 348 (1688):477-495.","code":""},{"path":"https://stscl.github.io/tEDM/reference/smap.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"smap forecast — smap","text":"","code":"sim = logistic_map(x = 0.4,y = 0.4,step = 45,beta_xy = 0.5,beta_yx = 0) smap(sim,\"x\",\"y\",E = 9,k = 7,threads = 1) #> The suggested theta for variable y is 8"},{"path":[]},{"path":"https://stscl.github.io/tEDM/news/index.html","id":"enhancements-1-1","dir":"Changelog","previous_headings":"","what":"enhancements","title":"tEDM 1.1","text":"Safeguard transient removal logic logistic map prevent index errors (#96).","code":""},{"path":"https://stscl.github.io/tEDM/news/index.html","id":"breaking-changes-1-1","dir":"Changelog","previous_headings":"","what":"breaking changes","title":"tEDM 1.1","text":"Adjust time-delay embedding logic support flexible tau configurations (#111). Refine lib pred index filtering logic cross mapping (#102).","code":""},{"path":"https://stscl.github.io/tEDM/news/index.html","id":"tedm-10","dir":"Changelog","previous_headings":"","what":"tEDM 1.0","title":"tEDM 1.0","text":"CRAN release: 2025-07-15","code":""},{"path":"https://stscl.github.io/tEDM/news/index.html","id":"new-1-0","dir":"Changelog","previous_headings":"","what":"new","title":"tEDM 1.0","text":"First stable release (#93).","code":""}]
